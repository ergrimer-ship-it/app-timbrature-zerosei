(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function N1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var w0={exports:{}},Pc={},E0={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ka=Symbol.for("react.element"),b1=Symbol.for("react.portal"),D1=Symbol.for("react.fragment"),V1=Symbol.for("react.strict_mode"),O1=Symbol.for("react.profiler"),M1=Symbol.for("react.provider"),L1=Symbol.for("react.context"),j1=Symbol.for("react.forward_ref"),F1=Symbol.for("react.suspense"),U1=Symbol.for("react.memo"),z1=Symbol.for("react.lazy"),ey=Symbol.iterator;function B1(t){return t===null||typeof t!="object"?null:(t=ey&&t[ey]||t["@@iterator"],typeof t=="function"?t:null)}var I0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T0=Object.assign,x0={};function Ji(t,e,n){this.props=t,this.context=e,this.refs=x0,this.updater=n||I0}Ji.prototype.isReactComponent={};Ji.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ji.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function S0(){}S0.prototype=Ji.prototype;function rp(t,e,n){this.props=t,this.context=e,this.refs=x0,this.updater=n||I0}var sp=rp.prototype=new S0;sp.constructor=rp;T0(sp,Ji.prototype);sp.isPureReactComponent=!0;var ty=Array.isArray,A0=Object.prototype.hasOwnProperty,ip={current:null},R0={key:!0,ref:!0,__self:!0,__source:!0};function P0(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)A0.call(e,r)&&!R0.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ka,type:t,key:i,ref:o,props:s,_owner:ip.current}}function $1(t,e){return{$$typeof:Ka,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function op(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ka}function q1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ny=/\/+/g;function Bh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?q1(""+t.key):e.toString(36)}function eu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ka:case b1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Bh(o,0):r,ty(s)?(n="",t!=null&&(n=t.replace(ny,"$&/")+"/"),eu(s,e,n,"",function(c){return c})):s!=null&&(op(s)&&(s=$1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ny,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",ty(t))for(var a=0;a<t.length;a++){i=t[a];var u=r+Bh(i,a);o+=eu(i,e,n,u,s)}else if(u=B1(t),typeof u=="function")for(t=u.call(t),a=0;!(i=t.next()).done;)i=i.value,u=r+Bh(i,a++),o+=eu(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rl(t,e,n){if(t==null)return t;var r=[],s=0;return eu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function K1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var mt={current:null},tu={transition:null},W1={ReactCurrentDispatcher:mt,ReactCurrentBatchConfig:tu,ReactCurrentOwner:ip};function k0(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:Rl,forEach:function(t,e,n){Rl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rl(t,function(){e++}),e},toArray:function(t){return Rl(t,function(e){return e})||[]},only:function(t){if(!op(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=Ji;se.Fragment=D1;se.Profiler=O1;se.PureComponent=rp;se.StrictMode=V1;se.Suspense=F1;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W1;se.act=k0;se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=T0({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ip.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(u in e)A0.call(e,u)&&!R0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Ka,type:t.type,key:s,ref:i,props:r,_owner:o}};se.createContext=function(t){return t={$$typeof:L1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:M1,_context:t},t.Consumer=t};se.createElement=P0;se.createFactory=function(t){var e=P0.bind(null,t);return e.type=t,e};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:j1,render:t}};se.isValidElement=op;se.lazy=function(t){return{$$typeof:z1,_payload:{_status:-1,_result:t},_init:K1}};se.memo=function(t,e){return{$$typeof:U1,type:t,compare:e===void 0?null:e}};se.startTransition=function(t){var e=tu.transition;tu.transition={};try{t()}finally{tu.transition=e}};se.unstable_act=k0;se.useCallback=function(t,e){return mt.current.useCallback(t,e)};se.useContext=function(t){return mt.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return mt.current.useDeferredValue(t)};se.useEffect=function(t,e){return mt.current.useEffect(t,e)};se.useId=function(){return mt.current.useId()};se.useImperativeHandle=function(t,e,n){return mt.current.useImperativeHandle(t,e,n)};se.useInsertionEffect=function(t,e){return mt.current.useInsertionEffect(t,e)};se.useLayoutEffect=function(t,e){return mt.current.useLayoutEffect(t,e)};se.useMemo=function(t,e){return mt.current.useMemo(t,e)};se.useReducer=function(t,e,n){return mt.current.useReducer(t,e,n)};se.useRef=function(t){return mt.current.useRef(t)};se.useState=function(t){return mt.current.useState(t)};se.useSyncExternalStore=function(t,e,n){return mt.current.useSyncExternalStore(t,e,n)};se.useTransition=function(){return mt.current.useTransition()};se.version="18.3.1";E0.exports=se;var K=E0.exports;const C0=N1(K);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H1=K,G1=Symbol.for("react.element"),Q1=Symbol.for("react.fragment"),Y1=Object.prototype.hasOwnProperty,X1=H1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J1={key:!0,ref:!0,__self:!0,__source:!0};function N0(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Y1.call(e,r)&&!J1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:G1,type:t,key:i,ref:o,props:s,_owner:X1.current}}Pc.Fragment=Q1;Pc.jsx=N0;Pc.jsxs=N0;w0.exports=Pc;var f=w0.exports,kd={},b0={exports:{}},Dt={},D0={exports:{}},V0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,$){var H=W.length;W.push($);e:for(;0<H;){var J=H-1>>>1,pe=W[J];if(0<s(pe,$))W[J]=$,W[H]=pe,H=J;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var $=W[0],H=W.pop();if(H!==$){W[0]=H;e:for(var J=0,pe=W.length,He=pe>>>1;J<He;){var Ge=2*(J+1)-1,Ot=W[Ge],Gt=Ge+1,Gn=W[Gt];if(0>s(Ot,H))Gt<pe&&0>s(Gn,Ot)?(W[J]=Gn,W[Gt]=H,J=Gt):(W[J]=Ot,W[Ge]=H,J=Ge);else if(Gt<pe&&0>s(Gn,H))W[J]=Gn,W[Gt]=H,J=Gt;else break e}}return $}function s(W,$){var H=W.sortIndex-$.sortIndex;return H!==0?H:W.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var u=[],c=[],d=1,m=null,g=3,I=!1,x=!1,k=!1,C=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var $=n(c);$!==null;){if($.callback===null)r(c);else if($.startTime<=W)r(c),$.sortIndex=$.expirationTime,e(u,$);else break;$=n(c)}}function V(W){if(k=!1,E(W),!x)if(n(u)!==null)x=!0,Wr(L);else{var $=n(c);$!==null&&Hr(V,$.startTime-W)}}function L(W,$){x=!1,k&&(k=!1,w(v),v=-1),I=!0;var H=g;try{for(E($),m=n(u);m!==null&&(!(m.expirationTime>$)||W&&!P());){var J=m.callback;if(typeof J=="function"){m.callback=null,g=m.priorityLevel;var pe=J(m.expirationTime<=$);$=t.unstable_now(),typeof pe=="function"?m.callback=pe:m===n(u)&&r(u),E($)}else r(u);m=n(u)}if(m!==null)var He=!0;else{var Ge=n(c);Ge!==null&&Hr(V,Ge.startTime-$),He=!1}return He}finally{m=null,g=H,I=!1}}var j=!1,T=null,v=-1,S=5,R=-1;function P(){return!(t.unstable_now()-R<S)}function b(){if(T!==null){var W=t.unstable_now();R=W;var $=!0;try{$=T(!0,W)}finally{$?A():(j=!1,T=null)}}else j=!1}var A;if(typeof _=="function")A=function(){_(b)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,Ht=Me.port2;Me.port1.onmessage=b,A=function(){Ht.postMessage(null)}}else A=function(){C(b,0)};function Wr(W){T=W,j||(j=!0,A())}function Hr(W,$){v=C(function(){W(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){x||I||(x=!0,Wr(L))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(W){switch(g){case 1:case 2:case 3:var $=3;break;default:$=g}var H=g;g=$;try{return W()}finally{g=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,$){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var H=g;g=W;try{return $()}finally{g=H}},t.unstable_scheduleCallback=function(W,$,H){var J=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?J+H:J):H=J,W){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=H+pe,W={id:d++,callback:$,priorityLevel:W,startTime:H,expirationTime:pe,sortIndex:-1},H>J?(W.sortIndex=H,e(c,W),n(u)===null&&W===n(c)&&(k?(w(v),v=-1):k=!0,Hr(V,H-J))):(W.sortIndex=pe,e(u,W),x||I||(x=!0,Wr(L))),W},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(W){var $=g;return function(){var H=g;g=$;try{return W.apply(this,arguments)}finally{g=H}}}})(V0);D0.exports=V0;var Z1=D0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eS=K,Nt=Z1;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var O0=new Set,da={};function js(t,e){Ni(t,e),Ni(t+"Capture",e)}function Ni(t,e){for(da[t]=e,t=0;t<e.length;t++)O0.add(e[t])}var Ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cd=Object.prototype.hasOwnProperty,tS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ry={},sy={};function nS(t){return Cd.call(sy,t)?!0:Cd.call(ry,t)?!1:tS.test(t)?sy[t]=!0:(ry[t]=!0,!1)}function rS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sS(t,e,n,r){if(e===null||typeof e>"u"||rS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ze[t]=new gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ze[e]=new gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ze[t]=new gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ze[t]=new gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ze[t]=new gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ze[t]=new gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ze[t]=new gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ze[t]=new gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ze[t]=new gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ap=/[\-:]([a-z])/g;function lp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ap,lp);Ze[e]=new gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ap,lp);Ze[e]=new gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ap,lp);Ze[e]=new gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ze[t]=new gt(t,1,!1,t.toLowerCase(),null,!1,!1)});Ze.xlinkHref=new gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ze[t]=new gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function up(t,e,n,r){var s=Ze.hasOwnProperty(e)?Ze[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sS(e,n,s,r)&&(n=null),r||s===null?nS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Kn=eS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pl=Symbol.for("react.element"),li=Symbol.for("react.portal"),ui=Symbol.for("react.fragment"),cp=Symbol.for("react.strict_mode"),Nd=Symbol.for("react.profiler"),M0=Symbol.for("react.provider"),L0=Symbol.for("react.context"),hp=Symbol.for("react.forward_ref"),bd=Symbol.for("react.suspense"),Dd=Symbol.for("react.suspense_list"),dp=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),j0=Symbol.for("react.offscreen"),iy=Symbol.iterator;function Io(t){return t===null||typeof t!="object"?null:(t=iy&&t[iy]||t["@@iterator"],typeof t=="function"?t:null)}var Ae=Object.assign,$h;function Oo(t){if($h===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$h=e&&e[1]||""}return`
`+$h+t}var qh=!1;function Kh(t,e){if(!t||qh)return"";qh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=a);break}}}finally{qh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oo(t):""}function iS(t){switch(t.tag){case 5:return Oo(t.type);case 16:return Oo("Lazy");case 13:return Oo("Suspense");case 19:return Oo("SuspenseList");case 0:case 2:case 15:return t=Kh(t.type,!1),t;case 11:return t=Kh(t.type.render,!1),t;case 1:return t=Kh(t.type,!0),t;default:return""}}function Vd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ui:return"Fragment";case li:return"Portal";case Nd:return"Profiler";case cp:return"StrictMode";case bd:return"Suspense";case Dd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case L0:return(t.displayName||"Context")+".Consumer";case M0:return(t._context.displayName||"Context")+".Provider";case hp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case dp:return e=t.displayName||null,e!==null?e:Vd(t.type)||"Memo";case or:e=t._payload,t=t._init;try{return Vd(t(e))}catch{}}return null}function oS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vd(e);case 8:return e===cp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Nr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function F0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aS(t){var e=F0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function kl(t){t._valueTracker||(t._valueTracker=aS(t))}function U0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=F0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ku(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Od(t,e){var n=e.checked;return Ae({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function oy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Nr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function z0(t,e){e=e.checked,e!=null&&up(t,"checked",e,!1)}function Md(t,e){z0(t,e);var n=Nr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ld(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ld(t,e.type,Nr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ay(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ld(t,e,n){(e!=="number"||ku(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Mo=Array.isArray;function Ei(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Nr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function jd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Ae({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ly(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(Mo(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Nr(n)}}function B0(t,e){var n=Nr(e.value),r=Nr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function uy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cl,q0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Cl=Cl||document.createElement("div"),Cl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ho={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lS=["Webkit","ms","Moz","O"];Object.keys(Ho).forEach(function(t){lS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ho[e]=Ho[t]})});function K0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ho.hasOwnProperty(t)&&Ho[t]?(""+e).trim():e+"px"}function W0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=K0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var uS=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ud(t,e){if(e){if(uS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function zd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bd=null;function fp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $d=null,Ii=null,Ti=null;function cy(t){if(t=Ga(t)){if(typeof $d!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Dc(e),$d(t.stateNode,t.type,e))}}function H0(t){Ii?Ti?Ti.push(t):Ti=[t]:Ii=t}function G0(){if(Ii){var t=Ii,e=Ti;if(Ti=Ii=null,cy(t),e)for(t=0;t<e.length;t++)cy(e[t])}}function Q0(t,e){return t(e)}function Y0(){}var Wh=!1;function X0(t,e,n){if(Wh)return t(e,n);Wh=!0;try{return Q0(t,e,n)}finally{Wh=!1,(Ii!==null||Ti!==null)&&(Y0(),G0())}}function pa(t,e){var n=t.stateNode;if(n===null)return null;var r=Dc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var qd=!1;if(Ln)try{var To={};Object.defineProperty(To,"passive",{get:function(){qd=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{qd=!1}function cS(t,e,n,r,s,i,o,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Go=!1,Cu=null,Nu=!1,Kd=null,hS={onError:function(t){Go=!0,Cu=t}};function dS(t,e,n,r,s,i,o,a,u){Go=!1,Cu=null,cS.apply(hS,arguments)}function fS(t,e,n,r,s,i,o,a,u){if(dS.apply(this,arguments),Go){if(Go){var c=Cu;Go=!1,Cu=null}else throw Error(U(198));Nu||(Nu=!0,Kd=c)}}function Fs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function J0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function hy(t){if(Fs(t)!==t)throw Error(U(188))}function pS(t){var e=t.alternate;if(!e){if(e=Fs(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return hy(s),t;if(i===r)return hy(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function Z0(t){return t=pS(t),t!==null?ew(t):null}function ew(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ew(t);if(e!==null)return e;t=t.sibling}return null}var tw=Nt.unstable_scheduleCallback,dy=Nt.unstable_cancelCallback,mS=Nt.unstable_shouldYield,gS=Nt.unstable_requestPaint,Ce=Nt.unstable_now,yS=Nt.unstable_getCurrentPriorityLevel,pp=Nt.unstable_ImmediatePriority,nw=Nt.unstable_UserBlockingPriority,bu=Nt.unstable_NormalPriority,_S=Nt.unstable_LowPriority,rw=Nt.unstable_IdlePriority,kc=null,gn=null;function vS(t){if(gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(kc,t,void 0,(t.current.flags&128)===128)}catch{}}var nn=Math.clz32?Math.clz32:IS,wS=Math.log,ES=Math.LN2;function IS(t){return t>>>=0,t===0?32:31-(wS(t)/ES|0)|0}var Nl=64,bl=4194304;function Lo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Du(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Lo(a):(i&=o,i!==0&&(r=Lo(i)))}else o=n&~s,o!==0?r=Lo(o):i!==0&&(r=Lo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-nn(e),s=1<<n,r|=t[n],e&=~s;return r}function TS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xS(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-nn(i),a=1<<o,u=s[o];u===-1?(!(a&n)||a&r)&&(s[o]=TS(a,e)):u<=e&&(t.expiredLanes|=a),i&=~a}}function Wd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sw(){var t=Nl;return Nl<<=1,!(Nl&4194240)&&(Nl=64),t}function Hh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-nn(e),t[e]=n}function SS(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-nn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function mp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-nn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var de=0;function iw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ow,gp,aw,lw,uw,Hd=!1,Dl=[],_r=null,vr=null,wr=null,ma=new Map,ga=new Map,lr=[],AS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fy(t,e){switch(t){case"focusin":case"focusout":_r=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":wr=null;break;case"pointerover":case"pointerout":ma.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ga.delete(e.pointerId)}}function xo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ga(e),e!==null&&gp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function RS(t,e,n,r,s){switch(e){case"focusin":return _r=xo(_r,t,e,n,r,s),!0;case"dragenter":return vr=xo(vr,t,e,n,r,s),!0;case"mouseover":return wr=xo(wr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ma.set(i,xo(ma.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ga.set(i,xo(ga.get(i)||null,t,e,n,r,s)),!0}return!1}function cw(t){var e=us(t.target);if(e!==null){var n=Fs(e);if(n!==null){if(e=n.tag,e===13){if(e=J0(n),e!==null){t.blockedOn=e,uw(t.priority,function(){aw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function nu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bd=r,n.target.dispatchEvent(r),Bd=null}else return e=Ga(n),e!==null&&gp(e),t.blockedOn=n,!1;e.shift()}return!0}function py(t,e,n){nu(t)&&n.delete(e)}function PS(){Hd=!1,_r!==null&&nu(_r)&&(_r=null),vr!==null&&nu(vr)&&(vr=null),wr!==null&&nu(wr)&&(wr=null),ma.forEach(py),ga.forEach(py)}function So(t,e){t.blockedOn===e&&(t.blockedOn=null,Hd||(Hd=!0,Nt.unstable_scheduleCallback(Nt.unstable_NormalPriority,PS)))}function ya(t){function e(s){return So(s,t)}if(0<Dl.length){So(Dl[0],t);for(var n=1;n<Dl.length;n++){var r=Dl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(_r!==null&&So(_r,t),vr!==null&&So(vr,t),wr!==null&&So(wr,t),ma.forEach(e),ga.forEach(e),n=0;n<lr.length;n++)r=lr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<lr.length&&(n=lr[0],n.blockedOn===null);)cw(n),n.blockedOn===null&&lr.shift()}var xi=Kn.ReactCurrentBatchConfig,Vu=!0;function kS(t,e,n,r){var s=de,i=xi.transition;xi.transition=null;try{de=1,yp(t,e,n,r)}finally{de=s,xi.transition=i}}function CS(t,e,n,r){var s=de,i=xi.transition;xi.transition=null;try{de=4,yp(t,e,n,r)}finally{de=s,xi.transition=i}}function yp(t,e,n,r){if(Vu){var s=Gd(t,e,n,r);if(s===null)rd(t,e,r,Ou,n),fy(t,r);else if(RS(s,t,e,n,r))r.stopPropagation();else if(fy(t,r),e&4&&-1<AS.indexOf(t)){for(;s!==null;){var i=Ga(s);if(i!==null&&ow(i),i=Gd(t,e,n,r),i===null&&rd(t,e,r,Ou,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else rd(t,e,r,null,n)}}var Ou=null;function Gd(t,e,n,r){if(Ou=null,t=fp(r),t=us(t),t!==null)if(e=Fs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=J0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ou=t,null}function hw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yS()){case pp:return 1;case nw:return 4;case bu:case _S:return 16;case rw:return 536870912;default:return 16}default:return 16}}var mr=null,_p=null,ru=null;function dw(){if(ru)return ru;var t,e=_p,n=e.length,r,s="value"in mr?mr.value:mr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return ru=s.slice(t,1<r?1-r:void 0)}function su(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vl(){return!0}function my(){return!1}function Vt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Vl:my,this.isPropagationStopped=my,this}return Ae(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vl)},persist:function(){},isPersistent:Vl}),e}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vp=Vt(Zi),Ha=Ae({},Zi,{view:0,detail:0}),NS=Vt(Ha),Gh,Qh,Ao,Cc=Ae({},Ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ao&&(Ao&&t.type==="mousemove"?(Gh=t.screenX-Ao.screenX,Qh=t.screenY-Ao.screenY):Qh=Gh=0,Ao=t),Gh)},movementY:function(t){return"movementY"in t?t.movementY:Qh}}),gy=Vt(Cc),bS=Ae({},Cc,{dataTransfer:0}),DS=Vt(bS),VS=Ae({},Ha,{relatedTarget:0}),Yh=Vt(VS),OS=Ae({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),MS=Vt(OS),LS=Ae({},Zi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jS=Vt(LS),FS=Ae({},Zi,{data:0}),yy=Vt(FS),US={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $S(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=BS[t])?!!e[t]:!1}function wp(){return $S}var qS=Ae({},Ha,{key:function(t){if(t.key){var e=US[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=su(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wp,charCode:function(t){return t.type==="keypress"?su(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?su(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KS=Vt(qS),WS=Ae({},Cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_y=Vt(WS),HS=Ae({},Ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wp}),GS=Vt(HS),QS=Ae({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),YS=Vt(QS),XS=Ae({},Cc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JS=Vt(XS),ZS=[9,13,27,32],Ep=Ln&&"CompositionEvent"in window,Qo=null;Ln&&"documentMode"in document&&(Qo=document.documentMode);var eA=Ln&&"TextEvent"in window&&!Qo,fw=Ln&&(!Ep||Qo&&8<Qo&&11>=Qo),vy=" ",wy=!1;function pw(t,e){switch(t){case"keyup":return ZS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ci=!1;function tA(t,e){switch(t){case"compositionend":return mw(e);case"keypress":return e.which!==32?null:(wy=!0,vy);case"textInput":return t=e.data,t===vy&&wy?null:t;default:return null}}function nA(t,e){if(ci)return t==="compositionend"||!Ep&&pw(t,e)?(t=dw(),ru=_p=mr=null,ci=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fw&&e.locale!=="ko"?null:e.data;default:return null}}var rA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ey(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rA[t.type]:e==="textarea"}function gw(t,e,n,r){H0(r),e=Mu(e,"onChange"),0<e.length&&(n=new vp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Yo=null,_a=null;function sA(t){Rw(t,0)}function Nc(t){var e=fi(t);if(U0(e))return t}function iA(t,e){if(t==="change")return e}var yw=!1;if(Ln){var Xh;if(Ln){var Jh="oninput"in document;if(!Jh){var Iy=document.createElement("div");Iy.setAttribute("oninput","return;"),Jh=typeof Iy.oninput=="function"}Xh=Jh}else Xh=!1;yw=Xh&&(!document.documentMode||9<document.documentMode)}function Ty(){Yo&&(Yo.detachEvent("onpropertychange",_w),_a=Yo=null)}function _w(t){if(t.propertyName==="value"&&Nc(_a)){var e=[];gw(e,_a,t,fp(t)),X0(sA,e)}}function oA(t,e,n){t==="focusin"?(Ty(),Yo=e,_a=n,Yo.attachEvent("onpropertychange",_w)):t==="focusout"&&Ty()}function aA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Nc(_a)}function lA(t,e){if(t==="click")return Nc(e)}function uA(t,e){if(t==="input"||t==="change")return Nc(e)}function cA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sn=typeof Object.is=="function"?Object.is:cA;function va(t,e){if(sn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Cd.call(e,s)||!sn(t[s],e[s]))return!1}return!0}function xy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sy(t,e){var n=xy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=xy(n)}}function vw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ww(){for(var t=window,e=ku();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ku(t.document)}return e}function Ip(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function hA(t){var e=ww(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&vw(n.ownerDocument.documentElement,n)){if(r!==null&&Ip(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Sy(n,i);var o=Sy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var dA=Ln&&"documentMode"in document&&11>=document.documentMode,hi=null,Qd=null,Xo=null,Yd=!1;function Ay(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yd||hi==null||hi!==ku(r)||(r=hi,"selectionStart"in r&&Ip(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xo&&va(Xo,r)||(Xo=r,r=Mu(Qd,"onSelect"),0<r.length&&(e=new vp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=hi)))}function Ol(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var di={animationend:Ol("Animation","AnimationEnd"),animationiteration:Ol("Animation","AnimationIteration"),animationstart:Ol("Animation","AnimationStart"),transitionend:Ol("Transition","TransitionEnd")},Zh={},Ew={};Ln&&(Ew=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function bc(t){if(Zh[t])return Zh[t];if(!di[t])return t;var e=di[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ew)return Zh[t]=e[n];return t}var Iw=bc("animationend"),Tw=bc("animationiteration"),xw=bc("animationstart"),Sw=bc("transitionend"),Aw=new Map,Ry="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ur(t,e){Aw.set(t,e),js(e,[t])}for(var ed=0;ed<Ry.length;ed++){var td=Ry[ed],fA=td.toLowerCase(),pA=td[0].toUpperCase()+td.slice(1);Ur(fA,"on"+pA)}Ur(Iw,"onAnimationEnd");Ur(Tw,"onAnimationIteration");Ur(xw,"onAnimationStart");Ur("dblclick","onDoubleClick");Ur("focusin","onFocus");Ur("focusout","onBlur");Ur(Sw,"onTransitionEnd");Ni("onMouseEnter",["mouseout","mouseover"]);Ni("onMouseLeave",["mouseout","mouseover"]);Ni("onPointerEnter",["pointerout","pointerover"]);Ni("onPointerLeave",["pointerout","pointerover"]);js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));js("onBeforeInput",["compositionend","keypress","textInput","paste"]);js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mA=new Set("cancel close invalid load scroll toggle".split(" ").concat(jo));function Py(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,fS(r,e,void 0,t),t.currentTarget=null}function Rw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;Py(s,a,c),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,c=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;Py(s,a,c),i=u}}}if(Nu)throw t=Kd,Nu=!1,Kd=null,t}function _e(t,e){var n=e[tf];n===void 0&&(n=e[tf]=new Set);var r=t+"__bubble";n.has(r)||(Pw(e,t,2,!1),n.add(r))}function nd(t,e,n){var r=0;e&&(r|=4),Pw(n,t,r,e)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function wa(t){if(!t[Ml]){t[Ml]=!0,O0.forEach(function(n){n!=="selectionchange"&&(mA.has(n)||nd(n,!1,t),nd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ml]||(e[Ml]=!0,nd("selectionchange",!1,e))}}function Pw(t,e,n,r){switch(hw(e)){case 1:var s=kS;break;case 4:s=CS;break;default:s=yp}n=s.bind(null,e,n,t),s=void 0,!qd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function rd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=us(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}X0(function(){var c=i,d=fp(n),m=[];e:{var g=Aw.get(t);if(g!==void 0){var I=vp,x=t;switch(t){case"keypress":if(su(n)===0)break e;case"keydown":case"keyup":I=KS;break;case"focusin":x="focus",I=Yh;break;case"focusout":x="blur",I=Yh;break;case"beforeblur":case"afterblur":I=Yh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=gy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=DS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=GS;break;case Iw:case Tw:case xw:I=MS;break;case Sw:I=YS;break;case"scroll":I=NS;break;case"wheel":I=JS;break;case"copy":case"cut":case"paste":I=jS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=_y}var k=(e&4)!==0,C=!k&&t==="scroll",w=k?g!==null?g+"Capture":null:g;k=[];for(var _=c,E;_!==null;){E=_;var V=E.stateNode;if(E.tag===5&&V!==null&&(E=V,w!==null&&(V=pa(_,w),V!=null&&k.push(Ea(_,V,E)))),C)break;_=_.return}0<k.length&&(g=new I(g,x,null,n,d),m.push({event:g,listeners:k}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",g&&n!==Bd&&(x=n.relatedTarget||n.fromElement)&&(us(x)||x[jn]))break e;if((I||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,I?(x=n.relatedTarget||n.toElement,I=c,x=x?us(x):null,x!==null&&(C=Fs(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(I=null,x=c),I!==x)){if(k=gy,V="onMouseLeave",w="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(k=_y,V="onPointerLeave",w="onPointerEnter",_="pointer"),C=I==null?g:fi(I),E=x==null?g:fi(x),g=new k(V,_+"leave",I,n,d),g.target=C,g.relatedTarget=E,V=null,us(d)===c&&(k=new k(w,_+"enter",x,n,d),k.target=E,k.relatedTarget=C,V=k),C=V,I&&x)t:{for(k=I,w=x,_=0,E=k;E;E=Ys(E))_++;for(E=0,V=w;V;V=Ys(V))E++;for(;0<_-E;)k=Ys(k),_--;for(;0<E-_;)w=Ys(w),E--;for(;_--;){if(k===w||w!==null&&k===w.alternate)break t;k=Ys(k),w=Ys(w)}k=null}else k=null;I!==null&&ky(m,g,I,k,!1),x!==null&&C!==null&&ky(m,C,x,k,!0)}}e:{if(g=c?fi(c):window,I=g.nodeName&&g.nodeName.toLowerCase(),I==="select"||I==="input"&&g.type==="file")var L=iA;else if(Ey(g))if(yw)L=uA;else{L=aA;var j=oA}else(I=g.nodeName)&&I.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(L=lA);if(L&&(L=L(t,c))){gw(m,L,n,d);break e}j&&j(t,g,c),t==="focusout"&&(j=g._wrapperState)&&j.controlled&&g.type==="number"&&Ld(g,"number",g.value)}switch(j=c?fi(c):window,t){case"focusin":(Ey(j)||j.contentEditable==="true")&&(hi=j,Qd=c,Xo=null);break;case"focusout":Xo=Qd=hi=null;break;case"mousedown":Yd=!0;break;case"contextmenu":case"mouseup":case"dragend":Yd=!1,Ay(m,n,d);break;case"selectionchange":if(dA)break;case"keydown":case"keyup":Ay(m,n,d)}var T;if(Ep)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else ci?pw(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(fw&&n.locale!=="ko"&&(ci||v!=="onCompositionStart"?v==="onCompositionEnd"&&ci&&(T=dw()):(mr=d,_p="value"in mr?mr.value:mr.textContent,ci=!0)),j=Mu(c,v),0<j.length&&(v=new yy(v,t,null,n,d),m.push({event:v,listeners:j}),T?v.data=T:(T=mw(n),T!==null&&(v.data=T)))),(T=eA?tA(t,n):nA(t,n))&&(c=Mu(c,"onBeforeInput"),0<c.length&&(d=new yy("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:c}),d.data=T))}Rw(m,e)})}function Ea(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Mu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=pa(t,n),i!=null&&r.unshift(Ea(t,i,s)),i=pa(t,e),i!=null&&r.push(Ea(t,i,s))),t=t.return}return r}function Ys(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ky(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,s?(u=pa(n,i),u!=null&&o.unshift(Ea(n,u,a))):s||(u=pa(n,i),u!=null&&o.push(Ea(n,u,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var gA=/\r\n?/g,yA=/\u0000|\uFFFD/g;function Cy(t){return(typeof t=="string"?t:""+t).replace(gA,`
`).replace(yA,"")}function Ll(t,e,n){if(e=Cy(e),Cy(t)!==e&&n)throw Error(U(425))}function Lu(){}var Xd=null,Jd=null;function Zd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ef=typeof setTimeout=="function"?setTimeout:void 0,_A=typeof clearTimeout=="function"?clearTimeout:void 0,Ny=typeof Promise=="function"?Promise:void 0,vA=typeof queueMicrotask=="function"?queueMicrotask:typeof Ny<"u"?function(t){return Ny.resolve(null).then(t).catch(wA)}:ef;function wA(t){setTimeout(function(){throw t})}function sd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ya(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ya(e)}function Er(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function by(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var eo=Math.random().toString(36).slice(2),fn="__reactFiber$"+eo,Ia="__reactProps$"+eo,jn="__reactContainer$"+eo,tf="__reactEvents$"+eo,EA="__reactListeners$"+eo,IA="__reactHandles$"+eo;function us(t){var e=t[fn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jn]||n[fn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=by(t);t!==null;){if(n=t[fn])return n;t=by(t)}return e}t=n,n=t.parentNode}return null}function Ga(t){return t=t[fn]||t[jn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function fi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Dc(t){return t[Ia]||null}var nf=[],pi=-1;function zr(t){return{current:t}}function ve(t){0>pi||(t.current=nf[pi],nf[pi]=null,pi--)}function ge(t,e){pi++,nf[pi]=t.current,t.current=e}var br={},lt=zr(br),Et=zr(!1),ws=br;function bi(t,e){var n=t.type.contextTypes;if(!n)return br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function It(t){return t=t.childContextTypes,t!=null}function ju(){ve(Et),ve(lt)}function Dy(t,e,n){if(lt.current!==br)throw Error(U(168));ge(lt,e),ge(Et,n)}function kw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,oS(t)||"Unknown",s));return Ae({},n,r)}function Fu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||br,ws=lt.current,ge(lt,t),ge(Et,Et.current),!0}function Vy(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=kw(t,e,ws),r.__reactInternalMemoizedMergedChildContext=t,ve(Et),ve(lt),ge(lt,t)):ve(Et),ge(Et,n)}var kn=null,Vc=!1,id=!1;function Cw(t){kn===null?kn=[t]:kn.push(t)}function TA(t){Vc=!0,Cw(t)}function Br(){if(!id&&kn!==null){id=!0;var t=0,e=de;try{var n=kn;for(de=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}kn=null,Vc=!1}catch(s){throw kn!==null&&(kn=kn.slice(t+1)),tw(pp,Br),s}finally{de=e,id=!1}}return null}var mi=[],gi=0,Uu=null,zu=0,Mt=[],Lt=0,Es=null,Cn=1,Nn="";function es(t,e){mi[gi++]=zu,mi[gi++]=Uu,Uu=t,zu=e}function Nw(t,e,n){Mt[Lt++]=Cn,Mt[Lt++]=Nn,Mt[Lt++]=Es,Es=t;var r=Cn;t=Nn;var s=32-nn(r)-1;r&=~(1<<s),n+=1;var i=32-nn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Cn=1<<32-nn(e)+s|n<<s|r,Nn=i+t}else Cn=1<<i|n<<s|r,Nn=t}function Tp(t){t.return!==null&&(es(t,1),Nw(t,1,0))}function xp(t){for(;t===Uu;)Uu=mi[--gi],mi[gi]=null,zu=mi[--gi],mi[gi]=null;for(;t===Es;)Es=Mt[--Lt],Mt[Lt]=null,Nn=Mt[--Lt],Mt[Lt]=null,Cn=Mt[--Lt],Mt[Lt]=null}var Ct=null,Pt=null,Ee=!1,Zt=null;function bw(t,e){var n=Ft(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Oy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ct=t,Pt=Er(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ct=t,Pt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Es!==null?{id:Cn,overflow:Nn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ft(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ct=t,Pt=null,!0):!1;default:return!1}}function rf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sf(t){if(Ee){var e=Pt;if(e){var n=e;if(!Oy(t,e)){if(rf(t))throw Error(U(418));e=Er(n.nextSibling);var r=Ct;e&&Oy(t,e)?bw(r,n):(t.flags=t.flags&-4097|2,Ee=!1,Ct=t)}}else{if(rf(t))throw Error(U(418));t.flags=t.flags&-4097|2,Ee=!1,Ct=t}}}function My(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ct=t}function jl(t){if(t!==Ct)return!1;if(!Ee)return My(t),Ee=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Zd(t.type,t.memoizedProps)),e&&(e=Pt)){if(rf(t))throw Dw(),Error(U(418));for(;e;)bw(t,e),e=Er(e.nextSibling)}if(My(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pt=Er(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pt=null}}else Pt=Ct?Er(t.stateNode.nextSibling):null;return!0}function Dw(){for(var t=Pt;t;)t=Er(t.nextSibling)}function Di(){Pt=Ct=null,Ee=!1}function Sp(t){Zt===null?Zt=[t]:Zt.push(t)}var xA=Kn.ReactCurrentBatchConfig;function Ro(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Fl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ly(t){var e=t._init;return e(t._payload)}function Vw(t){function e(w,_){if(t){var E=w.deletions;E===null?(w.deletions=[_],w.flags|=16):E.push(_)}}function n(w,_){if(!t)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function r(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function s(w,_){return w=Sr(w,_),w.index=0,w.sibling=null,w}function i(w,_,E){return w.index=E,t?(E=w.alternate,E!==null?(E=E.index,E<_?(w.flags|=2,_):E):(w.flags|=2,_)):(w.flags|=1048576,_)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,_,E,V){return _===null||_.tag!==6?(_=dd(E,w.mode,V),_.return=w,_):(_=s(_,E),_.return=w,_)}function u(w,_,E,V){var L=E.type;return L===ui?d(w,_,E.props.children,V,E.key):_!==null&&(_.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===or&&Ly(L)===_.type)?(V=s(_,E.props),V.ref=Ro(w,_,E),V.return=w,V):(V=hu(E.type,E.key,E.props,null,w.mode,V),V.ref=Ro(w,_,E),V.return=w,V)}function c(w,_,E,V){return _===null||_.tag!==4||_.stateNode.containerInfo!==E.containerInfo||_.stateNode.implementation!==E.implementation?(_=fd(E,w.mode,V),_.return=w,_):(_=s(_,E.children||[]),_.return=w,_)}function d(w,_,E,V,L){return _===null||_.tag!==7?(_=ps(E,w.mode,V,L),_.return=w,_):(_=s(_,E),_.return=w,_)}function m(w,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return _=dd(""+_,w.mode,E),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Pl:return E=hu(_.type,_.key,_.props,null,w.mode,E),E.ref=Ro(w,null,_),E.return=w,E;case li:return _=fd(_,w.mode,E),_.return=w,_;case or:var V=_._init;return m(w,V(_._payload),E)}if(Mo(_)||Io(_))return _=ps(_,w.mode,E,null),_.return=w,_;Fl(w,_)}return null}function g(w,_,E,V){var L=_!==null?_.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return L!==null?null:a(w,_,""+E,V);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Pl:return E.key===L?u(w,_,E,V):null;case li:return E.key===L?c(w,_,E,V):null;case or:return L=E._init,g(w,_,L(E._payload),V)}if(Mo(E)||Io(E))return L!==null?null:d(w,_,E,V,null);Fl(w,E)}return null}function I(w,_,E,V,L){if(typeof V=="string"&&V!==""||typeof V=="number")return w=w.get(E)||null,a(_,w,""+V,L);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Pl:return w=w.get(V.key===null?E:V.key)||null,u(_,w,V,L);case li:return w=w.get(V.key===null?E:V.key)||null,c(_,w,V,L);case or:var j=V._init;return I(w,_,E,j(V._payload),L)}if(Mo(V)||Io(V))return w=w.get(E)||null,d(_,w,V,L,null);Fl(_,V)}return null}function x(w,_,E,V){for(var L=null,j=null,T=_,v=_=0,S=null;T!==null&&v<E.length;v++){T.index>v?(S=T,T=null):S=T.sibling;var R=g(w,T,E[v],V);if(R===null){T===null&&(T=S);break}t&&T&&R.alternate===null&&e(w,T),_=i(R,_,v),j===null?L=R:j.sibling=R,j=R,T=S}if(v===E.length)return n(w,T),Ee&&es(w,v),L;if(T===null){for(;v<E.length;v++)T=m(w,E[v],V),T!==null&&(_=i(T,_,v),j===null?L=T:j.sibling=T,j=T);return Ee&&es(w,v),L}for(T=r(w,T);v<E.length;v++)S=I(T,w,v,E[v],V),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?v:S.key),_=i(S,_,v),j===null?L=S:j.sibling=S,j=S);return t&&T.forEach(function(P){return e(w,P)}),Ee&&es(w,v),L}function k(w,_,E,V){var L=Io(E);if(typeof L!="function")throw Error(U(150));if(E=L.call(E),E==null)throw Error(U(151));for(var j=L=null,T=_,v=_=0,S=null,R=E.next();T!==null&&!R.done;v++,R=E.next()){T.index>v?(S=T,T=null):S=T.sibling;var P=g(w,T,R.value,V);if(P===null){T===null&&(T=S);break}t&&T&&P.alternate===null&&e(w,T),_=i(P,_,v),j===null?L=P:j.sibling=P,j=P,T=S}if(R.done)return n(w,T),Ee&&es(w,v),L;if(T===null){for(;!R.done;v++,R=E.next())R=m(w,R.value,V),R!==null&&(_=i(R,_,v),j===null?L=R:j.sibling=R,j=R);return Ee&&es(w,v),L}for(T=r(w,T);!R.done;v++,R=E.next())R=I(T,w,v,R.value,V),R!==null&&(t&&R.alternate!==null&&T.delete(R.key===null?v:R.key),_=i(R,_,v),j===null?L=R:j.sibling=R,j=R);return t&&T.forEach(function(b){return e(w,b)}),Ee&&es(w,v),L}function C(w,_,E,V){if(typeof E=="object"&&E!==null&&E.type===ui&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Pl:e:{for(var L=E.key,j=_;j!==null;){if(j.key===L){if(L=E.type,L===ui){if(j.tag===7){n(w,j.sibling),_=s(j,E.props.children),_.return=w,w=_;break e}}else if(j.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===or&&Ly(L)===j.type){n(w,j.sibling),_=s(j,E.props),_.ref=Ro(w,j,E),_.return=w,w=_;break e}n(w,j);break}else e(w,j);j=j.sibling}E.type===ui?(_=ps(E.props.children,w.mode,V,E.key),_.return=w,w=_):(V=hu(E.type,E.key,E.props,null,w.mode,V),V.ref=Ro(w,_,E),V.return=w,w=V)}return o(w);case li:e:{for(j=E.key;_!==null;){if(_.key===j)if(_.tag===4&&_.stateNode.containerInfo===E.containerInfo&&_.stateNode.implementation===E.implementation){n(w,_.sibling),_=s(_,E.children||[]),_.return=w,w=_;break e}else{n(w,_);break}else e(w,_);_=_.sibling}_=fd(E,w.mode,V),_.return=w,w=_}return o(w);case or:return j=E._init,C(w,_,j(E._payload),V)}if(Mo(E))return x(w,_,E,V);if(Io(E))return k(w,_,E,V);Fl(w,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,_!==null&&_.tag===6?(n(w,_.sibling),_=s(_,E),_.return=w,w=_):(n(w,_),_=dd(E,w.mode,V),_.return=w,w=_),o(w)):n(w,_)}return C}var Vi=Vw(!0),Ow=Vw(!1),Bu=zr(null),$u=null,yi=null,Ap=null;function Rp(){Ap=yi=$u=null}function Pp(t){var e=Bu.current;ve(Bu),t._currentValue=e}function of(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Si(t,e){$u=t,Ap=yi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vt=!0),t.firstContext=null)}function Kt(t){var e=t._currentValue;if(Ap!==t)if(t={context:t,memoizedValue:e,next:null},yi===null){if($u===null)throw Error(U(308));yi=t,$u.dependencies={lanes:0,firstContext:t}}else yi=yi.next=t;return e}var cs=null;function kp(t){cs===null?cs=[t]:cs.push(t)}function Mw(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,kp(e)):(n.next=s.next,s.next=n),e.interleaved=n,Fn(t,r)}function Fn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ar=!1;function Cp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function On(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ir(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,le&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Fn(t,n)}return s=r.interleaved,s===null?(e.next=e,kp(r)):(e.next=s.next,s.next=e),r.interleaved=e,Fn(t,n)}function iu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mp(t,n)}}function jy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function qu(t,e,n,r){var s=t.updateQueue;ar=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,d=c=u=null,a=i;do{var g=a.lane,I=a.eventTime;if((r&g)===g){d!==null&&(d=d.next={eventTime:I,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=t,k=a;switch(g=e,I=n,k.tag){case 1:if(x=k.payload,typeof x=="function"){m=x.call(I,m,g);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=k.payload,g=typeof x=="function"?x.call(I,m,g):x,g==null)break e;m=Ae({},m,g);break e;case 2:ar=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else I={eventTime:I,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=I,u=m):d=d.next=I,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(d===null&&(u=m),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ts|=o,t.lanes=o,t.memoizedState=m}}function Fy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var Qa={},yn=zr(Qa),Ta=zr(Qa),xa=zr(Qa);function hs(t){if(t===Qa)throw Error(U(174));return t}function Np(t,e){switch(ge(xa,e),ge(Ta,t),ge(yn,Qa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fd(e,t)}ve(yn),ge(yn,e)}function Oi(){ve(yn),ve(Ta),ve(xa)}function jw(t){hs(xa.current);var e=hs(yn.current),n=Fd(e,t.type);e!==n&&(ge(Ta,t),ge(yn,n))}function bp(t){Ta.current===t&&(ve(yn),ve(Ta))}var Te=zr(0);function Ku(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var od=[];function Dp(){for(var t=0;t<od.length;t++)od[t]._workInProgressVersionPrimary=null;od.length=0}var ou=Kn.ReactCurrentDispatcher,ad=Kn.ReactCurrentBatchConfig,Is=0,Se=null,je=null,qe=null,Wu=!1,Jo=!1,Sa=0,SA=0;function nt(){throw Error(U(321))}function Vp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sn(t[n],e[n]))return!1;return!0}function Op(t,e,n,r,s,i){if(Is=i,Se=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ou.current=t===null||t.memoizedState===null?kA:CA,t=n(r,s),Jo){i=0;do{if(Jo=!1,Sa=0,25<=i)throw Error(U(301));i+=1,qe=je=null,e.updateQueue=null,ou.current=NA,t=n(r,s)}while(Jo)}if(ou.current=Hu,e=je!==null&&je.next!==null,Is=0,qe=je=Se=null,Wu=!1,e)throw Error(U(300));return t}function Mp(){var t=Sa!==0;return Sa=0,t}function hn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Se.memoizedState=qe=t:qe=qe.next=t,qe}function Wt(){if(je===null){var t=Se.alternate;t=t!==null?t.memoizedState:null}else t=je.next;var e=qe===null?Se.memoizedState:qe.next;if(e!==null)qe=e,je=t;else{if(t===null)throw Error(U(310));je=t,t={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},qe===null?Se.memoizedState=qe=t:qe=qe.next=t}return qe}function Aa(t,e){return typeof e=="function"?e(t):e}function ld(t){var e=Wt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=je,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,c=i;do{var d=c.lane;if((Is&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var m={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=m,o=r):u=u.next=m,Se.lanes|=d,Ts|=d}c=c.next}while(c!==null&&c!==i);u===null?o=r:u.next=a,sn(r,e.memoizedState)||(vt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Se.lanes|=i,Ts|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ud(t){var e=Wt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);sn(i,e.memoizedState)||(vt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Fw(){}function Uw(t,e){var n=Se,r=Wt(),s=e(),i=!sn(r.memoizedState,s);if(i&&(r.memoizedState=s,vt=!0),r=r.queue,Lp($w.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,Ra(9,Bw.bind(null,n,r,s,e),void 0,null),Ke===null)throw Error(U(349));Is&30||zw(n,e,s)}return s}function zw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Bw(t,e,n,r){e.value=n,e.getSnapshot=r,qw(e)&&Kw(t)}function $w(t,e,n){return n(function(){qw(e)&&Kw(t)})}function qw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sn(t,n)}catch{return!0}}function Kw(t){var e=Fn(t,1);e!==null&&rn(e,t,1,-1)}function Uy(t){var e=hn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:t},e.queue=t,t=t.dispatch=PA.bind(null,Se,t),[e.memoizedState,t]}function Ra(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ww(){return Wt().memoizedState}function au(t,e,n,r){var s=hn();Se.flags|=t,s.memoizedState=Ra(1|e,n,void 0,r===void 0?null:r)}function Oc(t,e,n,r){var s=Wt();r=r===void 0?null:r;var i=void 0;if(je!==null){var o=je.memoizedState;if(i=o.destroy,r!==null&&Vp(r,o.deps)){s.memoizedState=Ra(e,n,i,r);return}}Se.flags|=t,s.memoizedState=Ra(1|e,n,i,r)}function zy(t,e){return au(8390656,8,t,e)}function Lp(t,e){return Oc(2048,8,t,e)}function Hw(t,e){return Oc(4,2,t,e)}function Gw(t,e){return Oc(4,4,t,e)}function Qw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yw(t,e,n){return n=n!=null?n.concat([t]):null,Oc(4,4,Qw.bind(null,e,t),n)}function jp(){}function Xw(t,e){var n=Wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Jw(t,e){var n=Wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Vp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Zw(t,e,n){return Is&21?(sn(n,e)||(n=sw(),Se.lanes|=n,Ts|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vt=!0),t.memoizedState=n)}function AA(t,e){var n=de;de=n!==0&&4>n?n:4,t(!0);var r=ad.transition;ad.transition={};try{t(!1),e()}finally{de=n,ad.transition=r}}function eE(){return Wt().memoizedState}function RA(t,e,n){var r=xr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tE(t))nE(e,n);else if(n=Mw(t,e,n,r),n!==null){var s=ft();rn(n,t,r,s),rE(n,e,r)}}function PA(t,e,n){var r=xr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tE(t))nE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,sn(a,o)){var u=e.interleaved;u===null?(s.next=s,kp(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Mw(t,e,s,r),n!==null&&(s=ft(),rn(n,t,r,s),rE(n,e,r))}}function tE(t){var e=t.alternate;return t===Se||e!==null&&e===Se}function nE(t,e){Jo=Wu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mp(t,n)}}var Hu={readContext:Kt,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useInsertionEffect:nt,useLayoutEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useMutableSource:nt,useSyncExternalStore:nt,useId:nt,unstable_isNewReconciler:!1},kA={readContext:Kt,useCallback:function(t,e){return hn().memoizedState=[t,e===void 0?null:e],t},useContext:Kt,useEffect:zy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,au(4194308,4,Qw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return au(4194308,4,t,e)},useInsertionEffect:function(t,e){return au(4,2,t,e)},useMemo:function(t,e){var n=hn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=RA.bind(null,Se,t),[r.memoizedState,t]},useRef:function(t){var e=hn();return t={current:t},e.memoizedState=t},useState:Uy,useDebugValue:jp,useDeferredValue:function(t){return hn().memoizedState=t},useTransition:function(){var t=Uy(!1),e=t[0];return t=AA.bind(null,t[1]),hn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Se,s=hn();if(Ee){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),Ke===null)throw Error(U(349));Is&30||zw(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,zy($w.bind(null,r,i,t),[t]),r.flags|=2048,Ra(9,Bw.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=hn(),e=Ke.identifierPrefix;if(Ee){var n=Nn,r=Cn;n=(r&~(1<<32-nn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Sa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=SA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CA={readContext:Kt,useCallback:Xw,useContext:Kt,useEffect:Lp,useImperativeHandle:Yw,useInsertionEffect:Hw,useLayoutEffect:Gw,useMemo:Jw,useReducer:ld,useRef:Ww,useState:function(){return ld(Aa)},useDebugValue:jp,useDeferredValue:function(t){var e=Wt();return Zw(e,je.memoizedState,t)},useTransition:function(){var t=ld(Aa)[0],e=Wt().memoizedState;return[t,e]},useMutableSource:Fw,useSyncExternalStore:Uw,useId:eE,unstable_isNewReconciler:!1},NA={readContext:Kt,useCallback:Xw,useContext:Kt,useEffect:Lp,useImperativeHandle:Yw,useInsertionEffect:Hw,useLayoutEffect:Gw,useMemo:Jw,useReducer:ud,useRef:Ww,useState:function(){return ud(Aa)},useDebugValue:jp,useDeferredValue:function(t){var e=Wt();return je===null?e.memoizedState=t:Zw(e,je.memoizedState,t)},useTransition:function(){var t=ud(Aa)[0],e=Wt().memoizedState;return[t,e]},useMutableSource:Fw,useSyncExternalStore:Uw,useId:eE,unstable_isNewReconciler:!1};function Yt(t,e){if(t&&t.defaultProps){e=Ae({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function af(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ae({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Mc={isMounted:function(t){return(t=t._reactInternals)?Fs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ft(),s=xr(t),i=On(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(rn(e,t,s,r),iu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ft(),s=xr(t),i=On(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(rn(e,t,s,r),iu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ft(),r=xr(t),s=On(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ir(t,s,r),e!==null&&(rn(e,t,r,n),iu(e,t,r))}};function By(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!va(n,r)||!va(s,i):!0}function sE(t,e,n){var r=!1,s=br,i=e.contextType;return typeof i=="object"&&i!==null?i=Kt(i):(s=It(e)?ws:lt.current,r=e.contextTypes,i=(r=r!=null)?bi(t,s):br),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function $y(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Mc.enqueueReplaceState(e,e.state,null)}function lf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Cp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Kt(i):(i=It(e)?ws:lt.current,s.context=bi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(af(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Mc.enqueueReplaceState(s,s.state,null),qu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Mi(t,e){try{var n="",r=e;do n+=iS(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function cd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function uf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var bA=typeof WeakMap=="function"?WeakMap:Map;function iE(t,e,n){n=On(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qu||(Qu=!0,vf=r),uf(t,e)},n}function oE(t,e,n){n=On(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){uf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){uf(t,e),typeof r!="function"&&(Tr===null?Tr=new Set([this]):Tr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function qy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new bA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=WA.bind(null,t,e,n),e.then(t,t))}function Ky(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Wy(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=On(-1,1),e.tag=2,Ir(n,e,1))),n.lanes|=1),t)}var DA=Kn.ReactCurrentOwner,vt=!1;function ht(t,e,n,r){e.child=t===null?Ow(e,null,n,r):Vi(e,t.child,n,r)}function Hy(t,e,n,r,s){n=n.render;var i=e.ref;return Si(e,s),r=Op(t,e,n,r,i,s),n=Mp(),t!==null&&!vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Un(t,e,s)):(Ee&&n&&Tp(e),e.flags|=1,ht(t,e,r,s),e.child)}function Gy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Wp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,aE(t,e,i,r,s)):(t=hu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:va,n(o,r)&&t.ref===e.ref)return Un(t,e,s)}return e.flags|=1,t=Sr(i,r),t.ref=e.ref,t.return=e,e.child=t}function aE(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(va(i,r)&&t.ref===e.ref)if(vt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(vt=!0);else return e.lanes=t.lanes,Un(t,e,s)}return cf(t,e,n,r,s)}function lE(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ge(vi,St),St|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ge(vi,St),St|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ge(vi,St),St|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ge(vi,St),St|=r;return ht(t,e,s,n),e.child}function uE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cf(t,e,n,r,s){var i=It(n)?ws:lt.current;return i=bi(e,i),Si(e,s),n=Op(t,e,n,r,i,s),r=Mp(),t!==null&&!vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Un(t,e,s)):(Ee&&r&&Tp(e),e.flags|=1,ht(t,e,n,s),e.child)}function Qy(t,e,n,r,s){if(It(n)){var i=!0;Fu(e)}else i=!1;if(Si(e,s),e.stateNode===null)lu(t,e),sE(e,n,r),lf(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Kt(c):(c=It(n)?ws:lt.current,c=bi(e,c));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==c)&&$y(e,o,r,c),ar=!1;var g=e.memoizedState;o.state=g,qu(e,r,o,s),u=e.memoizedState,a!==r||g!==u||Et.current||ar?(typeof d=="function"&&(af(e,n,d,r),u=e.memoizedState),(a=ar||By(e,n,a,r,g,u,c))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Lw(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Yt(e.type,a),o.props=c,m=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Kt(u):(u=It(n)?ws:lt.current,u=bi(e,u));var I=n.getDerivedStateFromProps;(d=typeof I=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==u)&&$y(e,o,r,u),ar=!1,g=e.memoizedState,o.state=g,qu(e,r,o,s);var x=e.memoizedState;a!==m||g!==x||Et.current||ar?(typeof I=="function"&&(af(e,n,I,r),x=e.memoizedState),(c=ar||By(e,n,c,r,g,x,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return hf(t,e,n,r,i,s)}function hf(t,e,n,r,s,i){uE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Vy(e,n,!1),Un(t,e,i);r=e.stateNode,DA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Vi(e,t.child,null,i),e.child=Vi(e,null,a,i)):ht(t,e,a,i),e.memoizedState=r.state,s&&Vy(e,n,!0),e.child}function cE(t){var e=t.stateNode;e.pendingContext?Dy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Dy(t,e.context,!1),Np(t,e.containerInfo)}function Yy(t,e,n,r,s){return Di(),Sp(s),e.flags|=256,ht(t,e,n,r),e.child}var df={dehydrated:null,treeContext:null,retryLane:0};function ff(t){return{baseLanes:t,cachePool:null,transitions:null}}function hE(t,e,n){var r=e.pendingProps,s=Te.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ge(Te,s&1),t===null)return sf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Fc(o,r,0,null),t=ps(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ff(n),e.memoizedState=df,t):Fp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return VA(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Sr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Sr(a,i):(i=ps(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?ff(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=df,r}return i=t.child,t=i.sibling,r=Sr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Fp(t,e){return e=Fc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ul(t,e,n,r){return r!==null&&Sp(r),Vi(e,t.child,null,n),t=Fp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function VA(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=cd(Error(U(422))),Ul(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Fc({mode:"visible",children:r.children},s,0,null),i=ps(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Vi(e,t.child,null,o),e.child.memoizedState=ff(o),e.memoizedState=df,i);if(!(e.mode&1))return Ul(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(U(419)),r=cd(i,r,void 0),Ul(t,e,o,r)}if(a=(o&t.childLanes)!==0,vt||a){if(r=Ke,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Fn(t,s),rn(r,t,s,-1))}return Kp(),r=cd(Error(U(421))),Ul(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=HA.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Pt=Er(s.nextSibling),Ct=e,Ee=!0,Zt=null,t!==null&&(Mt[Lt++]=Cn,Mt[Lt++]=Nn,Mt[Lt++]=Es,Cn=t.id,Nn=t.overflow,Es=e),e=Fp(e,r.children),e.flags|=4096,e)}function Xy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),of(t.return,e,n)}function hd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function dE(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ht(t,e,r.children,n),r=Te.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Xy(t,n,e);else if(t.tag===19)Xy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ge(Te,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ku(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ku(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hd(e,!0,n,null,i);break;case"together":hd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Un(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ts|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Sr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Sr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OA(t,e,n){switch(e.tag){case 3:cE(e),Di();break;case 5:jw(e);break;case 1:It(e.type)&&Fu(e);break;case 4:Np(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ge(Bu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ge(Te,Te.current&1),e.flags|=128,null):n&e.child.childLanes?hE(t,e,n):(ge(Te,Te.current&1),t=Un(t,e,n),t!==null?t.sibling:null);ge(Te,Te.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dE(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ge(Te,Te.current),r)break;return null;case 22:case 23:return e.lanes=0,lE(t,e,n)}return Un(t,e,n)}var fE,pf,pE,mE;fE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pf=function(){};pE=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,hs(yn.current);var i=null;switch(n){case"input":s=Od(t,s),r=Od(t,r),i=[];break;case"select":s=Ae({},s,{value:void 0}),r=Ae({},r,{value:void 0}),i=[];break;case"textarea":s=jd(t,s),r=jd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Lu)}Ud(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(da.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(da.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&_e("scroll",t),i||a===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};mE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Po(t,e){if(!Ee)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function rt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function MA(t,e,n){var r=e.pendingProps;switch(xp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(e),null;case 1:return It(e.type)&&ju(),rt(e),null;case 3:return r=e.stateNode,Oi(),ve(Et),ve(lt),Dp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(jl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zt!==null&&(If(Zt),Zt=null))),pf(t,e),rt(e),null;case 5:bp(e);var s=hs(xa.current);if(n=e.type,t!==null&&e.stateNode!=null)pE(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return rt(e),null}if(t=hs(yn.current),jl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[fn]=e,r[Ia]=i,t=(e.mode&1)!==0,n){case"dialog":_e("cancel",r),_e("close",r);break;case"iframe":case"object":case"embed":_e("load",r);break;case"video":case"audio":for(s=0;s<jo.length;s++)_e(jo[s],r);break;case"source":_e("error",r);break;case"img":case"image":case"link":_e("error",r),_e("load",r);break;case"details":_e("toggle",r);break;case"input":oy(r,i),_e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},_e("invalid",r);break;case"textarea":ly(r,i),_e("invalid",r)}Ud(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Ll(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Ll(r.textContent,a,t),s=["children",""+a]):da.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&_e("scroll",r)}switch(n){case"input":kl(r),ay(r,i,!0);break;case"textarea":kl(r),uy(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Lu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[fn]=e,t[Ia]=r,fE(t,e,!1,!1),e.stateNode=t;e:{switch(o=zd(n,r),n){case"dialog":_e("cancel",t),_e("close",t),s=r;break;case"iframe":case"object":case"embed":_e("load",t),s=r;break;case"video":case"audio":for(s=0;s<jo.length;s++)_e(jo[s],t);s=r;break;case"source":_e("error",t),s=r;break;case"img":case"image":case"link":_e("error",t),_e("load",t),s=r;break;case"details":_e("toggle",t),s=r;break;case"input":oy(t,r),s=Od(t,r),_e("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ae({},r,{value:void 0}),_e("invalid",t);break;case"textarea":ly(t,r),s=jd(t,r),_e("invalid",t);break;default:s=r}Ud(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?W0(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&q0(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&fa(t,u):typeof u=="number"&&fa(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(da.hasOwnProperty(i)?u!=null&&i==="onScroll"&&_e("scroll",t):u!=null&&up(t,i,u,o))}switch(n){case"input":kl(t),ay(t,r,!1);break;case"textarea":kl(t),uy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Nr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ei(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ei(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Lu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return rt(e),null;case 6:if(t&&e.stateNode!=null)mE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=hs(xa.current),hs(yn.current),jl(e)){if(r=e.stateNode,n=e.memoizedProps,r[fn]=e,(i=r.nodeValue!==n)&&(t=Ct,t!==null))switch(t.tag){case 3:Ll(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ll(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fn]=e,e.stateNode=r}return rt(e),null;case 13:if(ve(Te),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ee&&Pt!==null&&e.mode&1&&!(e.flags&128))Dw(),Di(),e.flags|=98560,i=!1;else if(i=jl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[fn]=e}else Di(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;rt(e),i=!1}else Zt!==null&&(If(Zt),Zt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Te.current&1?Fe===0&&(Fe=3):Kp())),e.updateQueue!==null&&(e.flags|=4),rt(e),null);case 4:return Oi(),pf(t,e),t===null&&wa(e.stateNode.containerInfo),rt(e),null;case 10:return Pp(e.type._context),rt(e),null;case 17:return It(e.type)&&ju(),rt(e),null;case 19:if(ve(Te),i=e.memoizedState,i===null)return rt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Po(i,!1);else{if(Fe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ku(t),o!==null){for(e.flags|=128,Po(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ge(Te,Te.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ce()>Li&&(e.flags|=128,r=!0,Po(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ku(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Po(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ee)return rt(e),null}else 2*Ce()-i.renderingStartTime>Li&&n!==1073741824&&(e.flags|=128,r=!0,Po(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ce(),e.sibling=null,n=Te.current,ge(Te,r?n&1|2:n&1),e):(rt(e),null);case 22:case 23:return qp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?St&1073741824&&(rt(e),e.subtreeFlags&6&&(e.flags|=8192)):rt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function LA(t,e){switch(xp(e),e.tag){case 1:return It(e.type)&&ju(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oi(),ve(Et),ve(lt),Dp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bp(e),null;case 13:if(ve(Te),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Di()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ve(Te),null;case 4:return Oi(),null;case 10:return Pp(e.type._context),null;case 22:case 23:return qp(),null;case 24:return null;default:return null}}var zl=!1,ot=!1,jA=typeof WeakSet=="function"?WeakSet:Set,G=null;function _i(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pe(t,e,r)}else n.current=null}function mf(t,e,n){try{n()}catch(r){Pe(t,e,r)}}var Jy=!1;function FA(t,e){if(Xd=Vu,t=ww(),Ip(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,u=-1,c=0,d=0,m=t,g=null;t:for(;;){for(var I;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(u=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(I=m.firstChild)!==null;)g=m,m=I;for(;;){if(m===t)break t;if(g===n&&++c===s&&(a=o),g===i&&++d===r&&(u=o),(I=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=I}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jd={focusedElem:t,selectionRange:n},Vu=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var k=x.memoizedProps,C=x.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?k:Yt(e.type,k),C);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(V){Pe(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return x=Jy,Jy=!1,x}function Zo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&mf(e,n,i)}s=s.next}while(s!==r)}}function Lc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gE(t){var e=t.alternate;e!==null&&(t.alternate=null,gE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fn],delete e[Ia],delete e[tf],delete e[EA],delete e[IA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yE(t){return t.tag===5||t.tag===3||t.tag===4}function Zy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Lu));else if(r!==4&&(t=t.child,t!==null))for(yf(t,e,n),t=t.sibling;t!==null;)yf(t,e,n),t=t.sibling}function _f(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(_f(t,e,n),t=t.sibling;t!==null;)_f(t,e,n),t=t.sibling}var Qe=null,Xt=!1;function tr(t,e,n){for(n=n.child;n!==null;)_E(t,e,n),n=n.sibling}function _E(t,e,n){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(kc,n)}catch{}switch(n.tag){case 5:ot||_i(n,e);case 6:var r=Qe,s=Xt;Qe=null,tr(t,e,n),Qe=r,Xt=s,Qe!==null&&(Xt?(t=Qe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qe.removeChild(n.stateNode));break;case 18:Qe!==null&&(Xt?(t=Qe,n=n.stateNode,t.nodeType===8?sd(t.parentNode,n):t.nodeType===1&&sd(t,n),ya(t)):sd(Qe,n.stateNode));break;case 4:r=Qe,s=Xt,Qe=n.stateNode.containerInfo,Xt=!0,tr(t,e,n),Qe=r,Xt=s;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&mf(n,e,o),s=s.next}while(s!==r)}tr(t,e,n);break;case 1:if(!ot&&(_i(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Pe(n,e,a)}tr(t,e,n);break;case 21:tr(t,e,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,tr(t,e,n),ot=r):tr(t,e,n);break;default:tr(t,e,n)}}function e_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jA),e.forEach(function(r){var s=GA.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Qt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Qe=a.stateNode,Xt=!1;break e;case 3:Qe=a.stateNode.containerInfo,Xt=!0;break e;case 4:Qe=a.stateNode.containerInfo,Xt=!0;break e}a=a.return}if(Qe===null)throw Error(U(160));_E(i,o,s),Qe=null,Xt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Pe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vE(e,t),e=e.sibling}function vE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qt(e,t),cn(t),r&4){try{Zo(3,t,t.return),Lc(3,t)}catch(k){Pe(t,t.return,k)}try{Zo(5,t,t.return)}catch(k){Pe(t,t.return,k)}}break;case 1:Qt(e,t),cn(t),r&512&&n!==null&&_i(n,n.return);break;case 5:if(Qt(e,t),cn(t),r&512&&n!==null&&_i(n,n.return),t.flags&32){var s=t.stateNode;try{fa(s,"")}catch(k){Pe(t,t.return,k)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&z0(s,i),zd(a,o);var c=zd(a,i);for(o=0;o<u.length;o+=2){var d=u[o],m=u[o+1];d==="style"?W0(s,m):d==="dangerouslySetInnerHTML"?q0(s,m):d==="children"?fa(s,m):up(s,d,m,c)}switch(a){case"input":Md(s,i);break;case"textarea":B0(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var I=i.value;I!=null?Ei(s,!!i.multiple,I,!1):g!==!!i.multiple&&(i.defaultValue!=null?Ei(s,!!i.multiple,i.defaultValue,!0):Ei(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ia]=i}catch(k){Pe(t,t.return,k)}}break;case 6:if(Qt(e,t),cn(t),r&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(k){Pe(t,t.return,k)}}break;case 3:if(Qt(e,t),cn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ya(e.containerInfo)}catch(k){Pe(t,t.return,k)}break;case 4:Qt(e,t),cn(t);break;case 13:Qt(e,t),cn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Bp=Ce())),r&4&&e_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(ot=(c=ot)||d,Qt(e,t),ot=c):Qt(e,t),cn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(G=t,d=t.child;d!==null;){for(m=G=d;G!==null;){switch(g=G,I=g.child,g.tag){case 0:case 11:case 14:case 15:Zo(4,g,g.return);break;case 1:_i(g,g.return);var x=g.stateNode;if(typeof x.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(k){Pe(r,n,k)}}break;case 5:_i(g,g.return);break;case 22:if(g.memoizedState!==null){n_(m);continue}}I!==null?(I.return=g,G=I):n_(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=K0("display",o))}catch(k){Pe(t,t.return,k)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(k){Pe(t,t.return,k)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Qt(e,t),cn(t),r&4&&e_(t);break;case 21:break;default:Qt(e,t),cn(t)}}function cn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yE(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(fa(s,""),r.flags&=-33);var i=Zy(t);_f(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Zy(t);yf(t,a,o);break;default:throw Error(U(161))}}catch(u){Pe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function UA(t,e,n){G=t,wE(t)}function wE(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||zl;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||ot;a=zl;var c=ot;if(zl=o,(ot=u)&&!c)for(G=s;G!==null;)o=G,u=o.child,o.tag===22&&o.memoizedState!==null?r_(s):u!==null?(u.return=o,G=u):r_(s);for(;i!==null;)G=i,wE(i),i=i.sibling;G=s,zl=a,ot=c}t_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):t_(t)}}function t_(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ot||Lc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ot)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Yt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Fy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Fy(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&ya(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}ot||e.flags&512&&gf(e)}catch(g){Pe(e,e.return,g)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function n_(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function r_(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lc(4,e)}catch(u){Pe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Pe(e,s,u)}}var i=e.return;try{gf(e)}catch(u){Pe(e,i,u)}break;case 5:var o=e.return;try{gf(e)}catch(u){Pe(e,o,u)}}}catch(u){Pe(e,e.return,u)}if(e===t){G=null;break}var a=e.sibling;if(a!==null){a.return=e.return,G=a;break}G=e.return}}var zA=Math.ceil,Gu=Kn.ReactCurrentDispatcher,Up=Kn.ReactCurrentOwner,Bt=Kn.ReactCurrentBatchConfig,le=0,Ke=null,De=null,Je=0,St=0,vi=zr(0),Fe=0,Pa=null,Ts=0,jc=0,zp=0,ea=null,yt=null,Bp=0,Li=1/0,Pn=null,Qu=!1,vf=null,Tr=null,Bl=!1,gr=null,Yu=0,ta=0,wf=null,uu=-1,cu=0;function ft(){return le&6?Ce():uu!==-1?uu:uu=Ce()}function xr(t){return t.mode&1?le&2&&Je!==0?Je&-Je:xA.transition!==null?(cu===0&&(cu=sw()),cu):(t=de,t!==0||(t=window.event,t=t===void 0?16:hw(t.type)),t):1}function rn(t,e,n,r){if(50<ta)throw ta=0,wf=null,Error(U(185));Wa(t,n,r),(!(le&2)||t!==Ke)&&(t===Ke&&(!(le&2)&&(jc|=n),Fe===4&&ur(t,Je)),Tt(t,r),n===1&&le===0&&!(e.mode&1)&&(Li=Ce()+500,Vc&&Br()))}function Tt(t,e){var n=t.callbackNode;xS(t,e);var r=Du(t,t===Ke?Je:0);if(r===0)n!==null&&dy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&dy(n),e===1)t.tag===0?TA(s_.bind(null,t)):Cw(s_.bind(null,t)),vA(function(){!(le&6)&&Br()}),n=null;else{switch(iw(r)){case 1:n=pp;break;case 4:n=nw;break;case 16:n=bu;break;case 536870912:n=rw;break;default:n=bu}n=PE(n,EE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function EE(t,e){if(uu=-1,cu=0,le&6)throw Error(U(327));var n=t.callbackNode;if(Ai()&&t.callbackNode!==n)return null;var r=Du(t,t===Ke?Je:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Xu(t,r);else{e=r;var s=le;le|=2;var i=TE();(Ke!==t||Je!==e)&&(Pn=null,Li=Ce()+500,fs(t,e));do try{qA();break}catch(a){IE(t,a)}while(!0);Rp(),Gu.current=i,le=s,De!==null?e=0:(Ke=null,Je=0,e=Fe)}if(e!==0){if(e===2&&(s=Wd(t),s!==0&&(r=s,e=Ef(t,s))),e===1)throw n=Pa,fs(t,0),ur(t,r),Tt(t,Ce()),n;if(e===6)ur(t,r);else{if(s=t.current.alternate,!(r&30)&&!BA(s)&&(e=Xu(t,r),e===2&&(i=Wd(t),i!==0&&(r=i,e=Ef(t,i))),e===1))throw n=Pa,fs(t,0),ur(t,r),Tt(t,Ce()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:ts(t,yt,Pn);break;case 3:if(ur(t,r),(r&130023424)===r&&(e=Bp+500-Ce(),10<e)){if(Du(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ft(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ef(ts.bind(null,t,yt,Pn),e);break}ts(t,yt,Pn);break;case 4:if(ur(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-nn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ce()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zA(r/1960))-r,10<r){t.timeoutHandle=ef(ts.bind(null,t,yt,Pn),r);break}ts(t,yt,Pn);break;case 5:ts(t,yt,Pn);break;default:throw Error(U(329))}}}return Tt(t,Ce()),t.callbackNode===n?EE.bind(null,t):null}function Ef(t,e){var n=ea;return t.current.memoizedState.isDehydrated&&(fs(t,e).flags|=256),t=Xu(t,e),t!==2&&(e=yt,yt=n,e!==null&&If(e)),t}function If(t){yt===null?yt=t:yt.push.apply(yt,t)}function BA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!sn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ur(t,e){for(e&=~zp,e&=~jc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-nn(e),r=1<<n;t[n]=-1,e&=~r}}function s_(t){if(le&6)throw Error(U(327));Ai();var e=Du(t,0);if(!(e&1))return Tt(t,Ce()),null;var n=Xu(t,e);if(t.tag!==0&&n===2){var r=Wd(t);r!==0&&(e=r,n=Ef(t,r))}if(n===1)throw n=Pa,fs(t,0),ur(t,e),Tt(t,Ce()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ts(t,yt,Pn),Tt(t,Ce()),null}function $p(t,e){var n=le;le|=1;try{return t(e)}finally{le=n,le===0&&(Li=Ce()+500,Vc&&Br())}}function xs(t){gr!==null&&gr.tag===0&&!(le&6)&&Ai();var e=le;le|=1;var n=Bt.transition,r=de;try{if(Bt.transition=null,de=1,t)return t()}finally{de=r,Bt.transition=n,le=e,!(le&6)&&Br()}}function qp(){St=vi.current,ve(vi)}function fs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_A(n)),De!==null)for(n=De.return;n!==null;){var r=n;switch(xp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ju();break;case 3:Oi(),ve(Et),ve(lt),Dp();break;case 5:bp(r);break;case 4:Oi();break;case 13:ve(Te);break;case 19:ve(Te);break;case 10:Pp(r.type._context);break;case 22:case 23:qp()}n=n.return}if(Ke=t,De=t=Sr(t.current,null),Je=St=e,Fe=0,Pa=null,zp=jc=Ts=0,yt=ea=null,cs!==null){for(e=0;e<cs.length;e++)if(n=cs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}cs=null}return t}function IE(t,e){do{var n=De;try{if(Rp(),ou.current=Hu,Wu){for(var r=Se.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Wu=!1}if(Is=0,qe=je=Se=null,Jo=!1,Sa=0,Up.current=null,n===null||n.return===null){Fe=1,Pa=e,De=null;break}e:{var i=t,o=n.return,a=n,u=e;if(e=Je,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=a,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var I=Ky(o);if(I!==null){I.flags&=-257,Wy(I,o,a,i,e),I.mode&1&&qy(i,c,e),e=I,u=c;var x=e.updateQueue;if(x===null){var k=new Set;k.add(u),e.updateQueue=k}else x.add(u);break e}else{if(!(e&1)){qy(i,c,e),Kp();break e}u=Error(U(426))}}else if(Ee&&a.mode&1){var C=Ky(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Wy(C,o,a,i,e),Sp(Mi(u,a));break e}}i=u=Mi(u,a),Fe!==4&&(Fe=2),ea===null?ea=[i]:ea.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=iE(i,u,e);jy(i,w);break e;case 1:a=u;var _=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Tr===null||!Tr.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var V=oE(i,a,e);jy(i,V);break e}}i=i.return}while(i!==null)}SE(n)}catch(L){e=L,De===n&&n!==null&&(De=n=n.return);continue}break}while(!0)}function TE(){var t=Gu.current;return Gu.current=Hu,t===null?Hu:t}function Kp(){(Fe===0||Fe===3||Fe===2)&&(Fe=4),Ke===null||!(Ts&268435455)&&!(jc&268435455)||ur(Ke,Je)}function Xu(t,e){var n=le;le|=2;var r=TE();(Ke!==t||Je!==e)&&(Pn=null,fs(t,e));do try{$A();break}catch(s){IE(t,s)}while(!0);if(Rp(),le=n,Gu.current=r,De!==null)throw Error(U(261));return Ke=null,Je=0,Fe}function $A(){for(;De!==null;)xE(De)}function qA(){for(;De!==null&&!mS();)xE(De)}function xE(t){var e=RE(t.alternate,t,St);t.memoizedProps=t.pendingProps,e===null?SE(t):De=e,Up.current=null}function SE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=LA(n,e),n!==null){n.flags&=32767,De=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Fe=6,De=null;return}}else if(n=MA(n,e,St),n!==null){De=n;return}if(e=e.sibling,e!==null){De=e;return}De=e=t}while(e!==null);Fe===0&&(Fe=5)}function ts(t,e,n){var r=de,s=Bt.transition;try{Bt.transition=null,de=1,KA(t,e,n,r)}finally{Bt.transition=s,de=r}return null}function KA(t,e,n,r){do Ai();while(gr!==null);if(le&6)throw Error(U(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(SS(t,i),t===Ke&&(De=Ke=null,Je=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bl||(Bl=!0,PE(bu,function(){return Ai(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Bt.transition,Bt.transition=null;var o=de;de=1;var a=le;le|=4,Up.current=null,FA(t,n),vE(n,t),hA(Jd),Vu=!!Xd,Jd=Xd=null,t.current=n,UA(n),gS(),le=a,de=o,Bt.transition=i}else t.current=n;if(Bl&&(Bl=!1,gr=t,Yu=s),i=t.pendingLanes,i===0&&(Tr=null),vS(n.stateNode),Tt(t,Ce()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Qu)throw Qu=!1,t=vf,vf=null,t;return Yu&1&&t.tag!==0&&Ai(),i=t.pendingLanes,i&1?t===wf?ta++:(ta=0,wf=t):ta=0,Br(),null}function Ai(){if(gr!==null){var t=iw(Yu),e=Bt.transition,n=de;try{if(Bt.transition=null,de=16>t?16:t,gr===null)var r=!1;else{if(t=gr,gr=null,Yu=0,le&6)throw Error(U(331));var s=le;for(le|=4,G=t.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(G=c;G!==null;){var d=G;switch(d.tag){case 0:case 11:case 15:Zo(8,d,i)}var m=d.child;if(m!==null)m.return=d,G=m;else for(;G!==null;){d=G;var g=d.sibling,I=d.return;if(gE(d),d===c){G=null;break}if(g!==null){g.return=I,G=g;break}G=I}}}var x=i.alternate;if(x!==null){var k=x.child;if(k!==null){x.child=null;do{var C=k.sibling;k.sibling=null,k=C}while(k!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zo(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,G=w;break e}G=i.return}}var _=t.current;for(G=_;G!==null;){o=G;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,G=E;else e:for(o=_;G!==null;){if(a=G,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lc(9,a)}}catch(L){Pe(a,a.return,L)}if(a===o){G=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,G=V;break e}G=a.return}}if(le=s,Br(),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(kc,t)}catch{}r=!0}return r}finally{de=n,Bt.transition=e}}return!1}function i_(t,e,n){e=Mi(n,e),e=iE(t,e,1),t=Ir(t,e,1),e=ft(),t!==null&&(Wa(t,1,e),Tt(t,e))}function Pe(t,e,n){if(t.tag===3)i_(t,t,n);else for(;e!==null;){if(e.tag===3){i_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Tr===null||!Tr.has(r))){t=Mi(n,t),t=oE(e,t,1),e=Ir(e,t,1),t=ft(),e!==null&&(Wa(e,1,t),Tt(e,t));break}}e=e.return}}function WA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ft(),t.pingedLanes|=t.suspendedLanes&n,Ke===t&&(Je&n)===n&&(Fe===4||Fe===3&&(Je&130023424)===Je&&500>Ce()-Bp?fs(t,0):zp|=n),Tt(t,e)}function AE(t,e){e===0&&(t.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var n=ft();t=Fn(t,e),t!==null&&(Wa(t,e,n),Tt(t,n))}function HA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),AE(t,n)}function GA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),AE(t,n)}var RE;RE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Et.current)vt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vt=!1,OA(t,e,n);vt=!!(t.flags&131072)}else vt=!1,Ee&&e.flags&1048576&&Nw(e,zu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;lu(t,e),t=e.pendingProps;var s=bi(e,lt.current);Si(e,n),s=Op(null,e,r,t,s,n);var i=Mp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,It(r)?(i=!0,Fu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Cp(e),s.updater=Mc,e.stateNode=s,s._reactInternals=e,lf(e,r,t,n),e=hf(null,e,r,!0,i,n)):(e.tag=0,Ee&&i&&Tp(e),ht(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(lu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=YA(r),t=Yt(r,t),s){case 0:e=cf(null,e,r,t,n);break e;case 1:e=Qy(null,e,r,t,n);break e;case 11:e=Hy(null,e,r,t,n);break e;case 14:e=Gy(null,e,r,Yt(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),cf(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),Qy(t,e,r,s,n);case 3:e:{if(cE(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Lw(t,e),qu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mi(Error(U(423)),e),e=Yy(t,e,r,n,s);break e}else if(r!==s){s=Mi(Error(U(424)),e),e=Yy(t,e,r,n,s);break e}else for(Pt=Er(e.stateNode.containerInfo.firstChild),Ct=e,Ee=!0,Zt=null,n=Ow(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Di(),r===s){e=Un(t,e,n);break e}ht(t,e,r,n)}e=e.child}return e;case 5:return jw(e),t===null&&sf(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Zd(r,s)?o=null:i!==null&&Zd(r,i)&&(e.flags|=32),uE(t,e),ht(t,e,o,n),e.child;case 6:return t===null&&sf(e),null;case 13:return hE(t,e,n);case 4:return Np(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Vi(e,null,r,n):ht(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),Hy(t,e,r,s,n);case 7:return ht(t,e,e.pendingProps,n),e.child;case 8:return ht(t,e,e.pendingProps.children,n),e.child;case 12:return ht(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ge(Bu,r._currentValue),r._currentValue=o,i!==null)if(sn(i.value,o)){if(i.children===s.children&&!Et.current){e=Un(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=On(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),of(i.return,n,e),a.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),of(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ht(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Si(e,n),s=Kt(s),r=r(s),e.flags|=1,ht(t,e,r,n),e.child;case 14:return r=e.type,s=Yt(r,e.pendingProps),s=Yt(r.type,s),Gy(t,e,r,s,n);case 15:return aE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yt(r,s),lu(t,e),e.tag=1,It(r)?(t=!0,Fu(e)):t=!1,Si(e,n),sE(e,r,s),lf(e,r,s,n),hf(null,e,r,!0,t,n);case 19:return dE(t,e,n);case 22:return lE(t,e,n)}throw Error(U(156,e.tag))};function PE(t,e){return tw(t,e)}function QA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ft(t,e,n,r){return new QA(t,e,n,r)}function Wp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function YA(t){if(typeof t=="function")return Wp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hp)return 11;if(t===dp)return 14}return 2}function Sr(t,e){var n=t.alternate;return n===null?(n=Ft(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function hu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Wp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ui:return ps(n.children,s,i,e);case cp:o=8,s|=8;break;case Nd:return t=Ft(12,n,e,s|2),t.elementType=Nd,t.lanes=i,t;case bd:return t=Ft(13,n,e,s),t.elementType=bd,t.lanes=i,t;case Dd:return t=Ft(19,n,e,s),t.elementType=Dd,t.lanes=i,t;case j0:return Fc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case M0:o=10;break e;case L0:o=9;break e;case hp:o=11;break e;case dp:o=14;break e;case or:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Ft(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ps(t,e,n,r){return t=Ft(7,t,r,e),t.lanes=n,t}function Fc(t,e,n,r){return t=Ft(22,t,r,e),t.elementType=j0,t.lanes=n,t.stateNode={isHidden:!1},t}function dd(t,e,n){return t=Ft(6,t,null,e),t.lanes=n,t}function fd(t,e,n){return e=Ft(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function XA(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hh(0),this.expirationTimes=Hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Hp(t,e,n,r,s,i,o,a,u){return t=new XA(t,e,n,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ft(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cp(i),t}function JA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:li,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function kE(t){if(!t)return br;t=t._reactInternals;e:{if(Fs(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(It(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(It(n))return kw(t,n,e)}return e}function CE(t,e,n,r,s,i,o,a,u){return t=Hp(n,r,!0,t,s,i,o,a,u),t.context=kE(null),n=t.current,r=ft(),s=xr(n),i=On(r,s),i.callback=e??null,Ir(n,i,s),t.current.lanes=s,Wa(t,s,r),Tt(t,r),t}function Uc(t,e,n,r){var s=e.current,i=ft(),o=xr(s);return n=kE(n),e.context===null?e.context=n:e.pendingContext=n,e=On(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ir(s,e,o),t!==null&&(rn(t,s,o,i),iu(t,s,o)),o}function Ju(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function o_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Gp(t,e){o_(t,e),(t=t.alternate)&&o_(t,e)}function ZA(){return null}var NE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qp(t){this._internalRoot=t}zc.prototype.render=Qp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Uc(t,e,null,null)};zc.prototype.unmount=Qp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xs(function(){Uc(null,t,null,null)}),e[jn]=null}};function zc(t){this._internalRoot=t}zc.prototype.unstable_scheduleHydration=function(t){if(t){var e=lw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<lr.length&&e!==0&&e<lr[n].priority;n++);lr.splice(n,0,t),n===0&&cw(t)}};function Yp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function a_(){}function eR(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Ju(o);i.call(c)}}var o=CE(e,r,t,0,null,!1,!1,"",a_);return t._reactRootContainer=o,t[jn]=o.current,wa(t.nodeType===8?t.parentNode:t),xs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Ju(u);a.call(c)}}var u=Hp(t,0,!1,null,null,!1,!1,"",a_);return t._reactRootContainer=u,t[jn]=u.current,wa(t.nodeType===8?t.parentNode:t),xs(function(){Uc(e,u,n,r)}),u}function $c(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=Ju(o);a.call(u)}}Uc(e,o,t,s)}else o=eR(n,e,t,s,r);return Ju(o)}ow=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Lo(e.pendingLanes);n!==0&&(mp(e,n|1),Tt(e,Ce()),!(le&6)&&(Li=Ce()+500,Br()))}break;case 13:xs(function(){var r=Fn(t,1);if(r!==null){var s=ft();rn(r,t,1,s)}}),Gp(t,1)}};gp=function(t){if(t.tag===13){var e=Fn(t,134217728);if(e!==null){var n=ft();rn(e,t,134217728,n)}Gp(t,134217728)}};aw=function(t){if(t.tag===13){var e=xr(t),n=Fn(t,e);if(n!==null){var r=ft();rn(n,t,e,r)}Gp(t,e)}};lw=function(){return de};uw=function(t,e){var n=de;try{return de=t,e()}finally{de=n}};$d=function(t,e,n){switch(e){case"input":if(Md(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Dc(r);if(!s)throw Error(U(90));U0(r),Md(r,s)}}}break;case"textarea":B0(t,n);break;case"select":e=n.value,e!=null&&Ei(t,!!n.multiple,e,!1)}};Q0=$p;Y0=xs;var tR={usingClientEntryPoint:!1,Events:[Ga,fi,Dc,H0,G0,$p]},ko={findFiberByHostInstance:us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nR={bundleType:ko.bundleType,version:ko.version,rendererPackageName:ko.rendererPackageName,rendererConfig:ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Z0(t),t===null?null:t.stateNode},findFiberByHostInstance:ko.findFiberByHostInstance||ZA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$l.isDisabled&&$l.supportsFiber)try{kc=$l.inject(nR),gn=$l}catch{}}Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tR;Dt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yp(e))throw Error(U(200));return JA(t,e,null,n)};Dt.createRoot=function(t,e){if(!Yp(t))throw Error(U(299));var n=!1,r="",s=NE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Hp(t,1,!1,null,null,n,!1,r,s),t[jn]=e.current,wa(t.nodeType===8?t.parentNode:t),new Qp(e)};Dt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=Z0(e),t=t===null?null:t.stateNode,t};Dt.flushSync=function(t){return xs(t)};Dt.hydrate=function(t,e,n){if(!Bc(e))throw Error(U(200));return $c(null,t,e,!0,n)};Dt.hydrateRoot=function(t,e,n){if(!Yp(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=NE;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=CE(e,null,t,1,n??null,s,!1,i,o),t[jn]=e.current,wa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new zc(e)};Dt.render=function(t,e,n){if(!Bc(e))throw Error(U(200));return $c(null,t,e,!1,n)};Dt.unmountComponentAtNode=function(t){if(!Bc(t))throw Error(U(40));return t._reactRootContainer?(xs(function(){$c(null,null,t,!1,function(){t._reactRootContainer=null,t[jn]=null})}),!0):!1};Dt.unstable_batchedUpdates=$p;Dt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Bc(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return $c(t,e,n,!1,r)};Dt.version="18.3.1-next-f1338f8080-20240426";function bE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bE)}catch(t){console.error(t)}}bE(),b0.exports=Dt;var rR=b0.exports,l_=rR;kd.createRoot=l_.createRoot,kd.hydrateRoot=l_.hydrateRoot;const sR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Ss=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),iR=({className:t="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),oR=({className:t="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),Ya=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),qc=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),aR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),u_=({className:t="w-5 h-5"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),lR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ka=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.125-1.274-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.125-1.274.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a4 4 0 11-8 0 4 4 0 018 0z"})}),DE=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),Kc=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),VE=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 4v16h14V8.5L14.5 4H5zM15 4v4H9V4h6zM12 18a2 2 0 100-4 2 2 0 000 4z"})}),uR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"})}),cR=({className:t="w-6 h-6"})=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),hR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),dR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),fR=({className:t="w-6 h-6"})=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),pR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),du=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),mR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),gR=({className:t="w-6 h-6"})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),yR=({onLogin:t,onSwitchToRegister:e,error:n,successMessage:r,rememberedCredentials:s})=>{const[i,o]=K.useState(""),[a,u]=K.useState(""),[c,d]=K.useState(""),[m,g]=K.useState(!1);K.useEffect(()=>{s&&(o(s.name||""),u(s.surname||""),d(s.password||""),g(!0))},[s]);const I=x=>{x.preventDefault(),i.trim()&&a.trim()&&c.trim()&&t(i.trim(),a.trim(),c.trim(),m)};return f.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 animate-fade-in",children:f.jsxs("div",{className:"w-full max-w-md glass-panel rounded-2xl p-8 transform transition-all hover:scale-[1.02] duration-300",children:[f.jsxs("div",{className:"flex flex-col items-center mb-8",children:[f.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-violet-500 p-4 rounded-2xl mb-4 shadow-lg shadow-indigo-500/30",children:f.jsx(aR,{className:"w-8 h-8 text-white"})}),f.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:"Area Personale"}),f.jsx("p",{className:"text-slate-400 mt-2 font-light",children:"Accedi per timbrare il tuo turno"})]}),f.jsxs("form",{onSubmit:I,className:"space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-slate-300 text-sm font-medium mb-2 ml-1",children:"Nome"}),f.jsx("input",{id:"name",type:"text",value:i,onChange:x=>o(x.target.value),placeholder:"es. Mario",className:"w-full px-4 py-3 glass-input rounded-xl placeholder-slate-500 focus:ring-2 focus:ring-indigo-500/50 transition-all",autoComplete:"given-name"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"surname",className:"block text-slate-300 text-sm font-medium mb-2 ml-1",children:"Cognome"}),f.jsx("input",{id:"surname",type:"text",value:a,onChange:x=>u(x.target.value),placeholder:"es. Rossi",className:"w-full px-4 py-3 glass-input rounded-xl placeholder-slate-500 focus:ring-2 focus:ring-indigo-500/50 transition-all",autoComplete:"family-name"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-slate-300 text-sm font-medium mb-2 ml-1",children:"Password"}),f.jsx("input",{id:"password",type:"password",value:c,onChange:x=>d(x.target.value),placeholder:"********",className:"w-full px-4 py-3 glass-input rounded-xl placeholder-slate-500 focus:ring-2 focus:ring-indigo-500/50 transition-all",autoComplete:"current-password"})]}),f.jsx("div",{className:"flex items-center justify-between pt-2",children:f.jsxs("label",{htmlFor:"rememberMe",className:"flex items-center text-sm text-slate-400 cursor-pointer hover:text-slate-300 transition-colors",children:[f.jsx("input",{type:"checkbox",id:"rememberMe",checked:m,onChange:x=>g(x.target.checked),className:"w-4 h-4 text-indigo-600 bg-slate-800 border-slate-600 rounded focus:ring-indigo-500"}),f.jsx("span",{className:"ml-2",children:"Ricorda dati di accesso"})]})}),r&&f.jsx("div",{className:"bg-emerald-500/10 border border-emerald-500/20 rounded-lg p-3 animate-fade-in",children:f.jsx("p",{className:"text-emerald-400 text-sm text-center font-medium",children:r})}),n&&f.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:f.jsx("p",{className:"text-red-400 text-sm text-center",children:n})}),f.jsxs("button",{type:"submit",disabled:!i.trim()||!a.trim()||!c.trim(),className:"w-full glass-button text-white font-bold py-3.5 px-4 rounded-xl focus:outline-none focus:shadow-outline disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-2",children:[f.jsx(iR,{}),"Accedi"]})]}),f.jsxs("p",{className:"text-center text-slate-400 text-sm mt-8",children:["Non hai un account?"," ",f.jsx("button",{type:"button",onClick:e,className:"font-semibold text-indigo-400 hover:text-indigo-300 transition-colors focus:outline-none",children:"Crea un profilo"})]})]})})},OE=(t,e)=>{if(!e)return"In corso...";const n=e.getTime()-t.getTime();if(n<0)return"N/A";const r=Math.floor(n/(1e3*60*60)),s=Math.floor(n%(1e3*60*60)/(1e3*60));return`${r.toString().padStart(2,"0")}h ${s.toString().padStart(2,"0")}m`},Dr=t=>t.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),ME=t=>t.toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric"}),c_=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),h_=t=>{if(!t)return"";const e=new Date(t),n=e.getTimezoneOffset()*6e4;return new Date(e.getTime()-n).toISOString().slice(0,16)},_R=({shift:t,onSave:e,onCancel:n})=>{const[r,s]=K.useState(h_(t.startTime)),[i,o]=K.useState(h_(t.endTime)),[a,u]=K.useState(t.type||"standard"),c=()=>{const d={...t,startTime:new Date(r).toISOString(),endTime:i?new Date(i).toISOString():null,type:a};e(d)};return f.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg border border-blue-500",children:[f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Inizio"}),f.jsx("input",{type:"datetime-local",value:r,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Fine"}),f.jsx("input",{type:"datetime-local",value:i,onChange:d=>o(d.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),f.jsxs("div",{className:"mb-4 pt-4 border-t border-gray-600",children:[f.jsx("p",{className:"text-sm font-medium text-gray-300 mb-2",children:"Tipo di Turno"}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[f.jsxs("label",{className:"flex items-center text-gray-200 cursor-pointer",children:[f.jsx("input",{type:"radio",checked:a==="standard",onChange:()=>u("standard"),className:"w-4 h-4 text-blue-500 bg-gray-600 border-gray-500 focus:ring-blue-600"}),f.jsx("span",{className:"ml-2",children:"Standard"})]}),f.jsxs("label",{className:"flex items-center text-gray-200 cursor-pointer",children:[f.jsx("input",{type:"radio",checked:a==="cassa",onChange:()=>u("cassa"),className:"w-4 h-4 text-blue-500 bg-gray-600 border-gray-500 focus:ring-blue-600"}),f.jsx("span",{className:"ml-2",children:"Cassa"})]}),f.jsxs("label",{className:"flex items-center text-gray-200 cursor-pointer",children:[f.jsx("input",{type:"radio",checked:a==="macchina_propria",onChange:()=>u("macchina_propria"),className:"w-4 h-4 text-blue-500 bg-gray-600 border-gray-500 focus:ring-blue-600"}),f.jsx("span",{className:"ml-2",children:"Macchina Propria"})]}),f.jsxs("label",{className:"flex items-center text-gray-200 cursor-pointer",children:[f.jsx("input",{type:"radio",checked:a==="macchina_pizzeria",onChange:()=>u("macchina_pizzeria"),className:"w-4 h-4 text-blue-500 bg-gray-600 border-gray-500 focus:ring-blue-600"}),f.jsx("span",{className:"ml-2",children:"Macchina Pizzeria"})]})]})]}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-semibold rounded-lg transition-colors",children:"Annulla"}),f.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:[f.jsx(VE,{className:"w-5 h-5"}),"Salva"]})]})]})},vR=({shift:t,onEdit:e,onDelete:n,isAdminView:r})=>{const s=new Date(t.startTime),i=t.endTime?new Date(t.endTime):null,o=C0.useMemo(()=>t.type&&{standard:"Standard",cassa:"Cassa",macchina_propria:"Macchina Propria",macchina_pizzeria:"Macchina Pizzeria"}[t.type]||null,[t.type]);return f.jsxs("div",{className:"bg-gray-700/50 p-4 rounded-lg",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 font-semibold text-lg",children:[f.jsx(Ss,{className:"w-5 h-5 text-blue-400"}),f.jsxs("span",{children:[Dr(s)," - ",i?Dr(i):"In corso"]})]}),f.jsx("span",{className:"ml-7 font-mono text-sm text-gray-400",children:OE(s,i)})]}),r&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-blue-400 transition-colors","aria-label":"Modifica turno",children:f.jsx(uR,{className:"w-5 h-5"})}),f.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-red-400 transition-colors","aria-label":"Elimina turno",children:f.jsx(Kc,{className:"w-5 h-5"})})]})]}),o&&f.jsx("div",{className:"pt-3 mt-3 border-t border-gray-600",children:f.jsx("span",{className:"text-xs bg-yellow-600/50 text-yellow-200 px-2 py-1 rounded-full",children:o})})]})},wR=({date:t,shifts:e,onClose:n,isAdminView:r=!1,onUpdateShift:s,onDeleteShift:i})=>{const[o,a]=K.useState(null),u=e.filter(d=>{const m=new Date(d.startTime);return m.getFullYear()===t.getFullYear()&&m.getMonth()===t.getMonth()&&m.getDate()===t.getDate()}).sort((d,m)=>new Date(d.startTime).getTime()-new Date(m.startTime).getTime()),c=d=>{s==null||s(d),a(null)};return f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",onClick:n,children:[f.jsxs("div",{className:"bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg p-6 relative transform transition-all animate-fade-in-up",onClick:d=>d.stopPropagation(),children:[f.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors",children:f.jsx(lR,{className:"w-8 h-8"})}),f.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Dettaglio Turni"}),f.jsx("p",{className:"text-blue-300 font-semibold mb-6",children:ME(t)}),f.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:u.length>0?u.map(d=>f.jsx("div",{children:o===d.id?f.jsx(_R,{shift:d,onSave:c,onCancel:()=>a(null)}):f.jsx(vR,{shift:d,isAdminView:r,onEdit:()=>a(d.id),onDelete:()=>{window.confirm("Sei sicuro di voler eliminare questo turno? Questa azione  irreversibile.")&&(i==null||i(d.id))}})},d.id)):f.jsx("p",{className:"text-gray-400",children:"Nessun turno completato per questo giorno."})})]}),f.jsx("style",{children:`
                @keyframes fade-in-up {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fade-in-up {
                    animation: fade-in-up 0.3s ease-out forwards;
                }
            `})]})},ER=["Lun","Mar","Mer","Gio","Ven","Sab","Dom"],LE=({shifts:t,isAdminView:e=!1,onUpdateShift:n,onDeleteShift:r})=>{const[s,i]=K.useState(new Date),[o,a]=K.useState(null),u=x=>{i(k=>{const C=new Date(k);return C.setDate(1),C.setMonth(C.getMonth()+x),C})},c=K.useMemo(()=>{const x=s.getFullYear(),k=s.getMonth(),C=new Date(x,k,1).getDay(),w=new Date(x,k+1,0).getDate(),_=C===0?6:C-1,E=Array(_).fill(null);for(let V=1;V<=w;V++)E.push(new Date(x,k,V));return E},[s]),d=K.useMemo(()=>{const x=new Map;return t.forEach(k=>{if(k.endTime){const C=new Date(k.startTime),w=new Date(k.endTime),_=`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}-${C.getDate().toString().padStart(2,"0")}`,E=w.getTime()-C.getTime(),L=(x.get(_)||{totalMs:0}).totalMs+E;x.set(_,{totalMs:L})}}),x},[t]),m=x=>{const k=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")}`;d.has(k)&&a(x)},g=x=>{if(x<=0)return"";const k=Math.floor(x/(1e3*60*60)),C=Math.floor(x%(1e3*60*60)/(1e3*60));return`${k}h ${C.toString().padStart(2,"0")}m`},I=K.useMemo(()=>{const x={total:0,standard:0,cassa:0,macchina_propria:0,macchina_pizzeria:0},k=s.getFullYear(),C=s.getMonth();return t.forEach(w=>{const _=new Date(w.startTime);if(w.endTime&&_.getFullYear()===k&&_.getMonth()===C){const E=new Date(w.endTime).getTime()-_.getTime();x.total+=E;const V=w.type||"standard";x[V]+=E}}),x},[t,s]);return f.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-lg h-full",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("button",{onClick:()=>u(-1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(Ya,{})}),f.jsx("h2",{className:"text-xl font-bold text-center capitalize",children:s.toLocaleString("it-IT",{month:"long",year:"numeric"})}),f.jsx("button",{onClick:()=>u(1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(qc,{})})]}),f.jsxs("div",{className:"mb-4 p-3 bg-slate-900/50 rounded-xl border border-slate-700/50",children:[f.jsxs("div",{className:"text-center mb-2",children:[f.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Ore Totali Mese"}),f.jsx("p",{className:"text-2xl font-bold text-indigo-300",children:g(I.total)})]}),I.total>0&&f.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700/50 space-y-1 text-sm",children:[I.standard>0&&f.jsxs("div",{className:"flex justify-between text-slate-300",children:[f.jsx("span",{children:"Standard:"}),f.jsx("span",{className:"font-mono",children:g(I.standard)})]}),I.cassa>0&&f.jsxs("div",{className:"flex justify-between text-slate-300",children:[f.jsx("span",{children:"Cassa:"}),f.jsx("span",{className:"font-mono",children:g(I.cassa)})]}),I.macchina_propria>0&&f.jsxs("div",{className:"flex justify-between text-slate-300",children:[f.jsx("span",{children:"Macchina Propria:"}),f.jsx("span",{className:"font-mono",children:g(I.macchina_propria)})]}),I.macchina_pizzeria>0&&f.jsxs("div",{className:"flex justify-between text-slate-300",children:[f.jsx("span",{children:"Macchina Pizzeria:"}),f.jsx("span",{className:"font-mono",children:g(I.macchina_pizzeria)})]})]})]}),f.jsx("div",{className:"grid grid-cols-7 gap-2 text-center text-sm text-gray-400 font-semibold mb-2",children:ER.map(x=>f.jsx("div",{children:x},x))}),f.jsx("div",{className:"grid grid-cols-7 gap-1 md:gap-2",children:c.map((x,k)=>{if(!x)return f.jsx("div",{},`empty-${k}`);const C=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")}`,w=d.get(C),_=!!w&&w.totalMs>0,E=new Date,V=x.getFullYear()===E.getFullYear()&&x.getMonth()===E.getMonth()&&x.getDate()===E.getDate();return f.jsxs("button",{onClick:()=>m(x),disabled:!_,className:`aspect-square flex flex-col items-center justify-center p-1 rounded-lg transition-colors text-center 
                                ${_?"bg-blue-900/50 cursor-pointer hover:bg-blue-900/80":""} 
                                ${V?"ring-2 ring-blue-500":""}
                                ${_?"":"cursor-default"}`,children:[f.jsx("span",{className:`text-sm md:text-base ${V?"font-extrabold text-white":"text-gray-300"}`,children:x.getDate()}),_&&f.jsx("span",{className:"text-xs md:text-sm font-bold text-blue-300 mt-1",children:g(w.totalMs)})]},x.toISOString())})}),o&&f.jsx(wR,{date:o,shifts:t,onClose:()=>a(null),isAdminView:e,onUpdateShift:n,onDeleteShift:r})]})},IR=({assignedShifts:t})=>{const[e,n]=K.useState(new Date),r=i=>{n(o=>{const a=new Date(o);return a.setDate(1),a.setMonth(a.getMonth()+i),a})},s=K.useMemo(()=>t.filter(i=>{const o=new Date(i.date);return o.getFullYear()===e.getFullYear()&&o.getMonth()===e.getMonth()}).sort((i,o)=>new Date(i.date).getTime()-new Date(o.date).getTime()),[t,e]);return f.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-lg",children:[f.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[f.jsx(DE,{className:"w-5 h-5"})," I Miei Turni"]}),f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("button",{onClick:()=>r(-1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(Ya,{className:"w-5 h-5"})}),f.jsx("h4",{className:"text-lg font-semibold text-center capitalize",children:e.toLocaleString("it-IT",{month:"long",year:"numeric"})}),f.jsx("button",{onClick:()=>r(1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(qc,{className:"w-5 h-5"})})]}),f.jsx("div",{className:"flex flex-col gap-3 max-h-60 overflow-y-auto pr-2",children:s.length>0?s.map(i=>{const o=new Date(i.date),a=new Date(o.getTime()+o.getTimezoneOffset()*6e4);return f.jsxs("div",{className:"flex justify-between items-center bg-gray-700/50 p-3 rounded-lg",children:[f.jsx("p",{className:"font-semibold",children:a.toLocaleDateString("it-IT",{weekday:"short",day:"2-digit",month:"short"})}),f.jsx("p",{className:"text-sm font-mono bg-blue-900/50 px-2 py-1 rounded",children:i.startTime})]},i.id)}):f.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nessun turno assegnato per questo mese."})})]})},d_=({shift:t})=>{const e=new Date(t.startTime),n=t.endTime?new Date(t.endTime):null,r=s=>s&&{standard:"Standard",cassa:"Cassa",macchina_propria:"Macchina Propria",macchina_pizzeria:"Macchina Pizzeria"}[s]||null;return f.jsxs("div",{className:"flex justify-between items-center bg-slate-800/50 border border-slate-700/50 p-3 rounded-xl hover:bg-slate-800/70 transition-colors",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg",children:f.jsx(Ss,{className:"w-5 h-5 text-indigo-400"})}),f.jsxs("div",{children:[f.jsxs("p",{className:"font-semibold text-slate-200",children:[Dr(e)," - ",n?Dr(n):"..."]}),t.type&&f.jsx("span",{className:"text-[10px] bg-yellow-500/10 border border-yellow-500/20 text-yellow-400 px-1.5 py-0.5 rounded-full font-medium mt-1 inline-block",children:r(t.type)})]})]}),f.jsx("p",{className:"text-sm font-mono bg-slate-900/50 px-2 py-1 rounded text-slate-400",children:OE(e,n)})]})},ql=({label:t,selected:e,onChange:n,disabled:r})=>f.jsxs("label",{className:`flex items-center p-3 rounded-xl transition-all border ${r?"cursor-not-allowed bg-slate-900/50 border-slate-800 text-slate-600":e?"bg-indigo-500/20 border-indigo-500/50 cursor-pointer":"bg-slate-800/30 border-slate-700/50 hover:bg-slate-800/50 cursor-pointer"}`,children:[f.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${e?"border-indigo-500":"border-slate-500"}`,children:e&&f.jsx("div",{className:"w-3 h-3 rounded-full bg-indigo-500"})}),f.jsx("input",{type:"radio",checked:e,onChange:n,disabled:r,className:"hidden"}),f.jsx("span",{className:`ml-3 font-medium ${e?"text-indigo-300":"text-slate-300"}`,children:t})]}),f_=({user:t,shifts:e,activeShift:n,assignedShifts:r,onClock:s})=>{const[i,o]=K.useState(null),a=g=>g&&{standard:"Standard",cassa:"Cassa",macchina_propria:"Macchina Propria",macchina_pizzeria:"Macchina Pizzeria"}[g]||null;K.useEffect(()=>{n||o(null)},[n]);const u=g=>{o(g)},c=()=>{n?s(n.type||"standard"):i&&s(i)},m=[...e.filter(g=>c_(new Date(g.startTime),new Date))].reverse();return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("header",{children:[f.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-2",children:["Bentornato, ",t.name]}),f.jsx("p",{className:"text-slate-400",children:"Ecco il riepilogo della tua attivit lavorativa."})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-8",children:[f.jsxs("div",{className:"glass-panel p-6 rounded-3xl relative overflow-hidden group",children:[f.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-3xl -mr-16 -mt-16 transition-all group-hover:bg-indigo-500/20"}),f.jsx("div",{className:"text-center mb-8 relative z-10",children:n?f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-slate-400 text-sm uppercase tracking-wider font-medium mb-2",children:"Turno in corso"}),f.jsx("p",{className:"text-4xl font-bold text-white tracking-tight",children:Dr(new Date(n.startTime))}),f.jsxs("div",{className:"mt-2 flex flex-col items-center gap-2",children:[f.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 text-xs font-bold border border-emerald-500/20 animate-pulse",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"ATTIVO"]}),n.type&&f.jsx("span",{className:"text-xs bg-yellow-500/10 border border-yellow-500/20 text-yellow-400 px-2 py-1 rounded-full font-medium",children:a(n.type)})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"text-slate-400 text-sm uppercase tracking-wider font-medium mb-2",children:"Stato attuale"}),f.jsx("p",{className:"text-3xl font-bold text-slate-500",children:"Non in servizio"})]})}),!n&&f.jsxs("div",{className:"my-6 space-y-3 relative z-10",children:[f.jsx("p",{className:"text-sm font-medium text-slate-400 mb-3",children:"Seleziona tipo di turno:"}),f.jsx(ql,{label:"Standard",value:"standard",selected:i==="standard",onChange:()=>u("standard"),disabled:!1}),f.jsx(ql,{label:"Cassa",value:"cassa",selected:i==="cassa",onChange:()=>u("cassa"),disabled:!1}),f.jsx(ql,{label:"Macchina Propria",value:"macchina_propria",selected:i==="macchina_propria",onChange:()=>u("macchina_propria"),disabled:!1}),f.jsx(ql,{label:"Macchina Pizzeria",value:"macchina_pizzeria",selected:i==="macchina_pizzeria",onChange:()=>u("macchina_pizzeria"),disabled:!1})]}),f.jsxs("button",{onClick:c,disabled:!n&&!i,className:`w-full flex items-center justify-center gap-3 text-lg font-bold py-4 px-6 rounded-xl transition-all duration-300 transform focus:outline-none focus:ring-4 ${!n&&!i?"bg-slate-700 text-slate-500 cursor-not-allowed":n?"bg-gradient-to-r from-red-500 to-pink-600 text-white shadow-red-500/30 focus:ring-red-400 hover:scale-[1.02] hover:shadow-lg":"bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-emerald-500/30 focus:ring-emerald-400 hover:scale-[1.02] hover:shadow-lg"}`,children:[f.jsx(Ss,{className:"w-7 h-7"}),n?"Timbra Uscita":"Timbra Entrata"]})]}),f.jsxs("div",{className:"glass-panel p-6 rounded-3xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h3",{className:"text-lg font-bold text-white",children:"Oggi"}),f.jsx("span",{className:"text-xs font-medium text-slate-400 bg-slate-800 px-2 py-1 rounded-lg",children:ME(new Date)})]}),f.jsxs("div",{className:"flex flex-col gap-3 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:[n&&c_(new Date(n.startTime),new Date)&&f.jsx(d_,{shift:n}),m.length>0?m.map(g=>f.jsx(d_,{shift:g},g.id)):!n&&f.jsx("p",{className:"text-slate-500 text-center py-4 text-sm",children:"Nessuna attivit registrata oggi."})]})]}),f.jsx("div",{className:"glass-panel p-6 rounded-3xl",children:f.jsx(IR,{assignedShifts:r})})]}),f.jsx("div",{className:"lg:col-span-2",children:f.jsx("div",{className:"glass-panel p-6 rounded-3xl h-full",children:f.jsx(LE,{shifts:e})})})]})]})},TR=({onRegister:t,onSwitchToLogin:e,error:n})=>{const[r,s]=K.useState(""),[i,o]=K.useState(""),[a,u]=K.useState(""),c=d=>{d.preventDefault(),r.trim()&&i.trim()&&a.trim()&&t(r.trim(),i.trim(),a.trim())};return f.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 animate-fade-in",children:f.jsxs("div",{className:"w-full max-w-md glass-panel rounded-2xl p-8 transform transition-all hover:scale-[1.02] duration-300",children:[f.jsxs("div",{className:"flex flex-col items-center mb-8",children:[f.jsx("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-500 p-4 rounded-2xl mb-4 shadow-lg shadow-emerald-500/30",children:f.jsx(u_,{className:"w-8 h-8 text-white"})}),f.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:"Crea Profilo"}),f.jsx("p",{className:"text-slate-400 mt-2 font-light",children:"Inserisci i tuoi dati per iniziare"})]}),f.jsxs("form",{onSubmit:c,className:"space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-slate-300 text-sm font-medium mb-2 ml-1",children:"Nome"}),f.jsx("input",{id:"name",type:"text",value:r,onChange:d=>s(d.target.value),placeholder:"es. Mario",className:"w-full px-4 py-3 glass-input rounded-xl placeholder-slate-500 focus:ring-2 focus:ring-emerald-500/50 transition-all",autoComplete:"given-name"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"surname",className:"block text-slate-300 text-sm font-medium mb-2 ml-1",children:"Cognome"}),f.jsx("input",{id:"surname",type:"text",value:i,onChange:d=>o(d.target.value),placeholder:"es. Rossi",className:"w-full px-4 py-3 glass-input rounded-xl placeholder-slate-500 focus:ring-2 focus:ring-emerald-500/50 transition-all",autoComplete:"family-name"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"reg-password",className:"block text-slate-300 text-sm font-medium mb-2 ml-1",children:"Password"}),f.jsx("input",{id:"reg-password",type:"password",value:a,onChange:d=>u(d.target.value),placeholder:"********",className:"w-full px-4 py-3 glass-input rounded-xl placeholder-slate-500 focus:ring-2 focus:ring-emerald-500/50 transition-all",autoComplete:"new-password"})]}),n&&f.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:f.jsx("p",{className:"text-red-400 text-sm text-center",children:n})}),f.jsxs("button",{type:"submit",disabled:!r.trim()||!i.trim()||!a.trim(),className:"w-full glass-button text-white font-bold py-3.5 px-4 rounded-xl focus:outline-none focus:shadow-outline disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-2",style:{background:"linear-gradient(135deg, var(--color-success), #059669)"},children:[f.jsx(u_,{}),"Crea Profilo"]})]}),f.jsxs("p",{className:"text-center text-slate-400 text-sm mt-8",children:["Hai gi un account?"," ",f.jsx("button",{type:"button",onClick:e,className:"font-semibold text-indigo-400 hover:text-indigo-300 transition-colors focus:outline-none",children:"Accedi"})]})]})})},xR=({isOpen:t,onClose:e,onConfirm:n,userName:r})=>t?f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",onClick:e,children:[f.jsxs("div",{className:"bg-gray-800 rounded-2xl shadow-xl w-full max-w-md p-6 relative transform transition-all animate-fade-in-up",onClick:s=>s.stopPropagation(),children:[f.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Conferma Eliminazione"}),f.jsxs("p",{className:"text-gray-300 mb-6",children:["Sei sicuro di voler eliminare l'utente ",f.jsx("span",{className:"font-bold text-yellow-400",children:r}),"? Questa azione  irreversibile e canceller tutti i dati associati."]}),f.jsxs("div",{className:"flex justify-end gap-4",children:[f.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-semibold rounded-lg transition-colors",children:"Annulla"}),f.jsx("button",{onClick:n,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition-colors",children:"Elimina Utente"})]})]}),f.jsx("style",{children:`
                @keyframes fade-in-up {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fade-in-up {
                    animation: fade-in-up 0.3s ease-out forwards;
                }
            `})]}):null,SR=({allUsers:t,onSelectUser:e,onDeleteUser:n})=>{const[r,s]=K.useState(null),[i,o]=K.useState(null),a=(c,d)=>{d.stopPropagation(),s(c)},u=()=>{r&&(n(r.id),s(null))};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("header",{children:[f.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Gestione Utenti"}),f.jsx("p",{className:"text-slate-400",children:"Visualizza e gestisci i dipendenti registrati."})]}),f.jsxs("div",{className:"glass-panel p-6 rounded-3xl shadow-lg",children:[f.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-white",children:[f.jsx(ka,{className:"text-indigo-400"})," Utenti Registrati"]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:t.length>0?t.map(c=>f.jsxs("div",{onClick:()=>e(c),className:"flex items-center justify-between bg-slate-800/40 border border-slate-700/50 p-4 rounded-2xl cursor-pointer hover:bg-slate-800/80 hover:border-indigo-500/30 transition-all group",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-slate-700 to-slate-800 flex items-center justify-center text-indigo-300 font-bold text-lg border border-slate-600",children:[c.name.charAt(0),c.surname.charAt(0)]}),f.jsxs("div",{children:[f.jsxs("span",{className:"font-bold text-slate-200 block",children:[c.name," ",c.surname,c.isAdmin&&f.jsx("span",{className:"ml-2 text-[10px] bg-indigo-500/20 text-indigo-300 px-2 py-0.5 rounded-full border border-indigo-500/30",children:"ADMIN"})]}),f.jsx("span",{className:"text-xs text-indigo-400 group-hover:text-indigo-300 transition-colors",children:"Visualizza Calendario"}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("span",{className:"text-xs text-slate-500",children:i===c.id?f.jsx("span",{className:"text-emerald-400 font-mono",children:c.password}):""}),f.jsx("button",{onClick:d=>{d.stopPropagation(),o(i===c.id?null:c.id)},className:"text-slate-500 hover:text-white transition-colors",title:i===c.id?"Nascondi password":"Mostra password",children:i===c.id?f.jsx(pR,{className:"w-3 h-3"}):f.jsx(fR,{className:"w-3 h-3"})})]})]})]}),f.jsx("button",{onClick:d=>a(c,d),className:"p-2 text-slate-500 hover:text-red-400 rounded-full hover:bg-red-500/10 transition-colors","aria-label":`Elimina ${c.name} ${c.surname}`,children:f.jsx(Kc,{className:"w-5 h-5"})})]},c.id)):f.jsxs("div",{className:"col-span-full py-12 text-center",children:[f.jsx("div",{className:"w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(ka,{className:"w-8 h-8 text-slate-600"})}),f.jsx("p",{className:"text-slate-500",children:"Nessun utente registrato."})]})})]}),r&&f.jsx(xR,{isOpen:!!r,onClose:()=>s(null),onConfirm:u,userName:`${r.name} ${r.surname}`})]})},AR=({selectedUser:t,userShifts:e,onBack:n,onUpdateShift:r,onDeleteShift:s})=>f.jsxs("div",{className:"min-h-screen bg-gray-900 p-4 sm:p-6 lg:p-8",children:[f.jsxs("header",{className:"mb-8",children:[f.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 font-semibold mb-4",children:[f.jsx(Ya,{className:"w-5 h-5"}),"Torna alla lista utenti"]}),f.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:["Dettaglio per ",t.name," ",t.surname]}),f.jsx("p",{className:"text-gray-400",children:"Visualizzazione del calendario timbrature."})]}),f.jsx("main",{children:f.jsx(LE,{shifts:e,isAdminView:!0,onUpdateShift:r,onDeleteShift:s})})]}),RR=()=>{};var p_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},PR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},FE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,d=i>>2,m=(i&3)<<4|a>>4;let g=(a&15)<<2|c>>6,I=c&63;u||(I=64,o||(g=64)),r.push(n[d],n[m],n[g],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):PR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||m==null)throw new kR;const g=i<<2|a>>4;if(r.push(g),c!==64){const I=a<<4&240|c>>2;if(r.push(I),m!==64){const x=c<<6&192|m;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class kR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CR=function(t){const e=jE(t);return FE.encodeByteArray(e,!0)},Zu=function(t){return CR(t).replace(/\./g,"")},UE=function(t){try{return FE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR=()=>zE().__FIREBASE_DEFAULTS__,bR=()=>{if(typeof process>"u"||typeof p_>"u")return;const t=p_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},DR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UE(t[1]);return e&&JSON.parse(e)},Wc=()=>{try{return RR()||NR()||bR()||DR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},BE=t=>{var e,n;return(n=(e=Wc())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},$E=t=>{const e=BE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},qE=()=>{var t;return(t=Wc())==null?void 0:t.config},KE=t=>{var e;return(e=Wc())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Xp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Zu(JSON.stringify(n)),Zu(JSON.stringify(o)),""].join(".")}const na={};function OR(){const t={prod:[],emulator:[]};for(const e of Object.keys(na))na[e]?t.emulator.push(e):t.prod.push(e);return t}function MR(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let m_=!1;function Jp(t,e){if(typeof window>"u"||typeof document>"u"||!Us(window.location.host)||na[t]===e||na[t]||m_)return;na[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=OR().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,I){g.setAttribute("width","24"),g.setAttribute("id",I),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function c(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{m_=!0,o()},g}function d(g,I){g.setAttribute("id",I),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=MR(r),I=n("text"),x=document.getElementById(I)||document.createElement("span"),k=n("learnmore"),C=document.getElementById(k)||document.createElement("a"),w=n("preprendIcon"),_=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const E=g.element;a(E),d(C,k);const V=c();u(_,w),E.append(_,x,C,V),document.body.appendChild(E)}i?(x.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function HE(){var e;const t=(e=Wc())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function FR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function UR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zR(){const t=Ue();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function GE(){return!HE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function QE(){return!HE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function YE(){try{return typeof indexedDB=="object"}catch{return!1}}function BR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="FirebaseError";class An extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=$R,Object.setPrototypeOf(this,An.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xa.prototype.create)}}class Xa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?qR(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new An(s,a,r)}}function qR(t,e){return t.replace(KR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const KR=/\{\$([^}]+)}/g;function WR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function As(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(g_(i)&&g_(o)){if(!As(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function g_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Fo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Uo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function HR(t,e){const n=new GR(t,e);return n.subscribe.bind(n)}class GR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");QR(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=pd),s.error===void 0&&(s.error=pd),s.complete===void 0&&(s.complete=pd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QR(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function pd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(t){return t&&t._delegate?t._delegate:t}class Vr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new VR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JR(e))try{this.getOrInitializeService({instanceIdentifier:ns})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ns){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ns){return this.instances.has(e)}getOptions(e=ns){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:XR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ns){return this.component?this.component.multipleInstances?e:ns:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XR(t){return t===ns?void 0:t}function JR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new YR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ie||(ie={}));const eP={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},tP=ie.INFO,nP={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},rP=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=nP[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zp{constructor(e){this.name=e,this._logLevel=tP,this._logHandler=rP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}}const sP=(t,e)=>e.some(n=>t instanceof n);let y_,__;function iP(){return y_||(y_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oP(){return __||(__=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const XE=new WeakMap,Tf=new WeakMap,JE=new WeakMap,md=new WeakMap,em=new WeakMap;function aP(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ar(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&XE.set(n,t)}).catch(()=>{}),em.set(e,t),e}function lP(t){if(Tf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Tf.set(t,e)}let xf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Tf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||JE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ar(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uP(t){xf=t(xf)}function cP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(gd(this),e,...n);return JE.set(r,e.sort?e.sort():[e]),Ar(r)}:oP().includes(t)?function(...e){return t.apply(gd(this),e),Ar(XE.get(this))}:function(...e){return Ar(t.apply(gd(this),e))}}function hP(t){return typeof t=="function"?cP(t):(t instanceof IDBTransaction&&lP(t),sP(t,iP())?new Proxy(t,xf):t)}function Ar(t){if(t instanceof IDBRequest)return aP(t);if(md.has(t))return md.get(t);const e=hP(t);return e!==t&&(md.set(t,e),em.set(e,t)),e}const gd=t=>em.get(t);function dP(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Ar(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Ar(o.result),u.oldVersion,u.newVersion,Ar(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const fP=["get","getKey","getAll","getAllKeys","count"],pP=["put","add","delete","clear"],yd=new Map;function v_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yd.get(e))return yd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=pP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||fP.includes(n)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&u.done]))[0]};return yd.set(e,i),i}uP(t=>({...t,get:(e,n,r)=>v_(e,n)||t.get(e,n,r),has:(e,n)=>!!v_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gP(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sf="@firebase/app",w_="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn=new Zp("@firebase/app"),yP="@firebase/app-compat",_P="@firebase/analytics-compat",vP="@firebase/analytics",wP="@firebase/app-check-compat",EP="@firebase/app-check",IP="@firebase/auth",TP="@firebase/auth-compat",xP="@firebase/database",SP="@firebase/data-connect",AP="@firebase/database-compat",RP="@firebase/functions",PP="@firebase/functions-compat",kP="@firebase/installations",CP="@firebase/installations-compat",NP="@firebase/messaging",bP="@firebase/messaging-compat",DP="@firebase/performance",VP="@firebase/performance-compat",OP="@firebase/remote-config",MP="@firebase/remote-config-compat",LP="@firebase/storage",jP="@firebase/storage-compat",FP="@firebase/firestore",UP="@firebase/ai",zP="@firebase/firestore-compat",BP="firebase",$P="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af="[DEFAULT]",qP={[Sf]:"fire-core",[yP]:"fire-core-compat",[vP]:"fire-analytics",[_P]:"fire-analytics-compat",[EP]:"fire-app-check",[wP]:"fire-app-check-compat",[IP]:"fire-auth",[TP]:"fire-auth-compat",[xP]:"fire-rtdb",[SP]:"fire-data-connect",[AP]:"fire-rtdb-compat",[RP]:"fire-fn",[PP]:"fire-fn-compat",[kP]:"fire-iid",[CP]:"fire-iid-compat",[NP]:"fire-fcm",[bP]:"fire-fcm-compat",[DP]:"fire-perf",[VP]:"fire-perf-compat",[OP]:"fire-rc",[MP]:"fire-rc-compat",[LP]:"fire-gcs",[jP]:"fire-gcs-compat",[FP]:"fire-fst",[zP]:"fire-fst-compat",[UP]:"fire-vertex","fire-js":"fire-js",[BP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=new Map,KP=new Map,Rf=new Map;function E_(t,e){try{t.container.addComponent(e)}catch(n){zn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Rs(t){const e=t.name;if(Rf.has(e))return zn.debug(`There were multiple attempts to register component ${e}.`),!1;Rf.set(e,t);for(const n of ec.values())E_(n,t);for(const n of KP.values())E_(n,t);return!0}function Hc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Rt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rr=new Xa("app","Firebase",WP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Vr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs=$P;function ZE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Af,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Rr.create("bad-app-name",{appName:String(s)});if(n||(n=qE()),!n)throw Rr.create("no-options");const i=ec.get(s);if(i){if(As(n,i.options)&&As(r,i.config))return i;throw Rr.create("duplicate-app",{appName:s})}const o=new ZR(s);for(const u of Rf.values())o.addComponent(u);const a=new HP(n,r,o);return ec.set(s,a),a}function tm(t=Af){const e=ec.get(t);if(!e&&t===Af&&qE())return ZE();if(!e)throw Rr.create("no-app",{appName:t});return e}function _n(t,e,n){let r=qP[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zn.warn(o.join(" "));return}Rs(new Vr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP="firebase-heartbeat-database",QP=1,Ca="firebase-heartbeat-store";let _d=null;function eI(){return _d||(_d=dP(GP,QP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ca)}catch(n){console.warn(n)}}}}).catch(t=>{throw Rr.create("idb-open",{originalErrorMessage:t.message})})),_d}async function YP(t){try{const n=(await eI()).transaction(Ca),r=await n.objectStore(Ca).get(tI(t));return await n.done,r}catch(e){if(e instanceof An)zn.warn(e.message);else{const n=Rr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zn.warn(n.message)}}}async function I_(t,e){try{const r=(await eI()).transaction(Ca,"readwrite");await r.objectStore(Ca).put(e,tI(t)),await r.done}catch(n){if(n instanceof An)zn.warn(n.message);else{const r=Rr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zn.warn(r.message)}}}function tI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=1024,JP=30;class ZP{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tk(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=T_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>JP){const o=nk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){zn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=T_(),{heartbeatsToSend:r,unsentEntries:s}=ek(this._heartbeatsCache.heartbeats),i=Zu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return zn.warn(n),""}}}function T_(){return new Date().toISOString().substring(0,10)}function ek(t,e=XP){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),x_(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),x_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YE()?BR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await YP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return I_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return I_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function x_(t){return Zu(JSON.stringify({version:2,heartbeats:t})).length}function nk(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(t){Rs(new Vr("platform-logger",e=>new mP(e),"PRIVATE")),Rs(new Vr("heartbeat",e=>new ZP(e),"PRIVATE")),_n(Sf,w_,t),_n(Sf,w_,"esm2020"),_n("fire-js","")}rk("");var sk="firebase",ik="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_n(sk,ik,"app");function nI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ok=nI,rI=new Xa("auth","Firebase",nI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=new Zp("@firebase/auth");function ak(t,...e){tc.logLevel<=ie.WARN&&tc.warn(`Auth (${zs}): ${t}`,...e)}function fu(t,...e){tc.logLevel<=ie.ERROR&&tc.error(`Auth (${zs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(t,...e){throw nm(t,...e)}function vn(t,...e){return nm(t,...e)}function sI(t,e,n){const r={...ok(),[e]:n};return new Xa("auth","Firebase",r).create(e,{appName:t.name})}function Mn(t){return sI(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return rI.create(t,...e)}function Z(t,e,...n){if(!t)throw nm(e,...n)}function bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw fu(e),new Error(e)}function Bn(t,e){t||bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function lk(){return S_()==="http:"||S_()==="https:"}function S_(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lk()||FR()||"connection"in navigator)?navigator.onLine:!0}function ck(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,n){this.shortDelay=e,this.longDelay=n,Bn(n>e,"Short delay should be less than long delay!"),this.isMobile=LR()||UR()}get(){return uk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(t,e){Bn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fk=new Za(3e4,6e4);function $r(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Wn(t,e,n,r,s={}){return oI(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Ja({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:u,...i};return jR()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Us(t.emulatorConfig.host)&&(c.credentials="include"),iI.fetch()(await aI(t,t.config.apiHost,n,a),c)})}async function oI(t,e,n){t._canInitEmulator=!1;const r={...hk,...e};try{const s=new mk(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Kl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[u,c]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Kl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Kl(t,"user-disabled",o);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw sI(t,d,c);on(t,d)}}catch(s){if(s instanceof An)throw s;on(t,"network-request-failed",{message:String(s)})}}async function el(t,e,n,r,s={}){const i=await Wn(t,e,n,r,s);return"mfaPendingCredential"in i&&on(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function aI(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?rm(t.config,s):`${t.config.apiScheme}://${s}`;return dk.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function pk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class mk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(vn(this.auth,"network-request-failed")),fk.get())})}}function Kl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=vn(t,e,r);return s.customData._tokenResponse=n,s}function A_(t){return t!==void 0&&t.enterprise!==void 0}class gk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return pk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function yk(t,e){return Wn(t,"GET","/v2/recaptchaConfig",$r(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _k(t,e){return Wn(t,"POST","/v1/accounts:delete",e)}async function nc(t,e){return Wn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vk(t,e=!1){const n=We(t),r=await n.getIdToken(e),s=sm(r);Z(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ra(vd(s.auth_time)),issuedAtTime:ra(vd(s.iat)),expirationTime:ra(vd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function vd(t){return Number(t)*1e3}function sm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return fu("JWT malformed, contained fewer than 3 sections"),null;try{const s=UE(n);return s?JSON.parse(s):(fu("Failed to decode base64 JWT payload"),null)}catch(s){return fu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function R_(t){const e=sm(t);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ji(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof An&&wk(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function wk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ra(this.lastLoginAt),this.creationTime=ra(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rc(t){var m;const e=t.auth,n=await t.getIdToken(),r=await ji(t,nc(e,{idToken:n}));Z(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?lI(s.providerUserInfo):[],o=Tk(t.providerData,i),a=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new kf(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,d)}async function Ik(t){const e=We(t);await rc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Tk(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function lI(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xk(t,e){const n=await oI(t,{},async()=>{const r=Ja({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await aI(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:r};return t.emulatorConfig&&Us(t.emulatorConfig.host)&&(u.credentials="include"),iI.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Sk(t,e){return Wn(t,"POST","/v2/accounts:revokeToken",$r(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):R_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Z(e.length!==0,"internal-error");const n=R_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await xk(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ri;return r&&(Z(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Z(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Z(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ri,this.toJSON())}_performRefresh(){return bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(t,e){Z(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class en{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Ek(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new kf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ji(this,this.stsTokenManager.getToken(this.auth,e));return Z(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return vk(this,e)}reload(){return Ik(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new en({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await rc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rt(this.auth.app))return Promise.reject(Mn(this.auth));const e=await this.getIdToken();return await ji(this,_k(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,u=n._redirectEventId??void 0,c=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:I,providerData:x,stsTokenManager:k}=n;Z(m&&k,e,"internal-error");const C=Ri.fromJSON(this.name,k);Z(typeof m=="string",e,"internal-error"),nr(r,e.name),nr(s,e.name),Z(typeof g=="boolean",e,"internal-error"),Z(typeof I=="boolean",e,"internal-error"),nr(i,e.name),nr(o,e.name),nr(a,e.name),nr(u,e.name),nr(c,e.name),nr(d,e.name);const w=new en({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:I,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:C,createdAt:c,lastLoginAt:d});return x&&Array.isArray(x)&&(w.providerData=x.map(_=>({..._}))),u&&(w._redirectEventId=u),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ri;s.updateFromServerResponse(n);const i=new en({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await rc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Z(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?lI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Ri;a.updateFromIdToken(r);const u=new en({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new kf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_=new Map;function Dn(t){Bn(t instanceof Function,"Expected a class definition");let e=P_.get(t);return e?(Bn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,P_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}uI.type="NONE";const k_=uI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(t,e,n){return`firebase:${t}:${e}:${n}`}class Pi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=pu(this.userKey,s.apiKey,i),this.fullPersistenceKey=pu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await nc(this.auth,{idToken:e}).catch(()=>{});return n?en._fromGetAccountInfoResponse(this.auth,n,e):null}return en._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Pi(Dn(k_),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Dn(k_);const o=pu(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){let m;if(typeof d=="string"){const g=await nc(e,{idToken:d}).catch(()=>{});if(!g)break;m=await en._fromGetAccountInfoResponse(e,g,d)}else m=en._fromJSON(e,d);c!==i&&(a=m),i=c;break}}catch{}const u=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Pi(i,e,r):(i=u[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Pi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mI(e))return"Blackberry";if(gI(e))return"Webos";if(hI(e))return"Safari";if((e.includes("chrome/")||dI(e))&&!e.includes("edge/"))return"Chrome";if(pI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function cI(t=Ue()){return/firefox\//i.test(t)}function hI(t=Ue()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dI(t=Ue()){return/crios\//i.test(t)}function fI(t=Ue()){return/iemobile/i.test(t)}function pI(t=Ue()){return/android/i.test(t)}function mI(t=Ue()){return/blackberry/i.test(t)}function gI(t=Ue()){return/webos/i.test(t)}function im(t=Ue()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ak(t=Ue()){var e;return im(t)&&!!((e=window.navigator)!=null&&e.standalone)}function Rk(){return zR()&&document.documentMode===10}function yI(t=Ue()){return im(t)||pI(t)||gI(t)||mI(t)||/windows phone/i.test(t)||fI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(t,e=[]){let n;switch(t){case"Browser":n=C_(Ue());break;case"Worker":n=`${C_(Ue())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${zs}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const u=e(i);o(u)}catch(u){a(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kk(t,e={}){return Wn(t,"GET","/v2/passwordPolicy",$r(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck=6;class Nk{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Ck,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new N_(this),this.idTokenSubscription=new N_(this),this.beforeStateQueue=new Pk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=rI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Dn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Pi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await nc(this,{idToken:e}),r=await en._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Rt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await rc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ck()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rt(this.app))return Promise.reject(Mn(this));const n=e?We(e):null;return n&&Z(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rt(this.app)?Promise.reject(Mn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rt(this.app)?Promise.reject(Mn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Dn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kk(this),n=new Nk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Xa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Sk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Dn(e)||this._popupRedirectResolver;Z(n,this,"argument-error"),this.redirectPersistenceManager=await Pi.create(this,[Dn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_I(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Rt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&ak(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Bs(t){return We(t)}class N_{constructor(e){this.auth=e,this.observer=null,this.addObserver=HR(n=>this.observer=n)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Dk(t){Gc=t}function vI(t){return Gc.loadJS(t)}function Vk(){return Gc.recaptchaEnterpriseScript}function Ok(){return Gc.gapiScript}function Mk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Lk{constructor(){this.enterprise=new jk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class jk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Fk="recaptcha-enterprise",wI="NO_RECAPTCHA";class Uk{constructor(e){this.type=Fk,this.auth=Bs(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{yk(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new gk(u);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(u=>{a(u)})})}function s(i,o,a){const u=window.grecaptcha;A_(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(wI)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Lk().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&A_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=Vk();u.length!==0&&(u+=a),vI(u).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function b_(t,e,n,r=!1,s=!1){const i=new Uk(t);let o;if(s)o=wI;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const u=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const u=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Cf(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await b_(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await b_(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(t,e){const n=Hc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(As(i,e??{}))return s;on(s,"already-initialized")}return n.initialize({options:e})}function Bk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Dn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function $k(t,e,n){const r=Bs(t);Z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=EI(e),{host:o,port:a}=qk(e),u=a===null?"":`:${a}`,c={url:`${i}//${o}${u}/`},d=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Z(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Z(As(c,r.config.emulator)&&As(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Us(o)?(Xp(`${i}//${o}${u}`),Jp("Auth",!0)):Kk()}function EI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qk(t){const e=EI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:D_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:D_(o)}}}function D_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Kk(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return bn("not implemented")}_getIdTokenResponse(e){return bn("not implemented")}_linkToIdToken(e,n){return bn("not implemented")}_getReauthenticationResolver(e){return bn("not implemented")}}async function Wk(t,e){return Wn(t,"POST","/v1/accounts:update",e)}async function Hk(t,e){return Wn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gk(t,e){return el(t,"POST","/v1/accounts:signInWithPassword",$r(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qk(t,e){return el(t,"POST","/v1/accounts:signInWithEmailLink",$r(t,e))}async function Yk(t,e){return el(t,"POST","/v1/accounts:signInWithEmailLink",$r(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends om{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Na(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Na(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cf(e,n,"signInWithPassword",Gk);case"emailLink":return Qk(e,{email:this._email,oobCode:this._password});default:on(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Cf(e,r,"signUpPassword",Hk);case"emailLink":return Yk(e,{idToken:n,email:this._email,oobCode:this._password});default:on(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ki(t,e){return el(t,"POST","/v1/accounts:signInWithIdp",$r(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk="http://localhost";class Ps extends om{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ps(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):on("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ps(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ki(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ki(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ki(e,n)}buildRequest(){const e={requestUri:Xk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ja(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Zk(t){const e=Fo(Uo(t)).link,n=e?Fo(Uo(e)).deep_link_id:null,r=Fo(Uo(t)).deep_link_id;return(r?Fo(Uo(r)).link:null)||r||n||e||t}class am{constructor(e){const n=Fo(Uo(e)),r=n.apiKey??null,s=n.oobCode??null,i=Jk(n.mode??null);Z(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Zk(e);try{return new am(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.providerId=to.PROVIDER_ID}static credential(e,n){return Na._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=am.parseLink(n);return Z(r,"argument-error"),Na._fromEmailAndCode(e,r.code,r.tenantId)}}to.PROVIDER_ID="password";to.EMAIL_PASSWORD_SIGN_IN_METHOD="password";to.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl extends II{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr extends tl{constructor(){super("facebook.com")}static credential(e){return Ps._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cr.credentialFromTaggedObject(e)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cr.credential(e.oauthAccessToken)}catch{return null}}}cr.FACEBOOK_SIGN_IN_METHOD="facebook.com";cr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends tl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ps._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return hr.credential(n,r)}catch{return null}}}hr.GOOGLE_SIGN_IN_METHOD="google.com";hr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr extends tl{constructor(){super("github.com")}static credential(e){return Ps._fromParams({providerId:dr.PROVIDER_ID,signInMethod:dr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dr.credentialFromTaggedObject(e)}static credentialFromError(e){return dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dr.credential(e.oauthAccessToken)}catch{return null}}}dr.GITHUB_SIGN_IN_METHOD="github.com";dr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends tl{constructor(){super("twitter.com")}static credential(e,n){return Ps._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return fr.credentialFromTaggedObject(e)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return fr.credential(n,r)}catch{return null}}}fr.TWITTER_SIGN_IN_METHOD="twitter.com";fr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eC(t,e){return el(t,"POST","/v1/accounts:signUp",$r(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await en._fromIdTokenResponse(e,r,s),o=V_(r);return new ks({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=V_(r);return new ks({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function V_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc extends An{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,sc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new sc(e,n,r,s)}}function TI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?sc._fromErrorAndOperation(t,i,e,r):i})}async function tC(t,e,n=!1){const r=await ji(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ks._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nC(t,e,n=!1){const{auth:r}=t;if(Rt(r.app))return Promise.reject(Mn(r));const s="reauthenticate";try{const i=await ji(t,TI(r,s,e,t),n);Z(i.idToken,r,"internal-error");const o=sm(i.idToken);Z(o,r,"internal-error");const{sub:a}=o;return Z(t.uid===a,r,"user-mismatch"),ks._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&on(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xI(t,e,n=!1){if(Rt(t.app))return Promise.reject(Mn(t));const r="signIn",s=await TI(t,r,e),i=await ks._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function rC(t,e){return xI(Bs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(t){const e=Bs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sC(t,e,n){if(Rt(t.app))return Promise.reject(Mn(t));const r=Bs(t),o=await Cf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eC).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&SI(t),u}),a=await ks._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function iC(t,e,n){return Rt(t.app)?Promise.reject(Mn(t)):rC(We(t),to.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&SI(t),r})}function oC(t,e){return aC(We(t),null,e)}async function aC(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await ji(t,Wk(r,i));await t._updateTokensIfNecessary(o,!0)}function lC(t,e,n,r){return We(t).onIdTokenChanged(e,n,r)}function uC(t,e,n){return We(t).beforeAuthStateChanged(e,n)}function cC(t,e,n,r){return We(t).onAuthStateChanged(e,n,r)}function hC(t){return We(t).signOut()}const ic="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ic,"1"),this.storage.removeItem(ic),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=1e3,fC=10;class RI extends AI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Rk()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}RI.type="LOCAL";const pC=RI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI extends AI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}PI.type="SESSION";const kI=PI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Qc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(n.origin,i)),u=await mC(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,u)=>{const c=lm("",20);s.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===c)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(d),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(){return window}function yC(t){wn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(){return typeof wn().WorkerGlobalScope<"u"&&typeof wn().importScripts=="function"}async function _C(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function wC(){return CI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="firebaseLocalStorageDb",EC=1,oc="firebaseLocalStorage",bI="fbase_key";class nl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Yc(t,e){return t.transaction([oc],e?"readwrite":"readonly").objectStore(oc)}function IC(){const t=indexedDB.deleteDatabase(NI);return new nl(t).toPromise()}function Nf(){const t=indexedDB.open(NI,EC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(oc,{keyPath:bI})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(oc)?e(r):(r.close(),await IC(),e(await Nf()))})})}async function O_(t,e,n){const r=Yc(t,!0).put({[bI]:e,value:n});return new nl(r).toPromise()}async function TC(t,e){const n=Yc(t,!1).get(e),r=await new nl(n).toPromise();return r===void 0?null:r.value}function M_(t,e){const n=Yc(t,!0).delete(e);return new nl(n).toPromise()}const xC=800,SC=3;class DI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Nf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>SC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return CI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qc._getInstance(wC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await _C(),!this.activeServiceWorker)return;this.sender=new gC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Nf();return await O_(e,ic,"1"),await M_(e,ic),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>O_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>TC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>M_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Yc(s,!1).getAll();return new nl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}DI.type="LOCAL";const AC=DI;new Za(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(t,e){return e?Dn(e):(Z(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um extends om{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ki(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ki(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function PC(t){return xI(t.auth,new um(t),t.bypassAuthState)}function kC(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),nC(n,new um(t),t.bypassAuthState)}async function CC(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),tC(n,new um(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return PC;case"linkViaPopup":case"linkViaRedirect":return CC;case"reauthViaPopup":case"reauthViaRedirect":return kC;default:on(this.auth,"internal-error")}}resolve(e){Bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC=new Za(2e3,1e4);class wi extends VI{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,wi.currentPopupAction&&wi.currentPopupAction.cancel(),wi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Z(e,this.auth,"internal-error"),e}async onExecution(){Bn(this.filter.length===1,"Popup operations only handle one event");const e=lm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(vn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(vn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NC.get())};e()}}wi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="pendingRedirect",mu=new Map;class DC extends VI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=mu.get(this.auth._key());if(!e){try{const r=await VC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}mu.set(this.auth._key(),e)}return this.bypassAuthState||mu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VC(t,e){const n=LC(e),r=MC(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function OC(t,e){mu.set(t._key(),e)}function MC(t){return Dn(t._redirectPersistence)}function LC(t){return pu(bC,t.config.apiKey,t.name)}async function jC(t,e,n=!1){if(Rt(t.app))return Promise.reject(Mn(t));const r=Bs(t),s=RC(r,e),o=await new DC(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=10*60*1e3;class UC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!OI(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(vn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FC&&this.cachedEventUids.clear(),this.cachedEventUids.has(L_(e))}saveEventToCache(e){this.cachedEventUids.add(L_(e)),this.lastProcessedEventTime=Date.now()}}function L_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function OI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function zC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return OI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(t,e={}){return Wn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qC=/^https?/;async function KC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await BC(t);for(const n of e)try{if(WC(n))return}catch{}on(t,"unauthorized-domain")}function WC(t){const e=Pf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!qC.test(n))return!1;if($C.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=new Za(3e4,6e4);function j_(){const t=wn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function GC(t){return new Promise((e,n)=>{var s,i,o;function r(){j_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{j_(),n(vn(t,"network-request-failed"))},timeout:HC.get()})}if((i=(s=wn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=wn().gapi)!=null&&o.load)r();else{const a=Mk("iframefcb");return wn()[a]=()=>{gapi.load?r():n(vn(t,"network-request-failed"))},vI(`${Ok()}?onload=${a}`).catch(u=>n(u))}}).catch(e=>{throw gu=null,e})}let gu=null;function QC(t){return gu=gu||GC(t),gu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new Za(5e3,15e3),XC="__/auth/iframe",JC="emulator/auth/iframe",ZC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},e2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function t2(t){const e=t.config;Z(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?rm(e,JC):`https://${t.config.authDomain}/${XC}`,r={apiKey:e.apiKey,appName:t.name,v:zs},s=e2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ja(r).slice(1)}`}async function n2(t){const e=await QC(t),n=wn().gapi;return Z(n,t,"internal-error"),e.open({where:document.body,url:t2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZC,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=vn(t,"network-request-failed"),a=wn().setTimeout(()=>{i(o)},YC.get());function u(){wn().clearTimeout(a),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},s2=500,i2=600,o2="_blank",a2="http://localhost";class F_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function l2(t,e,n,r=s2,s=i2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u={...r2,width:r.toString(),height:s.toString(),top:i,left:o},c=Ue().toLowerCase();n&&(a=dI(c)?o2:n),cI(c)&&(e=e||a2,u.scrollbars="yes");const d=Object.entries(u).reduce((g,[I,x])=>`${g}${I}=${x},`,"");if(Ak(c)&&a!=="_self")return u2(e||"",a),new F_(null);const m=window.open(e||"",a,d);Z(m,t,"popup-blocked");try{m.focus()}catch{}return new F_(m)}function u2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="__/auth/handler",h2="emulator/auth/handler",d2=encodeURIComponent("fac");async function U_(t,e,n,r,s,i){Z(t.config.authDomain,t,"auth-domain-config-required"),Z(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:zs,eventId:s};if(e instanceof II){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",WR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))o[d]=m}if(e instanceof tl){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await t._getAppCheckToken(),c=u?`#${d2}=${encodeURIComponent(u)}`:"";return`${f2(t)}?${Ja(a).slice(1)}${c}`}function f2({config:t}){return t.emulator?rm(t,h2):`https://${t.authDomain}/${c2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd="webStorageSupport";class p2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kI,this._completeRedirectFn=jC,this._overrideRedirectResult=OC}async _openPopup(e,n,r,s){var o;Bn((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await U_(e,n,r,Pf(),s);return l2(e,i,lm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await U_(e,n,r,Pf(),s);return yC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Bn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await n2(e),r=new UC(e);return n.register("authEvent",s=>(Z(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(wd,{type:wd},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[wd];i!==void 0&&n(!!i),on(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=KC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return yI()||hI()||im()}}const m2=p2;var z_="@firebase/auth",B_="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _2(t){Rs(new Vr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Z(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_I(t)},c=new bk(r,s,i,u);return Bk(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Rs(new Vr("auth-internal",e=>{const n=Bs(e.getProvider("auth").getImmediate());return(r=>new g2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),_n(z_,B_,y2(t)),_n(z_,B_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=5*60,w2=KE("authIdTokenMaxAge")||v2;let $_=null;const E2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>w2)return;const s=n==null?void 0:n.token;$_!==s&&($_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function I2(t=tm()){const e=Hc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=zk(t,{popupRedirectResolver:m2,persistence:[AC,pC,kI]}),r=KE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=E2(i.toString());uC(n,o,()=>o(n.currentUser)),lC(n,a=>o(a))}}const s=BE("auth");return s&&$k(n,`http://${s}`),n}function T2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Dk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=vn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",T2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_2("Browser");var q_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pr,MI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,v){function S(){}S.prototype=v.prototype,T.F=v.prototype,T.prototype=new S,T.prototype.constructor=T,T.D=function(R,P,b){for(var A=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)A[Me-2]=arguments[Me];return v.prototype[P].apply(R,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,v,S){S||(S=0);const R=Array(16);if(typeof v=="string")for(var P=0;P<16;++P)R[P]=v.charCodeAt(S++)|v.charCodeAt(S++)<<8|v.charCodeAt(S++)<<16|v.charCodeAt(S++)<<24;else for(P=0;P<16;++P)R[P]=v[S++]|v[S++]<<8|v[S++]<<16|v[S++]<<24;v=T.g[0],S=T.g[1],P=T.g[2];let b=T.g[3],A;A=v+(b^S&(P^b))+R[0]+3614090360&4294967295,v=S+(A<<7&4294967295|A>>>25),A=b+(P^v&(S^P))+R[1]+3905402710&4294967295,b=v+(A<<12&4294967295|A>>>20),A=P+(S^b&(v^S))+R[2]+606105819&4294967295,P=b+(A<<17&4294967295|A>>>15),A=S+(v^P&(b^v))+R[3]+3250441966&4294967295,S=P+(A<<22&4294967295|A>>>10),A=v+(b^S&(P^b))+R[4]+4118548399&4294967295,v=S+(A<<7&4294967295|A>>>25),A=b+(P^v&(S^P))+R[5]+1200080426&4294967295,b=v+(A<<12&4294967295|A>>>20),A=P+(S^b&(v^S))+R[6]+2821735955&4294967295,P=b+(A<<17&4294967295|A>>>15),A=S+(v^P&(b^v))+R[7]+4249261313&4294967295,S=P+(A<<22&4294967295|A>>>10),A=v+(b^S&(P^b))+R[8]+1770035416&4294967295,v=S+(A<<7&4294967295|A>>>25),A=b+(P^v&(S^P))+R[9]+2336552879&4294967295,b=v+(A<<12&4294967295|A>>>20),A=P+(S^b&(v^S))+R[10]+4294925233&4294967295,P=b+(A<<17&4294967295|A>>>15),A=S+(v^P&(b^v))+R[11]+2304563134&4294967295,S=P+(A<<22&4294967295|A>>>10),A=v+(b^S&(P^b))+R[12]+1804603682&4294967295,v=S+(A<<7&4294967295|A>>>25),A=b+(P^v&(S^P))+R[13]+4254626195&4294967295,b=v+(A<<12&4294967295|A>>>20),A=P+(S^b&(v^S))+R[14]+2792965006&4294967295,P=b+(A<<17&4294967295|A>>>15),A=S+(v^P&(b^v))+R[15]+1236535329&4294967295,S=P+(A<<22&4294967295|A>>>10),A=v+(P^b&(S^P))+R[1]+4129170786&4294967295,v=S+(A<<5&4294967295|A>>>27),A=b+(S^P&(v^S))+R[6]+3225465664&4294967295,b=v+(A<<9&4294967295|A>>>23),A=P+(v^S&(b^v))+R[11]+643717713&4294967295,P=b+(A<<14&4294967295|A>>>18),A=S+(b^v&(P^b))+R[0]+3921069994&4294967295,S=P+(A<<20&4294967295|A>>>12),A=v+(P^b&(S^P))+R[5]+3593408605&4294967295,v=S+(A<<5&4294967295|A>>>27),A=b+(S^P&(v^S))+R[10]+38016083&4294967295,b=v+(A<<9&4294967295|A>>>23),A=P+(v^S&(b^v))+R[15]+3634488961&4294967295,P=b+(A<<14&4294967295|A>>>18),A=S+(b^v&(P^b))+R[4]+3889429448&4294967295,S=P+(A<<20&4294967295|A>>>12),A=v+(P^b&(S^P))+R[9]+568446438&4294967295,v=S+(A<<5&4294967295|A>>>27),A=b+(S^P&(v^S))+R[14]+3275163606&4294967295,b=v+(A<<9&4294967295|A>>>23),A=P+(v^S&(b^v))+R[3]+4107603335&4294967295,P=b+(A<<14&4294967295|A>>>18),A=S+(b^v&(P^b))+R[8]+1163531501&4294967295,S=P+(A<<20&4294967295|A>>>12),A=v+(P^b&(S^P))+R[13]+2850285829&4294967295,v=S+(A<<5&4294967295|A>>>27),A=b+(S^P&(v^S))+R[2]+4243563512&4294967295,b=v+(A<<9&4294967295|A>>>23),A=P+(v^S&(b^v))+R[7]+1735328473&4294967295,P=b+(A<<14&4294967295|A>>>18),A=S+(b^v&(P^b))+R[12]+2368359562&4294967295,S=P+(A<<20&4294967295|A>>>12),A=v+(S^P^b)+R[5]+4294588738&4294967295,v=S+(A<<4&4294967295|A>>>28),A=b+(v^S^P)+R[8]+2272392833&4294967295,b=v+(A<<11&4294967295|A>>>21),A=P+(b^v^S)+R[11]+1839030562&4294967295,P=b+(A<<16&4294967295|A>>>16),A=S+(P^b^v)+R[14]+4259657740&4294967295,S=P+(A<<23&4294967295|A>>>9),A=v+(S^P^b)+R[1]+2763975236&4294967295,v=S+(A<<4&4294967295|A>>>28),A=b+(v^S^P)+R[4]+1272893353&4294967295,b=v+(A<<11&4294967295|A>>>21),A=P+(b^v^S)+R[7]+4139469664&4294967295,P=b+(A<<16&4294967295|A>>>16),A=S+(P^b^v)+R[10]+3200236656&4294967295,S=P+(A<<23&4294967295|A>>>9),A=v+(S^P^b)+R[13]+681279174&4294967295,v=S+(A<<4&4294967295|A>>>28),A=b+(v^S^P)+R[0]+3936430074&4294967295,b=v+(A<<11&4294967295|A>>>21),A=P+(b^v^S)+R[3]+3572445317&4294967295,P=b+(A<<16&4294967295|A>>>16),A=S+(P^b^v)+R[6]+76029189&4294967295,S=P+(A<<23&4294967295|A>>>9),A=v+(S^P^b)+R[9]+3654602809&4294967295,v=S+(A<<4&4294967295|A>>>28),A=b+(v^S^P)+R[12]+3873151461&4294967295,b=v+(A<<11&4294967295|A>>>21),A=P+(b^v^S)+R[15]+530742520&4294967295,P=b+(A<<16&4294967295|A>>>16),A=S+(P^b^v)+R[2]+3299628645&4294967295,S=P+(A<<23&4294967295|A>>>9),A=v+(P^(S|~b))+R[0]+4096336452&4294967295,v=S+(A<<6&4294967295|A>>>26),A=b+(S^(v|~P))+R[7]+1126891415&4294967295,b=v+(A<<10&4294967295|A>>>22),A=P+(v^(b|~S))+R[14]+2878612391&4294967295,P=b+(A<<15&4294967295|A>>>17),A=S+(b^(P|~v))+R[5]+4237533241&4294967295,S=P+(A<<21&4294967295|A>>>11),A=v+(P^(S|~b))+R[12]+1700485571&4294967295,v=S+(A<<6&4294967295|A>>>26),A=b+(S^(v|~P))+R[3]+2399980690&4294967295,b=v+(A<<10&4294967295|A>>>22),A=P+(v^(b|~S))+R[10]+4293915773&4294967295,P=b+(A<<15&4294967295|A>>>17),A=S+(b^(P|~v))+R[1]+2240044497&4294967295,S=P+(A<<21&4294967295|A>>>11),A=v+(P^(S|~b))+R[8]+1873313359&4294967295,v=S+(A<<6&4294967295|A>>>26),A=b+(S^(v|~P))+R[15]+4264355552&4294967295,b=v+(A<<10&4294967295|A>>>22),A=P+(v^(b|~S))+R[6]+2734768916&4294967295,P=b+(A<<15&4294967295|A>>>17),A=S+(b^(P|~v))+R[13]+1309151649&4294967295,S=P+(A<<21&4294967295|A>>>11),A=v+(P^(S|~b))+R[4]+4149444226&4294967295,v=S+(A<<6&4294967295|A>>>26),A=b+(S^(v|~P))+R[11]+3174756917&4294967295,b=v+(A<<10&4294967295|A>>>22),A=P+(v^(b|~S))+R[2]+718787259&4294967295,P=b+(A<<15&4294967295|A>>>17),A=S+(b^(P|~v))+R[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(P+(A<<21&4294967295|A>>>11))&4294967295,T.g[2]=T.g[2]+P&4294967295,T.g[3]=T.g[3]+b&4294967295}r.prototype.v=function(T,v){v===void 0&&(v=T.length);const S=v-this.blockSize,R=this.C;let P=this.h,b=0;for(;b<v;){if(P==0)for(;b<=S;)s(this,T,b),b+=this.blockSize;if(typeof T=="string"){for(;b<v;)if(R[P++]=T.charCodeAt(b++),P==this.blockSize){s(this,R),P=0;break}}else for(;b<v;)if(R[P++]=T[b++],P==this.blockSize){s(this,R),P=0;break}}this.h=P,this.o+=v},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;v=this.o*8;for(var S=T.length-8;S<T.length;++S)T[S]=v&255,v/=256;for(this.v(T),T=Array(16),v=0,S=0;S<4;++S)for(let R=0;R<32;R+=8)T[v++]=this.g[S]>>>R&255;return T};function i(T,v){var S=a;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=v(T)}function o(T,v){this.h=v;const S=[];let R=!0;for(let P=T.length-1;P>=0;P--){const b=T[P]|0;R&&b==v||(S[P]=b,R=!1)}this.g=S}var a={};function u(T){return-128<=T&&T<128?i(T,function(v){return new o([v|0],v<0?-1:0)}):new o([T|0],T<0?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return m;if(T<0)return C(c(-T));const v=[];let S=1;for(let R=0;T>=S;R++)v[R]=T/S|0,S*=4294967296;return new o(v,0)}function d(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return C(d(T.substring(1),v));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=c(Math.pow(v,8));let R=m;for(let b=0;b<T.length;b+=8){var P=Math.min(8,T.length-b);const A=parseInt(T.substring(b,b+P),v);P<8?(P=c(Math.pow(v,P)),R=R.j(P).add(c(A))):(R=R.j(S),R=R.add(c(A)))}return R}var m=u(0),g=u(1),I=u(16777216);t=o.prototype,t.m=function(){if(k(this))return-C(this).m();let T=0,v=1;for(let S=0;S<this.g.length;S++){const R=this.i(S);T+=(R>=0?R:4294967296+R)*v,v*=4294967296}return T},t.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(x(this))return"0";if(k(this))return"-"+C(this).toString(T);const v=c(Math.pow(T,6));var S=this;let R="";for(;;){const P=V(S,v).g;S=w(S,P.j(v));let b=((S.g.length>0?S.g[0]:S.h)>>>0).toString(T);if(S=P,x(S))return b+R;for(;b.length<6;)b="0"+b;R=b+R}},t.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function x(T){if(T.h!=0)return!1;for(let v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function k(T){return T.h==-1}t.l=function(T){return T=w(this,T),k(T)?-1:x(T)?0:1};function C(T){const v=T.g.length,S=[];for(let R=0;R<v;R++)S[R]=~T.g[R];return new o(S,~T.h).add(g)}t.abs=function(){return k(this)?C(this):this},t.add=function(T){const v=Math.max(this.g.length,T.g.length),S=[];let R=0;for(let P=0;P<=v;P++){let b=R+(this.i(P)&65535)+(T.i(P)&65535),A=(b>>>16)+(this.i(P)>>>16)+(T.i(P)>>>16);R=A>>>16,b&=65535,A&=65535,S[P]=A<<16|b}return new o(S,S[S.length-1]&-2147483648?-1:0)};function w(T,v){return T.add(C(v))}t.j=function(T){if(x(this)||x(T))return m;if(k(this))return k(T)?C(this).j(C(T)):C(C(this).j(T));if(k(T))return C(this.j(C(T)));if(this.l(I)<0&&T.l(I)<0)return c(this.m()*T.m());const v=this.g.length+T.g.length,S=[];for(var R=0;R<2*v;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(let P=0;P<T.g.length;P++){const b=this.i(R)>>>16,A=this.i(R)&65535,Me=T.i(P)>>>16,Ht=T.i(P)&65535;S[2*R+2*P]+=A*Ht,_(S,2*R+2*P),S[2*R+2*P+1]+=b*Ht,_(S,2*R+2*P+1),S[2*R+2*P+1]+=A*Me,_(S,2*R+2*P+1),S[2*R+2*P+2]+=b*Me,_(S,2*R+2*P+2)}for(T=0;T<v;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=v;T<2*v;T++)S[T]=0;return new o(S,0)};function _(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function E(T,v){this.g=T,this.h=v}function V(T,v){if(x(v))throw Error("division by zero");if(x(T))return new E(m,m);if(k(T))return v=V(C(T),v),new E(C(v.g),C(v.h));if(k(v))return v=V(T,C(v)),new E(C(v.g),v.h);if(T.g.length>30){if(k(T)||k(v))throw Error("slowDivide_ only works with positive integers.");for(var S=g,R=v;R.l(T)<=0;)S=L(S),R=L(R);var P=j(S,1),b=j(R,1);for(R=j(R,2),S=j(S,2);!x(R);){var A=b.add(R);A.l(T)<=0&&(P=P.add(S),b=A),R=j(R,1),S=j(S,1)}return v=w(T,P.j(v)),new E(P,v)}for(P=m;T.l(v)>=0;){for(S=Math.max(1,Math.floor(T.m()/v.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),b=c(S),A=b.j(v);k(A)||A.l(T)>0;)S-=R,b=c(S),A=b.j(v);x(b)&&(b=g),P=P.add(b),T=w(T,A)}return new E(P,T)}t.B=function(T){return V(this,T).h},t.and=function(T){const v=Math.max(this.g.length,T.g.length),S=[];for(let R=0;R<v;R++)S[R]=this.i(R)&T.i(R);return new o(S,this.h&T.h)},t.or=function(T){const v=Math.max(this.g.length,T.g.length),S=[];for(let R=0;R<v;R++)S[R]=this.i(R)|T.i(R);return new o(S,this.h|T.h)},t.xor=function(T){const v=Math.max(this.g.length,T.g.length),S=[];for(let R=0;R<v;R++)S[R]=this.i(R)^T.i(R);return new o(S,this.h^T.h)};function L(T){const v=T.g.length+1,S=[];for(let R=0;R<v;R++)S[R]=T.i(R)<<1|T.i(R-1)>>>31;return new o(S,T.h)}function j(T,v){const S=v>>5;v%=32;const R=T.g.length-S,P=[];for(let b=0;b<R;b++)P[b]=v>0?T.i(b+S)>>>v|T.i(b+S+1)<<32-v:T.i(b+S);return new o(P,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,MI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Pr=o}).apply(typeof q_<"u"?q_:typeof self<"u"?self:typeof window<"u"?window:{});var Wl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var LI,zo,jI,yu,bf,FI,UI,zI;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wl=="object"&&Wl];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var D=l[y];if(!(D in p))break e;p=p[D]}l=l[l.length-1],y=p[l],h=h(y),h!=y&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(h){var p=[],y;for(y in h)Object.prototype.hasOwnProperty.call(h,y)&&p.push([y,h[y]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function u(l,h,p){return l.call.apply(l.bind,arguments)}function c(l,h,p){return c=u,c.apply(null,arguments)}function d(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function m(l,h){function p(){}p.prototype=h.prototype,l.Z=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(y,D,O){for(var z=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)z[ne-2]=arguments[ne];return h.prototype[D].apply(y,z)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function I(l){const h=l.length;if(h>0){const p=Array(h);for(let y=0;y<h;y++)p[y]=l[y];return p}return[]}function x(l,h){for(let y=1;y<arguments.length;y++){const D=arguments[y];var p=typeof D;if(p=p!="object"?p:D?Array.isArray(D)?"array":p:"null",p=="array"||p=="object"&&typeof D.length=="number"){p=l.length||0;const O=D.length||0;l.length=p+O;for(let z=0;z<O;z++)l[p+z]=D[z]}else l.push(D)}}class k{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function C(l){o.setTimeout(()=>{throw l},0)}function w(){var l=T;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class _{constructor(){this.h=this.g=null}add(h,p){const y=E.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var E=new k(()=>new V,l=>l.reset());class V{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let L,j=!1,T=new _,v=()=>{const l=Promise.resolve(void 0);L=()=>{l.then(S)}};function S(){for(var l;l=w();){try{l.h.call(l.g)}catch(p){C(p)}var h=E;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}j=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var b=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,h),o.removeEventListener("test",p,h)}catch{}return l}();function A(l){return/^[\s\xa0]*$/.test(l)}function Me(l,h){P.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}m(Me,P),Me.prototype.init=function(l,h){const p=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Me.Z.h.call(this)},Me.prototype.h=function(){Me.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Ht="closure_listenable_"+(Math.random()*1e6|0),Wr=0;function Hr(l,h,p,y,D){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=D,this.key=++Wr,this.da=this.fa=!1}function W(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function $(l,h,p){for(const y in l)h.call(p,l[y],y,l)}function H(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function J(l){const h={};for(const p in l)h[p]=l[p];return h}const pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function He(l,h){let p,y;for(let D=1;D<arguments.length;D++){y=arguments[D];for(p in y)l[p]=y[p];for(let O=0;O<pe.length;O++)p=pe[O],Object.prototype.hasOwnProperty.call(y,p)&&(l[p]=y[p])}}function Ge(l){this.src=l,this.g={},this.h=0}Ge.prototype.add=function(l,h,p,y,D){const O=l.toString();l=this.g[O],l||(l=this.g[O]=[],this.h++);const z=Gt(l,h,y,D);return z>-1?(h=l[z],p||(h.fa=!1)):(h=new Hr(h,this.src,O,!!y,D),h.fa=p,l.push(h)),h};function Ot(l,h){const p=h.type;if(p in l.g){var y=l.g[p],D=Array.prototype.indexOf.call(y,h,void 0),O;(O=D>=0)&&Array.prototype.splice.call(y,D,1),O&&(W(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Gt(l,h,p,y){for(let D=0;D<l.length;++D){const O=l[D];if(!O.da&&O.listener==h&&O.capture==!!p&&O.ha==y)return D}return-1}var Gn="closure_lm_"+(Math.random()*1e6|0),Eh={};function ng(l,h,p,y,D){if(Array.isArray(h)){for(let O=0;O<h.length;O++)ng(l,h[O],p,y,D);return null}return p=ig(p),l&&l[Ht]?l.J(h,p,a(y)?!!y.capture:!1,D):n1(l,h,p,!1,y,D)}function n1(l,h,p,y,D,O){if(!h)throw Error("Invalid event type");const z=a(D)?!!D.capture:!!D;let ne=Th(l);if(ne||(l[Gn]=ne=new Ge(l)),p=ne.add(h,p,y,z,O),p.proxy)return p;if(y=r1(),p.proxy=y,y.src=l,y.listener=p,l.addEventListener)b||(D=z),D===void 0&&(D=!1),l.addEventListener(h.toString(),y,D);else if(l.attachEvent)l.attachEvent(sg(h.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function r1(){function l(p){return h.call(l.src,l.listener,p)}const h=s1;return l}function rg(l,h,p,y,D){if(Array.isArray(h))for(var O=0;O<h.length;O++)rg(l,h[O],p,y,D);else y=a(y)?!!y.capture:!!y,p=ig(p),l&&l[Ht]?(l=l.i,O=String(h).toString(),O in l.g&&(h=l.g[O],p=Gt(h,p,y,D),p>-1&&(W(h[p]),Array.prototype.splice.call(h,p,1),h.length==0&&(delete l.g[O],l.h--)))):l&&(l=Th(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Gt(h,p,y,D)),(p=l>-1?h[l]:null)&&Ih(p))}function Ih(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Ht])Ot(h.i,l);else{var p=l.type,y=l.proxy;h.removeEventListener?h.removeEventListener(p,y,l.capture):h.detachEvent?h.detachEvent(sg(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=Th(h))?(Ot(p,l),p.h==0&&(p.src=null,h[Gn]=null)):W(l)}}}function sg(l){return l in Eh?Eh[l]:Eh[l]="on"+l}function s1(l,h){if(l.da)l=!0;else{h=new Me(h,this);const p=l.listener,y=l.ha||l.src;l.fa&&Ih(l),l=p.call(y,h)}return l}function Th(l){return l=l[Gn],l instanceof Ge?l:null}var xh="__closure_events_fn_"+(Math.random()*1e9>>>0);function ig(l){return typeof l=="function"?l:(l[xh]||(l[xh]=function(h){return l.handleEvent(h)}),l[xh])}function tt(){R.call(this),this.i=new Ge(this),this.M=this,this.G=null}m(tt,R),tt.prototype[Ht]=!0,tt.prototype.removeEventListener=function(l,h,p,y){rg(this,l,h,p,y)};function ut(l,h){var p,y=l.G;if(y)for(p=[];y;y=y.G)p.push(y);if(l=l.M,y=h.type||h,typeof h=="string")h=new P(h,l);else if(h instanceof P)h.target=h.target||l;else{var D=h;h=new P(y,l),He(h,D)}D=!0;let O,z;if(p)for(z=p.length-1;z>=0;z--)O=h.g=p[z],D=ml(O,y,!0,h)&&D;if(O=h.g=l,D=ml(O,y,!0,h)&&D,D=ml(O,y,!1,h)&&D,p)for(z=0;z<p.length;z++)O=h.g=p[z],D=ml(O,y,!1,h)&&D}tt.prototype.N=function(){if(tt.Z.N.call(this),this.i){var l=this.i;for(const h in l.g){const p=l.g[h];for(let y=0;y<p.length;y++)W(p[y]);delete l.g[h],l.h--}}this.G=null},tt.prototype.J=function(l,h,p,y){return this.i.add(String(l),h,!1,p,y)},tt.prototype.K=function(l,h,p,y){return this.i.add(String(l),h,!0,p,y)};function ml(l,h,p,y){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let D=!0;for(let O=0;O<h.length;++O){const z=h[O];if(z&&!z.da&&z.capture==p){const ne=z.listener,Le=z.ha||z.src;z.fa&&Ot(l.i,z),D=ne.call(Le,y)!==!1&&D}}return D&&!y.defaultPrevented}function i1(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=c(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(l,h||0)}function og(l){l.g=i1(()=>{l.g=null,l.i&&(l.i=!1,og(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class o1 extends R{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:og(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function io(l){R.call(this),this.h=l,this.g={}}m(io,R);var ag=[];function lg(l){$(l.g,function(h,p){this.g.hasOwnProperty(p)&&Ih(h)},l),l.g={}}io.prototype.N=function(){io.Z.N.call(this),lg(this)},io.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Sh=o.JSON.stringify,a1=o.JSON.parse,l1=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function ug(){}function cg(){}var oo={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ah(){P.call(this,"d")}m(Ah,P);function Rh(){P.call(this,"c")}m(Rh,P);var Gr={},hg=null;function gl(){return hg=hg||new tt}Gr.Ia="serverreachability";function dg(l){P.call(this,Gr.Ia,l)}m(dg,P);function ao(l){const h=gl();ut(h,new dg(h))}Gr.STAT_EVENT="statevent";function fg(l,h){P.call(this,Gr.STAT_EVENT,l),this.stat=h}m(fg,P);function ct(l){const h=gl();ut(h,new fg(h,l))}Gr.Ja="timingevent";function pg(l,h){P.call(this,Gr.Ja,l),this.size=h}m(pg,P);function lo(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},h)}function uo(){this.g=!0}uo.prototype.ua=function(){this.g=!1};function u1(l,h,p,y,D,O){l.info(function(){if(l.g)if(O){var z="",ne=O.split("&");for(let me=0;me<ne.length;me++){var Le=ne[me].split("=");if(Le.length>1){const Be=Le[0];Le=Le[1];const un=Be.split("_");z=un.length>=2&&un[1]=="type"?z+(Be+"="+Le+"&"):z+(Be+"=redacted&")}}}else z=null;else z=O;return"XMLHTTP REQ ("+y+") [attempt "+D+"]: "+h+`
`+p+`
`+z})}function c1(l,h,p,y,D,O,z){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+D+"]: "+h+`
`+p+`
`+O+" "+z})}function Hs(l,h,p,y){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+d1(l,p)+(y?" "+y:"")})}function h1(l,h){l.info(function(){return"TIMEOUT: "+h})}uo.prototype.info=function(){};function d1(l,h){if(!l.g)return h;if(!h)return null;try{const O=JSON.parse(h);if(O){for(l=0;l<O.length;l++)if(Array.isArray(O[l])){var p=O[l];if(!(p.length<2)){var y=p[1];if(Array.isArray(y)&&!(y.length<1)){var D=y[0];if(D!="noop"&&D!="stop"&&D!="close")for(let z=1;z<y.length;z++)y[z]=""}}}}return Sh(O)}catch{return h}}var yl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},mg={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},gg;function Ph(){}m(Ph,ug),Ph.prototype.g=function(){return new XMLHttpRequest},gg=new Ph;function co(l){return encodeURIComponent(String(l))}function f1(l){var h=1;l=l.split(":");const p=[];for(;h>0&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function Qn(l,h,p,y){this.j=l,this.i=h,this.l=p,this.S=y||1,this.V=new io(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yg}function yg(){this.i=null,this.g="",this.h=!1}var _g={},kh={};function Ch(l,h,p){l.M=1,l.A=vl(ln(h)),l.u=p,l.R=!0,vg(l,null)}function vg(l,h){l.F=Date.now(),_l(l),l.B=ln(l.A);var p=l.B,y=l.S;Array.isArray(y)||(y=[String(y)]),bg(p.i,"t",y),l.C=0,p=l.j.L,l.h=new yg,l.g=Yg(l.j,p?h:null,!l.u),l.P>0&&(l.O=new o1(c(l.Y,l,l.g),l.P)),h=l.V,p=l.g,y=l.ba;var D="readystatechange";Array.isArray(D)||(D&&(ag[0]=D.toString()),D=ag);for(let O=0;O<D.length;O++){const z=ng(p,D[O],y||h.handleEvent,!1,h.h||h);if(!z)break;h.g[z.key]=z}h=l.J?J(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),ao(),u1(l.i,l.v,l.B,l.l,l.S,l.u)}Qn.prototype.ba=function(l){l=l.target;const h=this.O;h&&Jn(l)==3?h.j():this.Y(l)},Qn.prototype.Y=function(l){try{if(l==this.g)e:{const ne=Jn(this.g),Le=this.g.ya(),me=this.g.ca();if(!(ne<3)&&(ne!=3||this.g&&(this.h.h||this.g.la()||Fg(this.g)))){this.K||ne!=4||Le==7||(Le==8||me<=0?ao(3):ao(2)),Nh(this);var h=this.g.ca();this.X=h;var p=p1(this);if(this.o=h==200,c1(this.i,this.v,this.B,this.l,this.S,ne,h),this.o){if(this.U&&!this.L){t:{if(this.g){var y,D=this.g;if((y=D.g?D.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(y)){var O=y;break t}}O=null}if(l=O)Hs(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bh(this,l);else{this.o=!1,this.m=3,ct(12),Qr(this),ho(this);break e}}if(this.R){l=!0;let Be;for(;!this.K&&this.C<p.length;)if(Be=m1(this,p),Be==kh){ne==4&&(this.m=4,ct(14),l=!1),Hs(this.i,this.l,null,"[Incomplete Response]");break}else if(Be==_g){this.m=4,ct(15),Hs(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else Hs(this.i,this.l,Be,null),bh(this,Be);if(wg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ne!=4||p.length!=0||this.h.h||(this.m=1,ct(16),l=!1),this.o=this.o&&l,!l)Hs(this.i,this.l,p,"[Invalid Chunked Response]"),Qr(this),ho(this);else if(p.length>0&&!this.W){this.W=!0;var z=this.j;z.g==this&&z.aa&&!z.P&&(z.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Uh(z),z.P=!0,ct(11))}}else Hs(this.i,this.l,p,null),bh(this,p);ne==4&&Qr(this),this.o&&!this.K&&(ne==4?Wg(this.j,this):(this.o=!1,_l(this)))}else k1(this.g),h==400&&p.indexOf("Unknown SID")>0?(this.m=3,ct(12)):(this.m=0,ct(13)),Qr(this),ho(this)}}}catch{}finally{}};function p1(l){if(!wg(l))return l.g.la();const h=Fg(l.g);if(h==="")return"";let p="";const y=h.length,D=Jn(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Qr(l),ho(l),"";l.h.i=new o.TextDecoder}for(let O=0;O<y;O++)l.h.h=!0,p+=l.h.i.decode(h[O],{stream:!(D&&O==y-1)});return h.length=0,l.h.g+=p,l.C=0,l.h.g}function wg(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function m1(l,h){var p=l.C,y=h.indexOf(`
`,p);return y==-1?kh:(p=Number(h.substring(p,y)),isNaN(p)?_g:(y+=1,y+p>h.length?kh:(h=h.slice(y,y+p),l.C=y+p,h)))}Qn.prototype.cancel=function(){this.K=!0,Qr(this)};function _l(l){l.T=Date.now()+l.H,Eg(l,l.H)}function Eg(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=lo(c(l.aa,l),h)}function Nh(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Qn.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(h1(this.i,this.B),this.M!=2&&(ao(),ct(17)),Qr(this),this.m=2,ho(this)):Eg(this,this.T-l)};function ho(l){l.j.I==0||l.K||Wg(l.j,l)}function Qr(l){Nh(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,lg(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function bh(l,h){try{var p=l.j;if(p.I!=0&&(p.g==l||Dh(p.h,l))){if(!l.L&&Dh(p.h,l)&&p.I==3){try{var y=p.Ba.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var D=y;if(D[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)xl(p),Il(p);else break e;Fh(p),ct(18)}}else p.xa=D[1],0<p.xa-p.K&&D[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=lo(c(p.Va,p),6e3));xg(p.h)<=1&&p.ta&&(p.ta=void 0)}else Xr(p,11)}else if((l.L||p.g==l)&&xl(p),!A(h))for(D=p.Ba.g.parse(h),h=0;h<D.length;h++){let me=D[h];const Be=me[0];if(!(Be<=p.K))if(p.K=Be,me=me[1],p.I==2)if(me[0]=="c"){p.M=me[1],p.ba=me[2];const un=me[3];un!=null&&(p.ka=un,p.j.info("VER="+p.ka));const Jr=me[4];Jr!=null&&(p.za=Jr,p.j.info("SVER="+p.za));const Zn=me[5];Zn!=null&&typeof Zn=="number"&&Zn>0&&(y=1.5*Zn,p.O=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const er=l.g;if(er){const Al=er.g?er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Al){var O=y.h;O.g||Al.indexOf("spdy")==-1&&Al.indexOf("quic")==-1&&Al.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Vh(O,O.h),O.h=null))}if(y.G){const zh=er.g?er.g.getResponseHeader("X-HTTP-Session-Id"):null;zh&&(y.wa=zh,ye(y.J,y.G,zh))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),y=p;var z=l;if(y.na=Qg(y,y.L?y.ba:null,y.W),z.L){Sg(y.h,z);var ne=z,Le=y.O;Le&&(ne.H=Le),ne.D&&(Nh(ne),_l(ne)),y.g=z}else qg(y);p.i.length>0&&Tl(p)}else me[0]!="stop"&&me[0]!="close"||Xr(p,7);else p.I==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Xr(p,7):jh(p):me[0]!="noop"&&p.l&&p.l.qa(me),p.A=0)}}ao(4)}catch{}}var g1=class{constructor(l,h){this.g=l,this.map=h}};function Ig(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Tg(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function xg(l){return l.h?1:l.g?l.g.size:0}function Dh(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Vh(l,h){l.g?l.g.add(h):l.h=h}function Sg(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Ig.prototype.cancel=function(){if(this.i=Ag(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ag(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.G);return h}return I(l.i)}var Rg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function y1(l,h){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const y=l[p].indexOf("=");let D,O=null;y>=0?(D=l[p].substring(0,y),O=l[p].substring(y+1)):D=l[p],h(D,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Yn(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof Yn?(this.l=l.l,fo(this,l.j),this.o=l.o,this.g=l.g,po(this,l.u),this.h=l.h,Oh(this,Dg(l.i)),this.m=l.m):l&&(h=String(l).match(Rg))?(this.l=!1,fo(this,h[1]||"",!0),this.o=mo(h[2]||""),this.g=mo(h[3]||"",!0),po(this,h[4]),this.h=mo(h[5]||"",!0),Oh(this,h[6]||"",!0),this.m=mo(h[7]||"")):(this.l=!1,this.i=new yo(null,this.l))}Yn.prototype.toString=function(){const l=[];var h=this.j;h&&l.push(go(h,Pg,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(go(h,Pg,!0),"@"),l.push(co(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(go(p,p.charAt(0)=="/"?w1:v1,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",go(p,I1)),l.join("")},Yn.prototype.resolve=function(l){const h=ln(this);let p=!!l.j;p?fo(h,l.j):p=!!l.o,p?h.o=l.o:p=!!l.g,p?h.g=l.g:p=l.u!=null;var y=l.h;if(p)po(h,l.u);else if(p=!!l.h){if(y.charAt(0)!="/")if(this.g&&!this.h)y="/"+y;else{var D=h.h.lastIndexOf("/");D!=-1&&(y=h.h.slice(0,D+1)+y)}if(D=y,D==".."||D==".")y="";else if(D.indexOf("./")!=-1||D.indexOf("/.")!=-1){y=D.lastIndexOf("/",0)==0,D=D.split("/");const O=[];for(let z=0;z<D.length;){const ne=D[z++];ne=="."?y&&z==D.length&&O.push(""):ne==".."?((O.length>1||O.length==1&&O[0]!="")&&O.pop(),y&&z==D.length&&O.push("")):(O.push(ne),y=!0)}y=O.join("/")}else y=D}return p?h.h=y:p=l.i.toString()!=="",p?Oh(h,Dg(l.i)):p=!!l.m,p&&(h.m=l.m),h};function ln(l){return new Yn(l)}function fo(l,h,p){l.j=p?mo(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function po(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function Oh(l,h,p){h instanceof yo?(l.i=h,T1(l.i,l.l)):(p||(h=go(h,E1)),l.i=new yo(h,l.l))}function ye(l,h,p){l.i.set(h,p)}function vl(l){return ye(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function mo(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function go(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,_1),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function _1(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Pg=/[#\/\?@]/g,v1=/[#\?:]/g,w1=/[#\?]/g,E1=/[#\?@]/g,I1=/#/g;function yo(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Yr(l){l.g||(l.g=new Map,l.h=0,l.i&&y1(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=yo.prototype,t.add=function(l,h){Yr(this),this.i=null,l=Gs(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function kg(l,h){Yr(l),h=Gs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Cg(l,h){return Yr(l),h=Gs(l,h),l.g.has(h)}t.forEach=function(l,h){Yr(this),this.g.forEach(function(p,y){p.forEach(function(D){l.call(h,D,y,this)},this)},this)};function Ng(l,h){Yr(l);let p=[];if(typeof h=="string")Cg(l,h)&&(p=p.concat(l.g.get(Gs(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)p=p.concat(l[h]);return p}t.set=function(l,h){return Yr(this),this.i=null,l=Gs(this,l),Cg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=Ng(this,l),l.length>0?String(l[0]):h):h};function bg(l,h,p){kg(l,h),p.length>0&&(l.i=null,l.g.set(Gs(l,h),I(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(let y=0;y<h.length;y++){var p=h[y];const D=co(p);p=Ng(this,p);for(let O=0;O<p.length;O++){let z=D;p[O]!==""&&(z+="="+co(p[O])),l.push(z)}}return this.i=l.join("&")};function Dg(l){const h=new yo;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function Gs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function T1(l,h){h&&!l.j&&(Yr(l),l.i=null,l.g.forEach(function(p,y){const D=y.toLowerCase();y!=D&&(kg(this,y),bg(this,D,p))},l)),l.j=h}function x1(l,h){const p=new uo;if(o.Image){const y=new Image;y.onload=d(Xn,p,"TestLoadImage: loaded",!0,h,y),y.onerror=d(Xn,p,"TestLoadImage: error",!1,h,y),y.onabort=d(Xn,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=d(Xn,p,"TestLoadImage: timeout",!1,h,y),o.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else h(!1)}function S1(l,h){const p=new uo,y=new AbortController,D=setTimeout(()=>{y.abort(),Xn(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:y.signal}).then(O=>{clearTimeout(D),O.ok?Xn(p,"TestPingServer: ok",!0,h):Xn(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),Xn(p,"TestPingServer: error",!1,h)})}function Xn(l,h,p,y,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),y(p)}catch{}}function A1(){this.g=new l1}function Mh(l){this.i=l.Sb||null,this.h=l.ab||!1}m(Mh,ug),Mh.prototype.g=function(){return new wl(this.i,this.h)};function wl(l,h){tt.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(wl,tt),t=wl.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,vo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,_o(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,vo(this)),this.g&&(this.readyState=3,vo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Vg(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Vg(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?_o(this):vo(this),this.readyState==3&&Vg(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,_o(this))},t.Na=function(l){this.g&&(this.response=l,_o(this))},t.ga=function(){this.g&&_o(this)};function _o(l){l.readyState=4,l.l=null,l.j=null,l.B=null,vo(l)}t.setRequestHeader=function(l,h){this.A.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function vo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Og(l){let h="";return $(l,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function Lh(l,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=Og(p),typeof l=="string"?p!=null&&co(p):ye(l,h,p))}function Re(l){tt.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Re,tt);var R1=/^https?$/i,P1=["POST","PUT"];t=Re.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():gg.g(),this.g.onreadystatechange=g(c(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(O){Mg(this,O);return}if(l=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var D in y)p.set(D,y[D]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const O of y.keys())p.set(O,y.get(O));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(O=>O.toLowerCase()=="content-type"),D=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(P1,h,void 0)>=0)||y||D||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,z]of p)this.g.setRequestHeader(O,z);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(O){Mg(this,O)}};function Mg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,Lg(l),El(l)}function Lg(l){l.A||(l.A=!0,ut(l,"complete"),ut(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,ut(this,"complete"),ut(this,"abort"),El(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),El(this,!0)),Re.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?jg(this):this.Xa())},t.Xa=function(){jg(this)};function jg(l){if(l.h&&typeof i<"u"){if(l.v&&Jn(l)==4)setTimeout(l.Ca.bind(l),0);else if(ut(l,"readystatechange"),Jn(l)==4){l.h=!1;try{const O=l.ca();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=O===0){let z=String(l.D).match(Rg)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),y=!R1.test(z?z.toLowerCase():"")}p=y}if(p)ut(l,"complete"),ut(l,"success");else{l.o=6;try{var D=Jn(l)>2?l.g.statusText:""}catch{D=""}l.l=D+" ["+l.ca()+"]",Lg(l)}}finally{El(l)}}}}function El(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,h||ut(l,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Jn(l){return l.g?l.g.readyState:0}t.ca=function(){try{return Jn(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),a1(h)}};function Fg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function k1(l){const h={};l=(l.g&&Jn(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(A(l[y]))continue;var p=f1(l[y]);const D=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const O=h[D]||[];h[D]=O,O.push(p)}H(h,function(y){return y.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wo(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Ug(l){this.za=0,this.i=[],this.j=new uo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wo("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wo("baseRetryDelayMs",5e3,l),this.Za=wo("retryDelaySeedMs",1e4,l),this.Ta=wo("forwardChannelMaxRetries",2,l),this.va=wo("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Ig(l&&l.concurrentRequestLimit),this.Ba=new A1,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ug.prototype,t.ka=8,t.I=1,t.connect=function(l,h,p,y){ct(0),this.W=l,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.J=Qg(this,null,this.W),Tl(this)};function jh(l){if(zg(l),l.I==3){var h=l.V++,p=ln(l.J);if(ye(p,"SID",l.M),ye(p,"RID",h),ye(p,"TYPE","terminate"),Eo(l,p),h=new Qn(l,l.j,h),h.M=2,h.A=vl(ln(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=h.A,p=!0),p||(h.g=Yg(h.j,null),h.g.ea(h.A)),h.F=Date.now(),_l(h)}Gg(l)}function Il(l){l.g&&(Uh(l),l.g.cancel(),l.g=null)}function zg(l){Il(l),l.v&&(o.clearTimeout(l.v),l.v=null),xl(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Tl(l){if(!Tg(l.h)&&!l.m){l.m=!0;var h=l.Ea;L||v(),j||(L(),j=!0),T.add(h,l),l.D=0}}function C1(l,h){return xg(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=lo(c(l.Ea,l,h),Hg(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const D=new Qn(this,this.j,l);let O=this.o;if(this.U&&(O?(O=J(O),He(O,this.U)):O=this.U),this.u!==null||this.R||(D.J=O,O=null),this.S)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,h>4096){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=$g(this,D,h),p=ln(this.J),ye(p,"RID",l),ye(p,"CVER",22),this.G&&ye(p,"X-HTTP-Session-Id",this.G),Eo(this,p),O&&(this.R?h="headers="+co(Og(O))+"&"+h:this.u&&Lh(p,this.u,O)),Vh(this.h,D),this.Ra&&ye(p,"TYPE","init"),this.S?(ye(p,"$req",h),ye(p,"SID","null"),D.U=!0,Ch(D,p,null)):Ch(D,p,h),this.I=2}}else this.I==3&&(l?Bg(this,l):this.i.length==0||Tg(this.h)||Bg(this))};function Bg(l,h){var p;h?p=h.l:p=l.V++;const y=ln(l.J);ye(y,"SID",l.M),ye(y,"RID",p),ye(y,"AID",l.K),Eo(l,y),l.u&&l.o&&Lh(y,l.u,l.o),p=new Qn(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),h&&(l.i=h.G.concat(l.i)),h=$g(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Vh(l.h,p),Ch(p,y,h)}function Eo(l,h){l.H&&$(l.H,function(p,y){ye(h,y,p)}),l.l&&$({},function(p,y){ye(h,y,p)})}function $g(l,h,p){p=Math.min(l.i.length,p);const y=l.l?c(l.l.Ka,l.l,l):null;e:{var D=l.i;let ne=-1;for(;;){const Le=["count="+p];ne==-1?p>0?(ne=D[0].g,Le.push("ofs="+ne)):ne=0:Le.push("ofs="+ne);let me=!0;for(let Be=0;Be<p;Be++){var O=D[Be].g;const un=D[Be].map;if(O-=ne,O<0)ne=Math.max(0,D[Be].g-100),me=!1;else try{O="req"+O+"_"||"";try{var z=un instanceof Map?un:Object.entries(un);for(const[Jr,Zn]of z){let er=Zn;a(Zn)&&(er=Sh(Zn)),Le.push(O+Jr+"="+encodeURIComponent(er))}}catch(Jr){throw Le.push(O+"type="+encodeURIComponent("_badmap")),Jr}}catch{y&&y(un)}}if(me){z=Le.join("&");break e}}z=void 0}return l=l.i.splice(0,p),h.G=l,z}function qg(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;L||v(),j||(L(),j=!0),T.add(h,l),l.A=0}}function Fh(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=lo(c(l.Da,l),Hg(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Kg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=lo(c(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ct(10),Il(this),Kg(this))};function Uh(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Kg(l){l.g=new Qn(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=ln(l.na);ye(h,"RID","rpc"),ye(h,"SID",l.M),ye(h,"AID",l.K),ye(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&ye(h,"TO",l.ia),ye(h,"TYPE","xmlhttp"),Eo(l,h),l.u&&l.o&&Lh(h,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=vl(ln(h)),p.u=null,p.R=!0,vg(p,l)}t.Va=function(){this.C!=null&&(this.C=null,Il(this),Fh(this),ct(19))};function xl(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Wg(l,h){var p=null;if(l.g==h){xl(l),Uh(l),l.g=null;var y=2}else if(Dh(l.h,h))p=h.G,Sg(l.h,h),y=1;else return;if(l.I!=0){if(h.o)if(y==1){p=h.u?h.u.length:0,h=Date.now()-h.F;var D=l.D;y=gl(),ut(y,new pg(y,p)),Tl(l)}else qg(l);else if(D=h.m,D==3||D==0&&h.X>0||!(y==1&&C1(l,h)||y==2&&Fh(l)))switch(p&&p.length>0&&(h=l.h,h.i=h.i.concat(p)),D){case 1:Xr(l,5);break;case 4:Xr(l,10);break;case 3:Xr(l,6);break;default:Xr(l,2)}}}function Hg(l,h){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*h}function Xr(l,h){if(l.j.info("Error code "+h),h==2){var p=c(l.bb,l),y=l.Ua;const D=!y;y=new Yn(y||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||fo(y,"https"),vl(y),D?x1(y.toString(),p):S1(y.toString(),p)}else ct(2);l.I=0,l.l&&l.l.pa(h),Gg(l),zg(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),ct(2)):(this.j.info("Failed to ping google.com"),ct(1))};function Gg(l){if(l.I=0,l.ja=[],l.l){const h=Ag(l.h);(h.length!=0||l.i.length!=0)&&(x(l.ja,h),x(l.ja,l.i),l.h.i.length=0,I(l.i),l.i.length=0),l.l.oa()}}function Qg(l,h,p){var y=p instanceof Yn?ln(p):new Yn(p);if(y.g!="")h&&(y.g=h+"."+y.g),po(y,y.u);else{var D=o.location;y=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;const O=new Yn(null);y&&fo(O,y),h&&(O.g=h),D&&po(O,D),p&&(O.h=p),y=O}return p=l.G,h=l.wa,p&&h&&ye(y,p,h),ye(y,"VER",l.ka),Eo(l,y),y}function Yg(l,h,p){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new Re(new Mh({ab:p})):new Re(l.ma),h.Fa(l.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xg(){}t=Xg.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Sl(){}Sl.prototype.g=function(l,h){return new xt(l,h)};function xt(l,h){tt.call(this),this.g=new Ug(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!A(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!A(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Qs(this)}m(xt,tt),xt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xt.prototype.close=function(){jh(this.g)},xt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=Sh(l),l=p);h.i.push(new g1(h.Ya++,l)),h.I==3&&Tl(h)},xt.prototype.N=function(){this.g.l=null,delete this.j,jh(this.g),delete this.g,xt.Z.N.call(this)};function Jg(l){Ah.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}m(Jg,Ah);function Zg(){Rh.call(this),this.status=1}m(Zg,Rh);function Qs(l){this.g=l}m(Qs,Xg),Qs.prototype.ra=function(){ut(this.g,"a")},Qs.prototype.qa=function(l){ut(this.g,new Jg(l))},Qs.prototype.pa=function(l){ut(this.g,new Zg)},Qs.prototype.oa=function(){ut(this.g,"b")},Sl.prototype.createWebChannel=Sl.prototype.g,xt.prototype.send=xt.prototype.o,xt.prototype.open=xt.prototype.m,xt.prototype.close=xt.prototype.close,zI=function(){return new Sl},UI=function(){return gl()},FI=Gr,bf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},yl.NO_ERROR=0,yl.TIMEOUT=8,yl.HTTP_ERROR=6,yu=yl,mg.COMPLETE="complete",jI=mg,cg.EventType=oo,oo.OPEN="a",oo.CLOSE="b",oo.ERROR="c",oo.MESSAGE="d",tt.prototype.listen=tt.prototype.J,zo=cg,Re.prototype.listenOnce=Re.prototype.K,Re.prototype.getLastError=Re.prototype.Ha,Re.prototype.getLastErrorCode=Re.prototype.ya,Re.prototype.getStatus=Re.prototype.ca,Re.prototype.getResponseJson=Re.prototype.La,Re.prototype.getResponseText=Re.prototype.la,Re.prototype.send=Re.prototype.ea,Re.prototype.setWithCredentials=Re.prototype.Fa,LI=Re}).apply(typeof Wl<"u"?Wl:typeof self<"u"?self:typeof window<"u"?window:{});const K_="@firebase/firestore",W_="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ye.UNAUTHENTICATED=new Ye(null),Ye.GOOGLE_CREDENTIALS=new Ye("google-credentials-uid"),Ye.FIRST_PARTY=new Ye("first-party-uid"),Ye.MOCK_USER=new Ye("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new Zp("@firebase/firestore");function ri(){return Cs.logLevel}function F(t,...e){if(Cs.logLevel<=ie.DEBUG){const n=e.map(cm);Cs.debug(`Firestore (${no}): ${t}`,...n)}}function dt(t,...e){if(Cs.logLevel<=ie.ERROR){const n=e.map(cm);Cs.error(`Firestore (${no}): ${t}`,...n)}}function Ns(t,...e){if(Cs.logLevel<=ie.WARN){const n=e.map(cm);Cs.warn(`Firestore (${no}): ${t}`,...n)}}function cm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,BI(t,r,n)}function BI(t,e,n){let r=`FIRESTORE (${no}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw dt(r),new Error(r)}function Y(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||BI(e,s,r)}function te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class B extends An{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class x2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ye.UNAUTHENTICATED))}shutdown(){}}class S2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class A2{constructor(e){this.t=e,this.currentUser=Ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Y(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new En;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new En,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new En)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string",31837,{l:r}),new $I(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string",2055,{h:e}),new Ye(e)}}class R2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ye.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class P2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new R2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Y(this.o===void 0,3512);const r=i=>{i.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,F("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new H_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Y(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new H_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=C2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function ee(t,e){return t<e?-1:t>e?1:0}function Df(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Ed(s)===Ed(i)?ee(s,i):Ed(s)?1:-1}return ee(t.length,e.length)}const N2=55296,b2=57343;function Ed(t){const e=t.charCodeAt(0);return e>=N2&&e<=b2}function Fi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function qI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="__name__";class dn{constructor(e,n,r){n===void 0?n=0:n>e.length&&Q(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Q(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return dn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof dn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=dn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return ee(e.length,n.length)}static compareSegments(e,n){const r=dn.isNumericId(e),s=dn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?dn.extractNumericId(e).compare(dn.extractNumericId(n)):Df(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pr.fromString(e.substring(4,e.length-2))}}class ue extends dn{construct(e,n,r){return new ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new B(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ue(n)}static emptyPath(){return new ue([])}}const D2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xe extends dn{construct(e,n,r){return new xe(e,n,r)}static isValidIdentifier(e){return D2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===G_}static keyField(){return new xe([G_])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new B(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new B(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new B(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new B(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xe(n)}static emptyPath(){return new xe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.path=e}static fromPath(e){return new q(ue.fromString(e))}static fromName(e){return new q(ue.fromString(e).popFirst(5))}static empty(){return new q(ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new q(new ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t,e,n){if(!n)throw new B(M.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function V2(t,e,n,r){if(e===!0&&r===!0)throw new B(M.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Q_(t){if(!q.isDocumentKey(t))throw new B(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Y_(t){if(q.isDocumentKey(t))throw new B(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function WI(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Xc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Q(12329,{type:typeof t})}function $t(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new B(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Xc(t);throw new B(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t,e){const n={typeString:t};return e&&(n.value=e),n}function rl(t,e){if(!WI(t))throw new B(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new B(M.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=-62135596800,J_=1e6;class ce{static now(){return ce.fromMillis(Date.now())}static fromDate(e){return ce.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*J_);return new ce(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new B(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new B(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<X_)throw new B(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new B(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/J_}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rl(e,ce._jsonSchema))return new ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-X_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ce._jsonSchemaVersion="firestore/timestamp/1.0",ce._jsonSchema={type:Ve("string",ce._jsonSchemaVersion),seconds:Ve("number"),nanoseconds:Ve("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{static fromTimestamp(e){return new X(e)}static min(){return new X(new ce(0,0))}static max(){return new X(new ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=-1;class ac{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Vf(t){return t.fields.find(e=>e.kind===2)}function rs(t){return t.fields.filter(e=>e.kind!==2)}ac.UNKNOWN_ID=-1;class _u{constructor(e,n){this.fieldPath=e,this.kind=n}}class Da{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Da(0,bt.min())}}function O2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=X.fromTimestamp(r===1e9?new ce(n+1,0):new ce(n,r));return new bt(s,q.empty(),e)}function HI(t){return new bt(t.readTime,t.key,ba)}class bt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new bt(X.min(),q.empty(),ba)}static max(){return new bt(X.max(),q.empty(),ba)}}function dm(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=q.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class QI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $s(t){if(t.code!==M.FAILED_PRECONDITION||t.message!==GI)throw t;F("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Q(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new N((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof N?n:N.resolve(n)}catch(n){return N.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):N.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):N.reject(n)}static resolve(e){return new N((n,r)=>{n(e)})}static reject(e){return new N((n,r)=>{r(e)})}static waitFor(e){return new N((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=N.resolve(!1);for(const r of e)n=n.next(s=>s?N.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new N((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new N((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At="SimpleDb";class Jc{static open(e,n,r,s){try{return new Jc(n,e.transaction(s,r))}catch(i){throw new sa(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new En,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new sa(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=fm(r.target.error);this.S.reject(new sa(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(F(At,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new L2(n)}}class kr{static delete(e){return F(At,"Removing database:",e),is(zE().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!YE())return!1;if(kr.F())return!0;const e=Ue(),n=kr.M(e),r=0<n&&n<10,s=YI(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,kr.M(Ue())===12.2&&dt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(F(At,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new sa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new B(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new B(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new sa(e,o))},s.onupgradeneeded=i=>{F(At,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{F(At,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Jc.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(c=>(a.C(),c)).catch(c=>(a.abort(c),N.reject(c))).toPromise();return u.catch(()=>{}),await a.D,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(F(At,"Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function YI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class M2{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return is(this.U.delete())}}class sa extends B{constructor(e,n){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function qr(t){return t.name==="IndexedDbTransactionError"}class L2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(F(At,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(F(At,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),is(r)}add(e){return F(At,"ADD",this.store.name,e,e),is(this.store.add(e))}get(e){return is(this.store.get(e)).next(n=>(n===void 0&&(n=null),F(At,"GET",this.store.name,e,n),n))}delete(e){return F(At,"DELETE",this.store.name,e),is(this.store.delete(e))}count(){return F(At,"COUNT",this.store.name),is(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new N((o,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{o(u.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,u)=>{o.push(u)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new N((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){F(At,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new N((r,s)=>{n.onerror=i=>{const o=fm(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new N((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new M2(a),c=n(a.primaryKey,a.value,u);if(c instanceof N){const d=c.catch(m=>(u.done(),N.reject(m)));r.push(d)}u.isDone?s():u.G===null?a.continue():a.continue(u.G)}}).next(()=>N.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function is(t){return new N((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=fm(r.target.error);n(s)}})}let Z_=!1;function fm(t){const e=kr.M(Ue());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new B("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Z_||(Z_=!0,setTimeout(()=>{throw r},0)),r}}return t}const ia="IndexBackfiller";class j2{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){F(ia,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();F(ia,`Documents written: ${n}`)}catch(n){qr(n)?F(ia,"Ignoring IndexedDB error during index backfill: ",n):await $s(n)}await this.re(6e4)})}}class F2{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return N.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return F(ia,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(F(ia,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=HI(i);dm(o,r)>0&&(r=o)}),new bt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ut.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=-1;function Zc(t){return t==null}function Va(t){return t===0&&1/t==-1/0}function U2(t){return typeof t=="number"&&Number.isInteger(t)&&!Va(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc="";function at(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ev(e)),e=z2(t.get(n),e);return ev(e)}function z2(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case lc:n+="";break;default:n+=i}}return n}function ev(t){return t+lc+""}function pn(t){const e=t.length;if(Y(e>=2,64408,{path:t}),e===2)return Y(t.charAt(0)===lc&&t.charAt(1)==="",56145,{path:t}),ue.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(lc,i);switch((o<0||o>n)&&Q(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:Q(61167,{path:t})}i=o+2}return new ue(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="remoteDocuments",sl="owner",Xs="owner",Oa="mutationQueues",B2="userId",Jt="mutations",tv="batchId",ds="userMutationsIndex",nv=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t,e){return[t,at(e)]}function XI(t,e,n){return[t,at(e),n]}const $2={},Ui="documentMutations",uc="remoteDocumentsV14",q2=["prefixPath","collectionGroup","readTime","documentId"],wu="documentKeyIndex",K2=["prefixPath","collectionGroup","documentId"],JI="collectionGroupIndex",W2=["collectionGroup","readTime","prefixPath","documentId"],Ma="remoteDocumentGlobal",Of="remoteDocumentGlobalKey",zi="targets",ZI="queryTargetsIndex",H2=["canonicalId","targetId"],Bi="targetDocuments",G2=["targetId","path"],pm="documentTargetsIndex",Q2=["path","targetId"],cc="targetGlobalKey",gs="targetGlobal",La="collectionParents",Y2=["collectionId","parent"],$i="clientMetadata",X2="clientId",eh="bundles",J2="bundleId",th="namedQueries",Z2="name",mm="indexConfiguration",eN="indexId",Mf="collectionGroupIndex",tN="collectionGroup",oa="indexState",nN=["indexId","uid"],eT="sequenceNumberIndex",rN=["uid","sequenceNumber"],aa="indexEntries",sN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tT="documentKeyIndex",iN=["indexId","uid","orderedDocumentKey"],nh="documentOverlays",oN=["userId","collectionPath","documentId"],Lf="collectionPathOverlayIndex",aN=["userId","collectionPath","largestBatchId"],nT="collectionGroupOverlayIndex",lN=["userId","collectionGroup","largestBatchId"],gm="globals",uN="name",rT=[Oa,Jt,Ui,ss,zi,sl,gs,Bi,$i,Ma,La,eh,th],cN=[...rT,nh],sT=[Oa,Jt,Ui,uc,zi,sl,gs,Bi,$i,Ma,La,eh,th,nh],iT=sT,ym=[...iT,mm,oa,aa],hN=ym,oT=[...ym,gm],dN=oT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf extends QI{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function ze(t,e){const n=te(t);return kr.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function aT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e,n){this.comparator=e,this.root=n||Xe.EMPTY}insert(e,n){return new Ie(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Xe.BLACK,null,null))}remove(e){return new Ie(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hl(this.root,e,this.comparator,!0)}}class Hl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xe{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Xe.RED,this.left=s??Xe.EMPTY,this.right=i??Xe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Xe(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Xe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Xe.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Q(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Q(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Q(27949);return e+(this.isRed()?0:1)}}Xe.EMPTY=null,Xe.RED=!0,Xe.BLACK=!1;Xe.EMPTY=new class{constructor(){this.size=0}get key(){throw Q(57766)}get value(){throw Q(16141)}get color(){throw Q(16727)}get left(){throw Q(29726)}get right(){throw Q(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Xe(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.comparator=e,this.data=new Ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sv(this.data.getIterator())}getIteratorFrom(e){return new sv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof fe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new fe(this.comparator);return n.data=e,n}}class sv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Js(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.fields=e,e.sort(xe.comparator)}static empty(){return new zt([])}unionWith(e){let n=new fe(xe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new zt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Fi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new lT("Invalid base64 string: "+i):i}}(e);return new Oe(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Oe(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Oe.EMPTY_BYTE_STRING=new Oe("");const fN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $n(t){if(Y(!!t,39018),typeof t=="string"){let e=0;const n=fN.exec(t);if(Y(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:we(t.seconds),nanos:we(t.nanos)}}function we(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qn(t){return typeof t=="string"?Oe.fromBase64String(t):Oe.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uT="server_timestamp",cT="__type__",hT="__previous_value__",dT="__local_write_time__";function _m(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[cT])==null?void 0:r.stringValue)===uT}function rh(t){const e=t.mapValue.fields[hT];return _m(e)?rh(e):e}function ja(t){const e=$n(t.mapValue.fields[dT].timestampValue);return new ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e,n,r,s,i,o,a,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=d}}const hc="(default)";class bs{constructor(e,n){this.projectId=e,this.database=n||hc}static empty(){return new bs("","")}get isDefaultDatabase(){return this.database===hc}isEqual(e){return e instanceof bs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm="__type__",fT="__max__",yr={mapValue:{fields:{__type__:{stringValue:fT}}}},wm="__vector__",qi="value",Eu={nullValue:"NULL_VALUE"};function Or(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_m(t)?4:pT(t)?9007199254740991:sh(t)?10:11:Q(28295,{value:t})}function xn(t,e){if(t===e)return!0;const n=Or(t);if(n!==Or(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ja(t).isEqual(ja(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=$n(s.timestampValue),a=$n(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return qn(s.bytesValue).isEqual(qn(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return we(s.geoPointValue.latitude)===we(i.geoPointValue.latitude)&&we(s.geoPointValue.longitude)===we(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return we(s.integerValue)===we(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=we(s.doubleValue),a=we(i.doubleValue);return o===a?Va(o)===Va(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Fi(t.arrayValue.values||[],e.arrayValue.values||[],xn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(rv(o)!==rv(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!xn(o[u],a[u])))return!1;return!0}(t,e);default:return Q(52216,{left:t})}}function Fa(t,e){return(t.values||[]).find(n=>xn(n,e))!==void 0}function Mr(t,e){if(t===e)return 0;const n=Or(t),r=Or(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=we(i.integerValue||i.doubleValue),u=we(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return iv(t.timestampValue,e.timestampValue);case 4:return iv(ja(t),ja(e));case 5:return Df(t.stringValue,e.stringValue);case 6:return function(i,o){const a=qn(i),u=qn(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const d=ee(a[c],u[c]);if(d!==0)return d}return ee(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ee(we(i.latitude),we(o.latitude));return a!==0?a:ee(we(i.longitude),we(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ov(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,I,x,k;const a=i.fields||{},u=o.fields||{},c=(g=a[qi])==null?void 0:g.arrayValue,d=(I=u[qi])==null?void 0:I.arrayValue,m=ee(((x=c==null?void 0:c.values)==null?void 0:x.length)||0,((k=d==null?void 0:d.values)==null?void 0:k.length)||0);return m!==0?m:ov(c,d)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===yr.mapValue&&o===yr.mapValue)return 0;if(i===yr.mapValue)return 1;if(o===yr.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let m=0;m<u.length&&m<d.length;++m){const g=Df(u[m],d[m]);if(g!==0)return g;const I=Mr(a[u[m]],c[d[m]]);if(I!==0)return I}return ee(u.length,d.length)}(t.mapValue,e.mapValue);default:throw Q(23264,{he:n})}}function iv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);const n=$n(t),r=$n(e),s=ee(n.seconds,r.seconds);return s!==0?s:ee(n.nanos,r.nanos)}function ov(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Mr(n[s],r[s]);if(i)return i}return ee(n.length,r.length)}function Ki(t){return Ff(t)}function Ff(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=$n(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return qn(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return q.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ff(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ff(n.fields[o])}`;return s+"}"}(t.mapValue):Q(61005,{value:t})}function Iu(t){switch(Or(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rh(t);return e?16+Iu(e):16;case 5:return 2*t.stringValue.length;case 6:return qn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Iu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return qs(r.fields,(i,o)=>{s+=i.length+Iu(o)}),s}(t.mapValue);default:throw Q(13486,{value:t})}}function Ua(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Uf(t){return!!t&&"integerValue"in t}function za(t){return!!t&&"arrayValue"in t}function av(t){return!!t&&"nullValue"in t}function lv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Tu(t){return!!t&&"mapValue"in t}function sh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[vm])==null?void 0:r.stringValue)===wm}function la(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return qs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=la(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=la(t.arrayValue.values[n]);return e}return{...t}}function pT(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===fT}const mT={mapValue:{fields:{[vm]:{stringValue:wm},[qi]:{arrayValue:{}}}}};function mN(t){return"nullValue"in t?Eu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ua(bs.empty(),q.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?sh(t)?mT:{mapValue:{}}:Q(35942,{value:t})}function gN(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ua(bs.empty(),q.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?mT:"mapValue"in t?sh(t)?{mapValue:{}}:yr:Q(61959,{value:t})}function uv(t,e){const n=Mr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function cv(t,e){const n=Mr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.value=e}static empty(){return new _t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Tu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=la(n)}setAll(e){let n=xe.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=la(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Tu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Tu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){qs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new _t(la(this.value))}}function gT(t){const e=[];return qs(t.fields,(n,r)=>{const s=new xe([n]);if(Tu(r)){const i=gT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new zt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ke(e,0,X.min(),X.min(),X.min(),_t.empty(),0)}static newFoundDocument(e,n,r,s){return new ke(e,1,n,X.min(),r,s,0)}static newNoDocument(e,n){return new ke(e,2,n,X.min(),X.min(),_t.empty(),0)}static newUnknownDocument(e,n){return new ke(e,3,n,X.min(),X.min(),_t.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_t.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_t.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ke&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ke(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n){this.position=e,this.inclusive=n}}function hv(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),n.key):r=Mr(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function dv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,n="asc"){this.field=e,this.dir=n}}function yN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{}class oe extends yT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new _N(e,n,r):n==="array-contains"?new EN(e,r):n==="in"?new TT(e,r):n==="not-in"?new IN(e,r):n==="array-contains-any"?new TN(e,r):new oe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new vN(e,r):new wN(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Mr(n,this.value)):n!==null&&Or(this.value)===Or(n)&&this.matchesComparison(Mr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class he extends yT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new he(e,n)}matches(e){return Hi(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Hi(t){return t.op==="and"}function zf(t){return t.op==="or"}function Em(t){return _T(t)&&Hi(t)}function _T(t){for(const e of t.filters)if(e instanceof he)return!1;return!0}function Bf(t){if(t instanceof oe)return t.field.canonicalString()+t.op.toString()+Ki(t.value);if(Em(t))return t.filters.map(e=>Bf(e)).join(",");{const e=t.filters.map(n=>Bf(n)).join(",");return`${t.op}(${e})`}}function vT(t,e){return t instanceof oe?function(r,s){return s instanceof oe&&r.op===s.op&&r.field.isEqual(s.field)&&xn(r.value,s.value)}(t,e):t instanceof he?function(r,s){return s instanceof he&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&vT(o,s.filters[a]),!0):!1}(t,e):void Q(19439)}function wT(t,e){const n=t.filters.concat(e);return he.create(n,t.op)}function ET(t){return t instanceof oe?function(n){return`${n.field.canonicalString()} ${n.op} ${Ki(n.value)}`}(t):t instanceof he?function(n){return n.op.toString()+" {"+n.getFilters().map(ET).join(" ,")+"}"}(t):"Filter"}class _N extends oe{constructor(e,n,r){super(e,n,r),this.key=q.fromName(r.referenceValue)}matches(e){const n=q.comparator(e.key,this.key);return this.matchesComparison(n)}}class vN extends oe{constructor(e,n){super(e,"in",n),this.keys=IT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class wN extends oe{constructor(e,n){super(e,"not-in",n),this.keys=IT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function IT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>q.fromName(r.referenceValue))}class EN extends oe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return za(n)&&Fa(n.arrayValue,this.value)}}class TT extends oe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Fa(this.value.arrayValue,n)}}class IN extends oe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Fa(this.value.arrayValue,n)}}class TN extends oe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!za(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Fa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function $f(t,e=null,n=[],r=[],s=null,i=null,o=null){return new xN(t,e,n,r,s,i,o)}function Ds(t){const e=te(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Bf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Zc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ki(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ki(r)).join(",")),e.Te=n}return e.Te}function il(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!yN(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dv(t.startAt,e.startAt)&&dv(t.endAt,e.endAt)}function fc(t){return q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function pc(t,e){return t.filters.filter(n=>n instanceof oe&&n.field.isEqual(e))}function fv(t,e,n){let r=Eu,s=!0;for(const i of pc(t,e)){let o=Eu,a=!0;switch(i.op){case"<":case"<=":o=mN(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Eu}uv({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];uv({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function pv(t,e,n){let r=yr,s=!0;for(const i of pc(t,e)){let o=yr,a=!0;switch(i.op){case">=":case">":o=gN(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=yr}cv({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];cv({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function SN(t,e,n,r,s,i,o,a){return new ol(t,e,n,r,s,i,o,a)}function al(t){return new ol(t)}function mv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function xT(t){return t.collectionGroup!==null}function ua(t){const e=te(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new fe(xe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new dc(i,r))}),n.has(xe.keyField().canonicalString())||e.Ie.push(new dc(xe.keyField(),r))}return e.Ie}function qt(t){const e=te(t);return e.Ee||(e.Ee=AN(e,ua(t))),e.Ee}function AN(t,e){if(t.limitType==="F")return $f(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new dc(s.field,i)});const n=t.endAt?new Wi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Wi(t.startAt.position,t.startAt.inclusive):null;return $f(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function qf(t,e){const n=t.filters.concat([e]);return new ol(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Kf(t,e,n){return new ol(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ih(t,e){return il(qt(t),qt(e))&&t.limitType===e.limitType}function ST(t){return`${Ds(qt(t))}|lt:${t.limitType}`}function si(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>ET(s)).join(", ")}]`),Zc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ki(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ki(s)).join(",")),`Target(${r})`}(qt(t))}; limitType=${t.limitType})`}function ll(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):q.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ua(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,u){const c=hv(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,ua(r),s)||r.endAt&&!function(o,a,u){const c=hv(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,ua(r),s))}(t,e)}function RN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function AT(t){return(e,n)=>{let r=!1;for(const s of ua(t)){const i=PN(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function PN(t,e,n){const r=t.field.isKeyField()?q.comparator(e.key,n.key):function(i,o,a){const u=o.data.field(i),c=a.data.field(i);return u!==null&&c!==null?Mr(u,c):Q(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Q(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return aT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=new Ie(q.comparator);function kt(){return kN}const RT=new Ie(q.comparator);function Bo(...t){let e=RT;for(const n of t)e=e.insert(n.key,n);return e}function PT(t){let e=RT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function mn(){return ca()}function kT(){return ca()}function ca(){return new Hn(t=>t.toString(),(t,e)=>t.isEqual(e))}const CN=new Ie(q.comparator),NN=new fe(q.comparator);function re(...t){let e=NN;for(const n of t)e=e.add(n);return e}const bN=new fe(ee);function DN(){return bN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Va(e)?"-0":e}}function CT(t){return{integerValue:""+t}}function VN(t,e){return U2(e)?CT(e):Im(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(){this._=void 0}}function ON(t,e,n){return t instanceof Ba?function(s,i){const o={fields:{[cT]:{stringValue:uT},[dT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&_m(i)&&(i=rh(i)),i&&(o.fields[hT]=i),{mapValue:o}}(n,e):t instanceof Gi?bT(t,e):t instanceof Qi?DT(t,e):function(s,i){const o=NT(s,i),a=gv(o)+gv(s.Ae);return Uf(o)&&Uf(s.Ae)?CT(a):Im(s.serializer,a)}(t,e)}function MN(t,e,n){return t instanceof Gi?bT(t,e):t instanceof Qi?DT(t,e):n}function NT(t,e){return t instanceof $a?function(r){return Uf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ba extends oh{}class Gi extends oh{constructor(e){super(),this.elements=e}}function bT(t,e){const n=VT(e);for(const r of t.elements)n.some(s=>xn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Qi extends oh{constructor(e){super(),this.elements=e}}function DT(t,e){let n=VT(e);for(const r of t.elements)n=n.filter(s=>!xn(s,r));return{arrayValue:{values:n}}}class $a extends oh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function gv(t){return we(t.integerValue||t.doubleValue)}function VT(t){return za(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e,n){this.field=e,this.transform=n}}function jN(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Gi&&s instanceof Gi||r instanceof Qi&&s instanceof Qi?Fi(r.elements,s.elements,xn):r instanceof $a&&s instanceof $a?xn(r.Ae,s.Ae):r instanceof Ba&&s instanceof Ba}(t.transform,e.transform)}class FN{constructor(e,n){this.version=e,this.transformResults=n}}class wt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new wt}static exists(e){return new wt(void 0,e)}static updateTime(e){return new wt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ah{}function OT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lh(t.key,wt.none()):new ro(t.key,t.data,wt.none());{const n=t.data,r=_t.empty();let s=new fe(xe.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Kr(t.key,r,new zt(s.toArray()),wt.none())}}function UN(t,e,n){t instanceof ro?function(s,i,o){const a=s.value.clone(),u=_v(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Kr?function(s,i,o){if(!xu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=_v(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(MT(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ha(t,e,n,r){return t instanceof ro?function(i,o,a,u){if(!xu(i.precondition,o))return a;const c=i.value.clone(),d=vv(i.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Kr?function(i,o,a,u){if(!xu(i.precondition,o))return a;const c=vv(i.fieldTransforms,u,o),d=o.data;return d.setAll(MT(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return xu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function zN(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=NT(r.transform,s||null);i!=null&&(n===null&&(n=_t.empty()),n.set(r.field,i))}return n||null}function yv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Fi(r,s,(i,o)=>jN(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ro extends ah{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kr extends ah{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function MT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function _v(t,e,n){const r=new Map;Y(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,MN(o,a,n[s]))}return r}function vv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,ON(i,o,e))}return r}class lh extends ah{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LT extends ah{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&UN(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ha(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ha(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const u=OT(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),re())}isEqual(e){return this.batchId===e.batchId&&Fi(this.mutations,e.mutations,(n,r)=>yv(n,r))&&Fi(this.baseMutations,e.baseMutations,(n,r)=>yv(n,r))}}class xm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Y(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return CN}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new xm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be,ae;function $N(t){switch(t){case M.OK:return Q(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return Q(15467,{code:t})}}function jT(t){if(t===void 0)return dt("GRPC error has no .code"),M.UNKNOWN;switch(t){case be.OK:return M.OK;case be.CANCELLED:return M.CANCELLED;case be.UNKNOWN:return M.UNKNOWN;case be.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case be.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case be.INTERNAL:return M.INTERNAL;case be.UNAVAILABLE:return M.UNAVAILABLE;case be.UNAUTHENTICATED:return M.UNAUTHENTICATED;case be.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case be.NOT_FOUND:return M.NOT_FOUND;case be.ALREADY_EXISTS:return M.ALREADY_EXISTS;case be.PERMISSION_DENIED:return M.PERMISSION_DENIED;case be.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case be.ABORTED:return M.ABORTED;case be.OUT_OF_RANGE:return M.OUT_OF_RANGE;case be.UNIMPLEMENTED:return M.UNIMPLEMENTED;case be.DATA_LOSS:return M.DATA_LOSS;default:return Q(39323,{code:t})}}(ae=be||(be={}))[ae.OK=0]="OK",ae[ae.CANCELLED=1]="CANCELLED",ae[ae.UNKNOWN=2]="UNKNOWN",ae[ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ae[ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ae[ae.NOT_FOUND=5]="NOT_FOUND",ae[ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",ae[ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",ae[ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",ae[ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ae[ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ae[ae.ABORTED=10]="ABORTED",ae[ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",ae[ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",ae[ae.INTERNAL=13]="INTERNAL",ae[ae.UNAVAILABLE=14]="UNAVAILABLE",ae[ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN=new Pr([4294967295,4294967295],0);function wv(t){const e=qN().encode(t),n=new MI;return n.update(e),new Uint8Array(n.digest())}function Ev(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Pr([n,r],0),new Pr([s,i],0)]}class Am{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $o(`Invalid padding: ${n}`);if(r<0)throw new $o(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $o(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $o(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Pr.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Pr.fromNumber(r)));return s.compare(KN)===1&&(s=new Pr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=wv(e),[r,s]=Ev(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Am(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=wv(e),[r,s]=Ev(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class $o extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ul.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new uh(X.min(),s,new Ie(ee),kt(),re())}}class ul{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ul(r,n,re(),re(),re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class FT{constructor(e,n){this.targetId=e,this.Ce=n}}class UT{constructor(e,n,r=Oe.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Iv{constructor(){this.ve=0,this.Fe=Tv(),this.Me=Oe.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=re(),n=re(),r=re();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Q(38017,{changeType:i})}}),new ul(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Tv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Y(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class WN{constructor(e){this.Ge=e,this.ze=new Map,this.je=kt(),this.Je=Gl(),this.He=Gl(),this.Ye=new Ie(ee)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Q(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(fc(i))if(r===0){const o=new q(i.path);this.et(n,o,ke.newNoDocument(o,X.min()))}else Y(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),u=a?this.ct(a,e,o):1;if(u!==0){this.it(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=qn(r).toUint8Array()}catch(u){if(u instanceof lT)return Ns("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Am(o,s,i)}catch(u){return Ns(u instanceof $o?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&fc(a.target)){const u=new q(a.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,ke.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=re();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.ot(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new uh(e,n,this.Ye,this.je,r);return this.je=kt(),this.Je=Gl(),this.He=Gl(),this.Ye=new Ie(ee),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Iv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new fe(ee),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new fe(ee),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||F("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Iv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Gl(){return new Ie(q.comparator)}function Tv(){return new Ie(q.comparator)}const HN={asc:"ASCENDING",desc:"DESCENDING"},GN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},QN={and:"AND",or:"OR"};class YN{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wf(t,e){return t.useProto3Json||Zc(e)?e:{value:e}}function Yi(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function XN(t,e){return Yi(t,e.toTimestamp())}function pt(t){return Y(!!t,49232),X.fromTimestamp(function(n){const r=$n(n);return new ce(r.seconds,r.nanos)}(t))}function Rm(t,e){return Hf(t,e).canonicalString()}function Hf(t,e){const n=function(s){return new ue(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function BT(t){const e=ue.fromString(t);return Y(XT(e),10190,{key:e.toString()}),e}function mc(t,e){return Rm(t.databaseId,e.path)}function ys(t,e){const n=BT(e);if(n.get(1)!==t.databaseId.projectId)throw new B(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new B(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new q(KT(n))}function $T(t,e){return Rm(t.databaseId,e)}function qT(t){const e=BT(t);return e.length===4?ue.emptyPath():KT(e)}function Gf(t){return new ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KT(t){return Y(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function xv(t,e,n){return{name:mc(t,e),fields:n.value.mapValue.fields}}function JN(t,e,n){const r=ys(t,e.name),s=pt(e.updateTime),i=e.createTime?pt(e.createTime):X.min(),o=new _t({mapValue:{fields:e.fields}}),a=ke.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function ZN(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Q(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(Y(d===void 0||typeof d=="string",58123),Oe.fromBase64String(d||"")):(Y(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Oe.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?M.UNKNOWN:jT(c.code);return new B(d,c.message||"")}(o);n=new UT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ys(t,r.document.name),i=pt(r.document.updateTime),o=r.document.createTime?pt(r.document.createTime):X.min(),a=new _t({mapValue:{fields:r.document.fields}}),u=ke.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Su(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ys(t,r.document),i=r.readTime?pt(r.readTime):X.min(),o=ke.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Su([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ys(t,r.document),i=r.removedTargetIds||[];n=new Su([],i,s,null)}else{if(!("filter"in e))return Q(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new BN(s,i),a=r.targetId;n=new FT(a,o)}}return n}function gc(t,e){let n;if(e instanceof ro)n={update:xv(t,e.key,e.value)};else if(e instanceof lh)n={delete:mc(t,e.key)};else if(e instanceof Kr)n={update:xv(t,e.key,e.data),updateMask:ib(e.fieldMask)};else{if(!(e instanceof LT))return Q(16599,{Vt:e.type});n={verify:mc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Ba)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Qi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof $a)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Q(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:XN(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Q(27497)}(t,e.precondition)),n}function Qf(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?wt.updateTime(pt(i.updateTime)):i.exists!==void 0?wt.exists(i.exists):wt.none()}(e.currentDocument):wt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let u=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),u=new Ba;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Gi(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new Qi(d)}else"increment"in a?u=new $a(o,a.increment):Q(16584,{proto:a});const c=xe.fromServerFormat(a.fieldPath);return new LN(c,u)}(t,s)):[];if(e.update){e.update.name;const s=ys(t,e.update.name),i=new _t({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new zt(c.map(d=>xe.fromServerFormat(d)))}(e.updateMask);return new Kr(s,i,o,n,r)}return new ro(s,i,n,r)}if(e.delete){const s=ys(t,e.delete);return new lh(s,n)}if(e.verify){const s=ys(t,e.verify);return new LT(s,n)}return Q(1463,{proto:e})}function eb(t,e){return t&&t.length>0?(Y(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?pt(s.updateTime):pt(i);return o.isEqual(X.min())&&(o=pt(i)),new FN(o,s.transformResults||[])}(n,e))):[]}function WT(t,e){return{documents:[$T(t,e.path)]}}function HT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$T(t,s);const i=function(c){if(c.length!==0)return YT(he.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(g){return{field:ii(g.field),direction:nb(g.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Wf(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:n,parent:s}}function GT(t){let e=qT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Y(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const g=QT(m);return g instanceof he&&Em(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(x){return new dc(oi(x.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,Zc(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(m){const g=!!m.before,I=m.values||[];return new Wi(I,g)}(n.startAt));let c=null;return n.endAt&&(c=function(m){const g=!m.before,I=m.values||[];return new Wi(I,g)}(n.endAt)),SN(e,s,o,i,a,"F",u,c)}function tb(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function QT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=oi(n.unaryFilter.field);return oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=oi(n.unaryFilter.field);return oe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=oi(n.unaryFilter.field);return oe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=oi(n.unaryFilter.field);return oe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Q(61313);default:return Q(60726)}}(t):t.fieldFilter!==void 0?function(n){return oe.create(oi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Q(58110);default:return Q(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return he.create(n.compositeFilter.filters.map(r=>QT(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Q(1026)}}(n.compositeFilter.op))}(t):Q(30097,{filter:t})}function nb(t){return HN[t]}function rb(t){return GN[t]}function sb(t){return QN[t]}function ii(t){return{fieldPath:t.canonicalString()}}function oi(t){return xe.fromServerFormat(t.fieldPath)}function YT(t){return t instanceof oe?function(n){if(n.op==="=="){if(lv(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NAN"}};if(av(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(lv(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NOT_NAN"}};if(av(n.value))return{unaryFilter:{field:ii(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ii(n.field),op:rb(n.op),value:n.value}}}(t):t instanceof he?function(n){const r=n.getFilters().map(s=>YT(s));return r.length===1?r[0]:{compositeFilter:{op:sb(n.op),filters:r}}}(t):Q(54877,{filter:t})}function ib(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function XT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,n,r,s,i=X.min(),o=X.min(),a=Oe.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Vn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e){this.yt=e}}function ob(t,e){let n;if(e.document)n=JN(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=q.fromSegments(e.noDocument.path),s=Os(e.noDocument.readTime);n=ke.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q(56709);{const r=q.fromSegments(e.unknownDocument.path),s=Os(e.unknownDocument.version);n=ke.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new ce(s[0],s[1]);return X.fromTimestamp(i)}(e.readTime)),n}function Sv(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:yc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:mc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Yi(i,o.version.toTimestamp()),createTime:Yi(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Vs(e.version)};else{if(!e.isUnknownDocument())return Q(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Vs(e.version)}}return r}function yc(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Vs(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Os(t){const e=new ce(t.seconds,t.nanoseconds);return X.fromTimestamp(e)}function os(t,e){const n=(e.baseMutations||[]).map(i=>Qf(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Qf(t.yt,i)),s=ce.fromMillis(e.localWriteTimeMs);return new Tm(e.batchId,s,n,r)}function qo(t){const e=Os(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Os(t.lastLimboFreeSnapshotVersion):X.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Y(o===1,1966,{count:o}),qt(al(qT(i.documents[0])))}(t.query):function(i){return qt(GT(i))}(t.query),new Vn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Oe.fromBase64String(t.resumeToken))}function ZT(t,e){const n=Vs(e.snapshotVersion),r=Vs(e.lastLimboFreeSnapshotVersion);let s;s=fc(e.target)?WT(t.yt,e.target):HT(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ds(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function ex(t){const e=GT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Kf(e,e.limit,"L"):e}function Id(t,e){return new Sm(e.largestBatchId,Qf(t.yt,e.overlayMutation))}function Av(t,e){const n=e.path.lastSegment();return[t,at(e.path.popLast()),n]}function Rv(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Vs(r.readTime),documentKey:at(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{getBundleMetadata(e,n){return Pv(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Os(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return Pv(e).put(function(s){return{bundleId:s.id,createTime:Vs(pt(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return kv(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:ex(i.bundledQuery),readTime:Os(i.readTime)}}(r)})}saveNamedQuery(e,n){return kv(e).put(function(s){return{name:s.name,readTime:Vs(pt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function Pv(t){return ze(t,eh)}function kv(t){return ze(t,th)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new ch(e,r)}getOverlay(e,n){return Co(e).get(Av(this.userId,n)).next(r=>r?Id(this.serializer,r):null)}getOverlays(e,n){const r=mn();return N.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Sm(n,o);s.push(this.St(e,a))}),N.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(at(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Co(e).Z(Lf,a))}),N.waitFor(i)}getOverlaysForCollection(e,n,r){const s=mn(),i=at(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Co(e).J(Lf,o).next(a=>{for(const u of a){const c=Id(this.serializer,u);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=mn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Co(e).ee({index:nT,range:a},(u,c,d)=>{const m=Id(this.serializer,c);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):d.done()}).next(()=>i)}St(e,n){return Co(e).put(function(s,i,o){const[a,u,c]=Av(i,o.mutation.key);return{userId:i,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:gc(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Co(t){return ze(t,nh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{bt(e){return ze(e,gm)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Oe.fromUint8Array(r):Oe.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(we(e.integerValue));else if("doubleValue"in e){const r=we(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Va(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=$n(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(qn(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?pT(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):sh(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Q(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=qi,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(we(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),q.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}as.Kt=new as;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=255;function ub(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function Cv(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=ub(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class cb{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=Cv(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=Cv(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Zs),this.sn(255)}_n(){this.an(Zs),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Zs?(this.sn(Zs),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Zs?(this.an(Zs),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class hb{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class db{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class No{constructor(){this.cn=new cb,this.ln=new hb(this.cn),this.hn=new db(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new ls(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Au(this.En),directionalValue:Au(this.dn),orderedDocumentKey:Au(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function rr(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=Nv(t.En,e.En),n!==0?n:(n=Nv(t.dn,e.dn),n!==0?n:q.comparator(t.In,e.In)))}function Nv(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Au(t){return QE()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function bv(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class Dv{constructor(e){this.mn=new fe((n,r)=>xe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Y(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Vf(e);if(n!==void 0&&!this.wn(n))return!1;const r=rs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const u=r[i];if(!this.Sn(a,u)||!this.bn(this.fn[o++],u))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new fe(xe.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new _u(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new _u(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new _u(r.field,r.dir==="asc"?0:1)));return new ac(ac.UNKNOWN_ID,this.collectionId,n,Da.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(t){var n,r;if(Y(t instanceof oe||t instanceof he,20012),t instanceof oe){if(t instanceof TT){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>oe.create(t.field,"==",i)))||[];return he.create(s,"or")}return t}const e=t.filters.map(s=>tx(s));return he.create(e,t.op)}function fb(t){if(t.getFilters().length===0)return[];const e=Jf(tx(t));return Y(nx(e),7391),Yf(e)||Xf(e)?[e]:e.getFilters()}function Yf(t){return t instanceof oe}function Xf(t){return t instanceof he&&Em(t)}function nx(t){return Yf(t)||Xf(t)||function(n){if(n instanceof he&&zf(n)){for(const r of n.getFilters())if(!Yf(r)&&!Xf(r))return!1;return!0}return!1}(t)}function Jf(t){if(Y(t instanceof oe||t instanceof he,34018),t instanceof oe)return t;if(t.filters.length===1)return Jf(t.filters[0]);const e=t.filters.map(r=>Jf(r));let n=he.create(e,t.op);return n=_c(n),nx(n)?n:(Y(n instanceof he,64498),Y(Hi(n),40251),Y(n.filters.length>1,57927),n.filters.reduce((r,s)=>Pm(r,s)))}function Pm(t,e){let n;return Y(t instanceof oe||t instanceof he,38388),Y(e instanceof oe||e instanceof he,25473),n=t instanceof oe?e instanceof oe?function(s,i){return he.create([s,i],"and")}(t,e):Vv(t,e):e instanceof oe?Vv(e,t):function(s,i){if(Y(s.filters.length>0&&i.filters.length>0,48005),Hi(s)&&Hi(i))return wT(s,i.getFilters());const o=zf(s)?s:i,a=zf(s)?i:s,u=o.filters.map(c=>Pm(c,a));return he.create(u,"or")}(t,e),_c(n)}function Vv(t,e){if(Hi(e))return wT(e,t.getFilters());{const n=e.filters.map(r=>Pm(t,r));return he.create(n,"or")}}function _c(t){if(Y(t instanceof oe||t instanceof he,11850),t instanceof oe)return t;const e=t.getFilters();if(e.length===1)return _c(e[0]);if(_T(t))return t;const n=e.map(s=>_c(s)),r=[];return n.forEach(s=>{s instanceof oe?r.push(s):s instanceof he&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:he.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(){this.Cn=new km}addToCollectionParentIndex(e,n){return this.Cn.add(n),N.resolve()}getCollectionParents(e,n){return N.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return N.resolve()}deleteFieldIndex(e,n){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,n){return N.resolve()}getDocumentsMatchingTarget(e,n){return N.resolve(null)}getIndexType(e,n){return N.resolve(0)}getFieldIndexes(e,n){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,n){return N.resolve(bt.min())}getMinOffsetFromCollectionGroup(e,n){return N.resolve(bt.min())}updateCollectionGroup(e,n,r){return N.resolve()}updateIndexEntries(e,n){return N.resolve()}}class km{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new fe(ue.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new fe(ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="IndexedDbIndexManager",Ql=new Uint8Array(0);class mb{constructor(e,n){this.databaseId=n,this.vn=new km,this.Fn=new Hn(r=>Ds(r),(r,s)=>il(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:at(s)};return Mv(e).put(i)}return N.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[qI(n),""],!1,!0);return Mv(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(pn(o.parent))}return r})}addFieldIndex(e,n){const r=bo(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=ti(e);return i.next(a=>{o.put(Rv(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=bo(e),s=ti(e),i=ei(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=bo(e),r=ei(e),s=ti(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return N.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Dv(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=ei(e);let s=!0;const i=new Map;return N.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=re();const a=[];return N.forEach(i,(u,c)=>{F(Ov,`Using index ${function(E){return`id=${E.indexId}|cg=${E.collectionGroup}|f=${E.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(u)} to execute ${Ds(n)}`);const d=function(E,V){const L=Vf(V);if(L===void 0)return null;for(const j of pc(E,L.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(c,u),m=function(E,V){const L=new Map;for(const j of rs(V))for(const T of pc(E,j.fieldPath))switch(T.op){case"==":case"in":L.set(j.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return L.set(j.fieldPath.canonicalString(),T.value),Array.from(L.values())}return null}(c,u),g=function(E,V){const L=[];let j=!0;for(const T of rs(V)){const v=T.kind===0?fv(E,T.fieldPath,E.startAt):pv(E,T.fieldPath,E.startAt);L.push(v.value),j&&(j=v.inclusive)}return new Wi(L,j)}(c,u),I=function(E,V){const L=[];let j=!0;for(const T of rs(V)){const v=T.kind===0?pv(E,T.fieldPath,E.endAt):fv(E,T.fieldPath,E.endAt);L.push(v.value),j&&(j=v.inclusive)}return new Wi(L,j)}(c,u),x=this.On(u,c,g),k=this.On(u,c,I),C=this.Nn(u,c,m),w=this.Bn(u.indexId,d,x,g.inclusive,k,I.inclusive,C);return N.forEach(w,_=>r.Y(_,n.limit).next(E=>{E.forEach(V=>{const L=q.fromSegments(V.documentKey);o.has(L)||(o=o.add(L),a.push(L))})}))}).next(()=>a)}return N.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=fb(he.create(e.filters,"and")).map(r=>$f(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const u=(n!=null?n.length:1)*Math.max(r.length,i.length),c=u/(n!=null?n.length:1),d=[];for(let m=0;m<u;++m){const g=n?this.Ln(n[m/c]):Ql,I=this.kn(e,g,r[m%c],s),x=this.qn(e,g,i[m%c],o),k=a.map(C=>this.kn(e,g,C,!0));d.push(...this.createRange(I,x,k))}return d}kn(e,n,r,s){const i=new ls(e,q.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new ls(e,q.empty(),n,r);return s?i.An():i}xn(e,n){const r=new Dv(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return N.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new fe(xe.comparator),d=!1;for(const m of u.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:c=c.add(g.field));for(const m of u.orderBy)m.field.isKeyField()||(c=c.add(m.field));return c.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new No;for(const s of rs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);as.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new No;return as.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new No;return as.Kt.Dt(Ua(this.databaseId,n),r.Pn(function(i){const o=rs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new No);let i=0;for(const o of rs(e)){const a=r[i++];for(const u of s)if(this.Un(n,o.fieldPath)&&za(a))s=this.Kn(s,o,a);else{const c=u.Pn(o.kind);as.Kt.Dt(a,c)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const u=new No;u.seed(a.un()),as.Kt.Dt(o,u.Pn(n.kind)),i.push(u)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof oe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=bo(e),s=ti(e);return(n?r.J(Mf,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return N.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(d,m){const g=m?new Da(m.sequenceNumber,new bt(Os(m.readTime),new q(pn(m.documentKey)),m.largestBatchId)):Da.empty(),I=d.fields.map(([x,k])=>new _u(xe.fromServerFormat(x),k));return new ac(d.indexId,d.collectionGroup,I,g)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ee(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=bo(e),i=ti(e);return this.Gn(e).next(o=>s.J(Mf,IDBKeyRange.bound(n,n)).next(a=>N.forEach(a,u=>i.put(Rv(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return N.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),N.forEach(a,u=>this.zn(e,s,u).next(c=>{const d=this.jn(i,u);return c.isEqual(d)?N.resolve():this.Jn(e,i,u,c,d)}))))})}Hn(e,n,r,s){return ei(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return ei(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=ei(e);let i=new fe(rr);return s.ee({index:tT,range:IDBKeyRange.only([r.indexId,this.uid,Au(this.$n(r,n))])},(o,a)=>{i=i.add(new ls(r.indexId,n,bv(a.arrayValue),bv(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new fe(rr);const s=this.Qn(n,e);if(s==null)return r;const i=Vf(n);if(i!=null){const o=e.data.field(i.fieldPath);if(za(o))for(const a of o.arrayValue.values||[])r=r.add(new ls(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new ls(n.indexId,e.key,Ql,s));return r}Jn(e,n,r,s,i){F(Ov,"Updating index entries for document '%s'",n.key);const o=[];return function(u,c,d,m,g){const I=u.getIterator(),x=c.getIterator();let k=Js(I),C=Js(x);for(;k||C;){let w=!1,_=!1;if(k&&C){const E=d(k,C);E<0?_=!0:E>0&&(w=!0)}else k!=null?_=!0:w=!0;w?(m(C),C=Js(x)):_?(g(k),k=Js(I)):(k=Js(I),C=Js(x))}}(s,i,rr,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),N.waitFor(o)}Gn(e){let n=1;return ti(e).ee({index:eT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>rr(o,a)).filter((o,a,u)=>!a||rr(o,u[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=rr(o,e),u=rr(o,n);if(a===0)s[0]=e.An();else if(a>0&&u<0)s.push(o),s.push(o.An());else if(u>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,Ql,q.empty()),u=s[o+1].Vn(this.uid,Ql,q.empty());i.push(IDBKeyRange.bound(a,u))}return i}Zn(e,n){return rr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Lv)}getMinOffset(e,n){return N.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||Q(44426))).next(Lv)}}function Mv(t){return ze(t,La)}function ei(t){return ze(t,aa)}function bo(t){return ze(t,mm)}function ti(t){return ze(t,oa)}function Lv(t){Y(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;dm(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new bt(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rx=41943040;class it{static withCacheSize(e){return new it(e,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(t,e,n){const r=t.store(Jt),s=t.store(Ui),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.ee({range:o},(d,m,g)=>(a++,g.delete()));i.push(u.next(()=>{Y(a===1,47070,{batchId:n.batchId})}));const c=[];for(const d of n.mutations){const m=XI(e,d.key.path,n.batchId);i.push(s.delete(m)),c.push(d.key)}return N.waitFor(i).next(()=>c)}function vc(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Q(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */it.DEFAULT_COLLECTION_PERCENTILE=10,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,it.DEFAULT=new it(rx,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),it.DISABLED=new it(-1,0,0);class hh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){Y(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new hh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sr(e).ee({index:ds,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=ai(e),o=sr(e);return o.add({}).next(a=>{Y(typeof a=="number",49019);const u=new Tm(a,n,r,s),c=function(I,x,k){const C=k.baseMutations.map(_=>gc(I.yt,_)),w=k.mutations.map(_=>gc(I.yt,_));return{userId:x,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:C,mutations:w}}(this.serializer,this.userId,u),d=[];let m=new fe((g,I)=>ee(g.canonicalString(),I.canonicalString()));for(const g of s){const I=XI(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),d.push(o.put(c)),d.push(i.put(I,$2))}return m.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Xn[a]=u.keys()}),N.waitFor(d).next(()=>u)})}lookupMutationBatch(e,n){return sr(e).get(n).next(r=>r?(Y(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),os(this.serializer,r)):null)}er(e,n){return this.Xn[n]?N.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return sr(e).ee({index:ds,range:s},(o,a,u)=>{a.userId===this.userId&&(Y(a.batchId>=r,47524,{tr:r}),i=os(this.serializer,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ms;return sr(e).ee({index:ds,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,ms],[this.userId,Number.POSITIVE_INFINITY]);return sr(e).J(ds,n).next(r=>r.map(s=>os(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=vu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return ai(e).ee({range:s},(o,a,u)=>{const[c,d,m]=o,g=pn(d);if(c===this.userId&&n.path.isEqual(g))return sr(e).get(m).next(I=>{if(!I)throw Q(61480,{nr:o,batchId:m});Y(I.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:I.userId,batchId:m}),i.push(os(this.serializer,I))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new fe(ee);const s=[];return n.forEach(i=>{const o=vu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=ai(e).ee({range:a},(c,d,m)=>{const[g,I,x]=c,k=pn(I);g===this.userId&&i.path.isEqual(k)?r=r.add(x):m.done()});s.push(u)}),N.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=vu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new fe(ee);return ai(e).ee({range:o},(u,c,d)=>{const[m,g,I]=u,x=pn(g);m===this.userId&&r.isPrefixOf(x)?x.length===s&&(a=a.add(I)):d.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(sr(e).get(i).next(o=>{if(o===null)throw Q(35274,{batchId:i});Y(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(os(this.serializer,o))}))}),N.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return sx(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),N.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return N.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ai(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=pn(i[1]);s.push(u)}else a.done()}).next(()=>{Y(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return ix(e,this.userId,n)}_r(e){return ox(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:ms,lastStreamToken:""})}}function ix(t,e,n){const r=vu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ai(t).ee({range:i,X:!0},(a,u,c)=>{const[d,m,g]=a;d===e&&m===s&&(o=!0),c.done()}).next(()=>o)}function sr(t){return ze(t,Jt)}function ai(t){return ze(t,Ui)}function ox(t){return ze(t,Oa)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ms(0)}static cr(){return new Ms(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Ms(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>X.fromTimestamp(new ce(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ni(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(Y(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return ni(e).ee((o,a)=>{const u=qo(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>N.waitFor(i)).next(()=>s)}forEachTarget(e,n){return ni(e).ee((r,s)=>{const i=qo(s);n(i)})}lr(e){return Fv(e).get(cc).next(n=>(Y(n!==null,2888),n))}hr(e,n){return Fv(e).put(cc,n)}Pr(e,n){return ni(e).put(ZT(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ds(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ni(e).ee({range:s,index:ZI},(o,a,u)=>{const c=qo(a);il(n,c.target)&&(i=c,u.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=pr(e);return n.forEach(o=>{const a=at(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(s)}removeMatchingKeys(e,n,r){const s=pr(e);return N.forEach(n,i=>{const o=at(i.path);return N.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=pr(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=pr(e);let i=re();return s.ee({range:r,X:!0},(o,a,u)=>{const c=pn(o[1]),d=new q(c);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=at(n.path),s=IDBKeyRange.bound([r],[qI(r)],!1,!0);let i=0;return pr(e).ee({index:pm,X:!0,range:s},([o,a],u,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}At(e,n){return ni(e).get(n).next(r=>r?qo(r):null)}}function ni(t){return ze(t,zi)}function Fv(t){return ze(t,gs)}function pr(t){return ze(t,Bi)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="LruGarbageCollector",yb=1048576;function zv([t,e],[n,r]){const s=ee(t,n);return s===0?ee(e,r):s}class _b{constructor(e){this.Ir=e,this.buffer=new fe(zv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();zv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ax{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){F(Uv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){qr(n)?F(Uv,"Ignoring IndexedDB error during garbage collection: ",n):await $s(n)}await this.Vr(3e5)})}}class vb{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return N.resolve(Ut.ce);const r=new _b(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(jv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(c=Date.now(),ri()<=ie.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${m} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function lx(t,e){return new vb(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,n){this.db=e,this.garbageCollector=lx(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return Yl(e,r)}removeReference(e,n,r){return Yl(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Yl(e,n)}br(e,n){return function(s,i){let o=!1;return ox(s).te(a=>ix(s,a,i).next(u=>(u&&(o=!0),N.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const u=this.br(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,X.min()),pr(e).delete(function(m){return[0,at(m.path)]}(o))))});s.push(u)}}).next(()=>N.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Yl(e,n)}Sr(e,n){const r=pr(e);let s,i=Ut.ce;return r.ee({index:pm},([o,a],{path:u,sequenceNumber:c})=>{o===0?(i!==Ut.ce&&n(new q(pn(s)),i),i=c,s=u):i=Ut.ce}).next(()=>{i!==Ut.ce&&n(new q(pn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Yl(t,e){return pr(t).put(function(r,s){return{targetId:0,path:at(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(){this.changes=new Hn(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ke.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?N.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Zr(e).put(r)}removeEntry(e,n,r){return Zr(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],yc(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=ke.newInvalidDocument(n);return Zr(e).ee({index:wu,range:IDBKeyRange.only(Do(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:ke.newInvalidDocument(n)};return Zr(e).ee({index:wu,range:IDBKeyRange.only(Do(n))},(s,i)=>{r={document:this.Cr(n,i),size:vc(i)}}).next(()=>r)}getEntries(e,n){let r=kt();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=kt(),s=new Ie(q.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,vc(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return N.resolve();let s=new fe(qv);n.forEach(u=>s=s.add(u));const i=IDBKeyRange.bound(Do(s.first()),Do(s.last())),o=s.getIterator();let a=o.getNext();return Zr(e).ee({index:wu,range:i},(u,c,d)=>{const m=q.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&qv(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.j(Do(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),yc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zr(e).J(IDBKeyRange.bound(a,u,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let d=kt();for(const m of c){const g=this.Cr(q.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(ll(n,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=kt();const o=$v(n,r),a=$v(n,bt.max());return Zr(e).ee({index:JI,range:IDBKeyRange.bound(o,a,!0)},(u,c,d)=>{const m=this.Cr(q.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(m.key,m),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new Ib(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Bv(e).get(Of).next(n=>(Y(!!n,20021),n))}Dr(e,n){return Bv(e).put(Of,n)}Cr(e,n){if(n){const r=ob(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return ke.newInvalidDocument(e)}}function cx(t){return new Eb(t)}class Ib extends ux{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Hn(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new fe((i,o)=>ee(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=Sv(this.Nr.serializer,o);s=s.add(i.path.popLast());const c=vc(u);r+=c-a.size,n.push(this.Nr.addEntry(e,i,u))}else if(r-=a.size,this.trackRemovals){const u=Sv(this.Nr.serializer,o.convertToNoDocument(X.min()));n.push(this.Nr.addEntry(e,i,u))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),N.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Bv(t){return ze(t,Ma)}function Zr(t){return ze(t,uc)}function Do(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $v(t,e){const n=e.documentKey.path.toArray();return[t,yc(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function qv(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ee(n[i],r[i]),s)return s;return s=ee(n.length,r.length),s||(s=ee(n[n.length-2],r[r.length-2]),s||ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ha(r.mutation,s,zt.empty(),ce.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=re()){const s=mn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Bo();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=mn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,re()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=kt();const o=ca(),a=function(){return ca()}();return n.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof Kr)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),ha(d.mutation,c,d.mutation.getFieldMask(),ce.now())):o.set(c.key,zt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>a.set(c,new Tb(d,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,n){const r=ca();let s=new Ie((o,a)=>o-a),i=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let d=r.get(u)||zt.empty();d=a.applyToLocalView(c,d),r.set(u,d);const m=(s.get(a.batchId)||re()).add(u);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,d=u.value,m=kT();d.forEach(g=>{if(!i.has(g)){const I=OT(n.get(g),r.get(g));I!==null&&m.set(g,I),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,m))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):xT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):N.resolve(mn());let a=ba,u=i;return o.next(c=>N.forEach(c,(d,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,re())).next(d=>({batchId:a,changes:PT(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new q(n)).next(r=>{let s=Bo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Bo();return this.indexManager.getCollectionParents(e,i).next(a=>N.forEach(a,u=>{const c=function(m,g){return new ol(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,ke.newInvalidDocument(d)))});let a=Bo();return o.forEach((u,c)=>{const d=i.get(u);d!==void 0&&ha(d.mutation,c,zt.empty(),ce.now()),ll(n,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return N.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:pt(s.createTime)}}(n)),N.resolve()}getNamedQuery(e,n){return N.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:ex(s.bundledQuery),readTime:pt(s.readTime)}}(n)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(){this.overlays=new Ie(q.comparator),this.qr=new Map}getOverlay(e,n){return N.resolve(this.overlays.get(n))}getOverlays(e,n){const r=mn();return N.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),N.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),N.resolve()}getOverlaysForCollection(e,n,r){const s=mn(),i=n.length+1,o=new q(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return N.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ie((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=mn(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=mn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return N.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Sm(n,r));let i=this.qr.get(n);i===void 0&&(i=re(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(){this.sessionToken=Oe.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,N.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this.Qr=new fe($e.$r),this.Ur=new fe($e.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new $e(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new $e(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new q(new ue([])),r=new $e(n,e),s=new $e(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new q(new ue([])),r=new $e(n,e),s=new $e(n,e+1);let i=re();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new $e(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class $e{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return q.comparator(e.key,n.key)||ee(e.Yr,n.Yr)}static Kr(e,n){return ee(e.Yr,n.Yr)||q.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new fe($e.$r)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Tm(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new $e(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,n){return N.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return N.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?ms:this.tr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new $e(n,0),s=new $e(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),N.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new fe(ee);return n.forEach(s=>{const i=new $e(s,0),o=new $e(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),N.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;q.isDocumentKey(i)||(i=i.child(""));const o=new $e(new q(i),0);let a=new fe(ee);return this.Zr.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(u.Yr)),!0)},o),N.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Y(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return N.forEach(n.mutations,s=>{const i=new $e(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new $e(n,0),s=this.Zr.firstAfterOrEqual(r);return N.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e){this.ri=e,this.docs=function(){return new Ie(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return N.resolve(r?r.document.mutableCopy():ke.newInvalidDocument(n))}getEntries(e,n){let r=kt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ke.newInvalidDocument(s))}),N.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=kt();const o=n.path,a=new q(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||dm(HI(d),r)<=0||(s.has(d.key)||ll(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return N.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Q(9500)}ii(e,n){return N.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new kb(this)}getSize(e){return N.resolve(this.size)}}class kb extends ux{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),N.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e){this.persistence=e,this.si=new Hn(n=>Ds(n),il),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.oi=0,this._i=new Cm,this.targetCount=0,this.ai=Ms.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),N.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ms(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,N.resolve()}updateTargetData(e,n){return this.Pr(n),N.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),N.waitFor(i).next(()=>s)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return N.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),N.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),N.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),N.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return N.resolve(r)}containsKey(e,n){return N.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,n){this.ui={},this.overlays={},this.ci=new Ut(0),this.li=!1,this.li=!0,this.hi=new Ab,this.referenceDelegate=e(this),this.Pi=new Cb(this),this.indexManager=new pb,this.remoteDocumentCache=function(s){return new Pb(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new JT(n),this.Ii=new xb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Sb,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Rb(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){F("MemoryPersistence","Starting transaction:",e);const s=new Nb(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return N.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Nb extends QI{constructor(e){super(),this.currentSequenceNumber=e}}class dh{constructor(e){this.persistence=e,this.Ri=new Cm,this.Vi=null}static mi(e){return new dh(e)}get fi(){if(this.Vi)return this.Vi;throw Q(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),N.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),N.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.fi,r=>{const s=q.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,X.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return N.or([()=>N.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class wc{constructor(e,n){this.persistence=e,this.pi=new Hn(r=>at(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=lx(this,n)}static mi(e,n){return new wc(e,n)}Ei(){}di(e){return N.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return N.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?N.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,X.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),N.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),N.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),N.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Iu(e.data.value)),n}br(e,n,r){return N.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return N.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Jc("createOrUpgrade",n);r<1&&s>=1&&(function(u){u.createObjectStore(sl)}(e),function(u){u.createObjectStore(Oa,{keyPath:B2}),u.createObjectStore(Jt,{keyPath:tv,autoIncrement:!0}).createIndex(ds,nv,{unique:!0}),u.createObjectStore(Ui)}(e),Kv(e),function(u){u.createObjectStore(ss)}(e));let o=N.resolve();return r<3&&s>=3&&(r!==0&&(function(u){u.deleteObjectStore(Bi),u.deleteObjectStore(zi),u.deleteObjectStore(gs)}(e),Kv(e)),o=o.next(()=>function(u){const c=u.store(gs),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return c.put(cc,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store(Jt).J().next(m=>{u.deleteObjectStore(Jt),u.createObjectStore(Jt,{keyPath:tv,autoIncrement:!0}).createIndex(ds,nv,{unique:!0});const g=c.store(Jt),I=m.map(x=>g.put(x));return N.waitFor(I)})}(e,i))),o=o.next(()=>{(function(u){u.createObjectStore($i,{keyPath:X2})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(u){u.createObjectStore(Ma)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(eh,{keyPath:J2})})(e),function(u){u.createObjectStore(th,{keyPath:Z2})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore(nh,{keyPath:oN});c.createIndex(Lf,aN,{unique:!1}),c.createIndex(nT,lN,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore(uc,{keyPath:q2});c.createIndex(wu,K2),c.createIndex(JI,W2)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(ss))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(u){u.createObjectStore(mm,{keyPath:eN,autoIncrement:!0}).createIndex(Mf,tN,{unique:!1}),u.createObjectStore(oa,{keyPath:nN}).createIndex(eT,rN,{unique:!1}),u.createObjectStore(aa,{keyPath:sN}).createIndex(tT,iN,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(oa).clear()}).next(()=>{n.objectStore(aa).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(gm,{keyPath:uN})})(e)})),r<18&&s>=18&&QE()&&(o=o.next(()=>{n.objectStore(oa).clear()}).next(()=>{n.objectStore(aa).clear()})),o}wi(e){let n=0;return e.store(ss).ee((r,s)=>{n+=vc(s)}).next(()=>{const r={byteSize:n};return e.store(Ma).put(Of,r)})}yi(e){const n=e.store(Oa),r=e.store(Jt);return n.J().next(s=>N.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,ms],[i.userId,i.lastAcknowledgedBatchId]);return r.J(ds,o).next(a=>N.forEach(a,u=>{Y(u.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const c=os(this.serializer,u);return sx(e,i.userId,c).next(()=>{})}))}))}Si(e){const n=e.store(Bi),r=e.store(ss);return e.store(gs).get(cc).next(s=>{const i=[];return r.ee((o,a)=>{const u=new ue(o),c=function(m){return[0,at(m)]}(u);i.push(n.get(c).next(d=>d?N.resolve():(m=>n.put({targetId:0,path:at(m),sequenceNumber:s.highestListenSequenceNumber}))(u)))}).next(()=>N.waitFor(i))})}bi(e,n){e.createObjectStore(La,{keyPath:Y2});const r=n.store(La),s=new km,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:at(u)})}};return n.store(ss).ee({X:!0},(o,a)=>{const u=new ue(o);return i(u.popLast())}).next(()=>n.store(Ui).ee({X:!0},([o,a,u],c)=>{const d=pn(a);return i(d.popLast())}))}Di(e){const n=e.store(zi);return n.ee((r,s)=>{const i=qo(s),o=ZT(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(ss),s=[];return r.ee((i,o)=>{const a=n.store(uc),u=function(m){return m.document?new q(ue.fromString(m.document.name).popFirst(5)):m.noDocument?q.fromSegments(m.noDocument.path):m.unknownDocument?q.fromSegments(m.unknownDocument.path):Q(36783)}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>N.waitFor(s))}Fi(e,n){const r=n.store(Jt),s=cx(this.serializer),i=new Nm(dh.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(u=>{let c=a.get(u.userId)??re();os(this.serializer,u).keys().forEach(d=>c=c.add(d)),a.set(u.userId,c)}),N.forEach(a,(u,c)=>{const d=new Ye(c),m=ch.wt(this.serializer,d),g=i.getIndexManager(d),I=hh.wt(d,this.serializer,g,i.referenceDelegate);return new hx(s,I,m,g).recalculateAndSaveOverlaysForDocumentKeys(new jf(n,Ut.ce),u).next()})})}}function Kv(t){t.createObjectStore(Bi,{keyPath:G2}).createIndex(pm,Q2,{unique:!0}),t.createObjectStore(zi,{keyPath:"targetId"}).createIndex(ZI,H2,{unique:!0}),t.createObjectStore(gs)}const ir="IndexedDbPersistence",Td=18e5,xd=5e3,Sd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Db="main";class bm{constructor(e,n,r,s,i,o,a,u,c,d,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=c,this.Oi=d,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!bm.v())throw new B(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wb(this,s),this.$i=n+Db,this.serializer=new JT(u),this.Ui=new kr(this.$i,this.Ni,new bb(this.serializer)),this.hi=new lb,this.Pi=new gb(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cx(this.serializer),this.Ii=new ab,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&dt(ir,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new B(M.FAILED_PRECONDITION,Sd);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Ut(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Xl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(qr(e))return F(ir,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return F(ir,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Vo(e).get(Xs).next(n=>N.resolve(this.es(n)))}ts(e){return Xl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Td)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ze(n,$i);return r.J().next(s=>{const i=this.ss(s,Td),o=s.filter(a=>i.indexOf(a)===-1);return N.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?N.resolve(!0):Vo(e).get(Xs).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,xd)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new B(M.FAILED_PRECONDITION,Sd);return!1}}return!(!this.networkEnabled||!this.inForeground)||Xl(e).J().next(r=>this.ss(r,xd).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&F(ir,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[sl,$i],e=>{const n=new jf(e,Ut.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Xl(e).J().next(n=>this.ss(n,Td).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return hh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mb(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ch.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){F(ir,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(u){return u===18?dN:u===17?oT:u===16?hN:u===15?ym:u===14?iT:u===13?sT:u===12?cN:u===11?rT:void Q(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new jf(a,this.ci?this.ci.next():Ut.ce),n==="readwrite-primary"?this.Hi(o).next(u=>!!u||this.Yi(o)).next(u=>{if(!u)throw dt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new B(M.FAILED_PRECONDITION,GI);return r(o)}).next(u=>this.Xi(o).next(()=>u)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Vo(e).get(Xs).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,xd)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new B(M.FAILED_PRECONDITION,Sd)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vo(e).put(Xs,n)}static v(){return kr.v()}Zi(e){const n=Vo(e);return n.get(Xs).next(r=>this.es(r)?(F(ir,"Releasing primary lease."),n.delete(Xs)):N.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(dt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;GE()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return F(ir,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dt(ir,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){dt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vo(t){return ze(t,sl)}function Xl(t){return ze(t,$i)}function Vb(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=re(),s=re();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Dm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return GE()?8:YI(Ue())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Ob;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(ri()<=ie.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",si(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),N.resolve()):(ri()<=ie.DEBUG&&F("QueryEngine","Query:",si(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ri()<=ie.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",si(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qt(n))):N.resolve())}ys(e,n){if(mv(n))return N.resolve(null);let r=qt(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Kf(n,null,"F"),r=qt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=re(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.Ds(n,a);return this.Cs(n,c,o,u.readTime)?this.ys(e,Kf(n,null,"F")):this.vs(e,c,n,u)}))})))}ws(e,n,r,s){return mv(n)||s.isEqual(X.min())?N.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?N.resolve(null):(ri()<=ie.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),si(n)),this.vs(e,o,n,O2(s,ba)).next(a=>a))})}Ds(e,n){let r=new fe(AT(e));return n.forEach((s,i)=>{ll(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return ri()<=ie.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",si(n)),this.ps.getDocumentsMatchingQuery(e,n,bt.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="LocalStore",Mb=3e8;class Lb{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Ie(ee),this.xs=new Hn(i=>Ds(i),il),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hx(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function fx(t,e,n,r){return new Lb(t,e,n,r)}async function px(t,e){const n=te(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=re();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function jb(t,e){const n=te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,u,c,d){const m=c.batch,g=m.keys();let I=N.resolve();return g.forEach(x=>{I=I.next(()=>d.getEntry(u,x)).next(k=>{const C=c.docVersions.get(x);Y(C!==null,48541),k.version.compareTo(C)<0&&(m.applyToRemoteDocument(k,c),k.isValidDocument()&&(k.setReadTime(c.commitVersion),d.addEntry(k)))})}),I.next(()=>a.mutationQueue.removeMutationBatch(u,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=re();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function mx(t){const e=te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Fb(t,e){const n=te(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((d,m)=>{const g=s.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,m)));let I=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?I=I.withResumeToken(Oe.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):d.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(d.resumeToken,r)),s=s.insert(m,I),function(k,C,w){return k.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=Mb?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(g,I,d)&&a.push(n.Pi.updateTargetData(i,I))});let u=kt(),c=re();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(Ub(i,o,e.documentUpdates).next(d=>{u=d.ks,c=d.qs})),!r.isEqual(X.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return N.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.Ms=s,i))}function Ub(t,e,n){let r=re(),s=re();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=kt();return n.forEach((a,u)=>{const c=i.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(X.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):F(Vm,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{ks:o,qs:s}})}function zb(t,e){const n=te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ms),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Bb(t,e){const n=te(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,N.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Vn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Zf(t,e,n){const r=te(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!qr(o))throw o;F(Vm,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Wv(t,e,n){const r=te(t);let s=X.min(),i=re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const m=te(u),g=m.xs.get(d);return g!==void 0?N.resolve(m.Ms.get(g)):m.Pi.getTargetData(c,d)}(r,o,qt(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:X.min(),n?i:re())).next(a=>($b(r,RN(e),a),{documents:a,Qs:i})))}function $b(t,e,n){let r=t.Os.get(e)||X.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class Hv{constructor(){this.activeTargetIds=DN()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gx{constructor(){this.Mo=new Hv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Hv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="ConnectivityMonitor";class Qv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){F(Gv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){F(Gv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jl=null;function ep(){return Jl===null?Jl=function(){return 268435456+Math.round(2147483648*Math.random())}():Jl++,"0x"+Jl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad="RestConnection",Kb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Wb{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===hc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=ep(),a=this.zo(e,n.toUriEncodedString());F(Ad,`Sending RPC '${e}' ${o}:`,a,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:c}=new URL(a),d=Us(c);return this.Jo(e,a,u,r,d).then(m=>(F(Ad,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ns(Ad,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+no}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=Kb[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="WebChannelConnection";class Gb extends Wb{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=ep();return new Promise((a,u)=>{const c=new LI;c.setWithCredentials(!0),c.listenOnce(jI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case yu.NO_ERROR:const m=c.getResponseJson();F(st,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case yu.TIMEOUT:F(st,`RPC '${e}' ${o} timed out`),u(new B(M.DEADLINE_EXCEEDED,"Request time out"));break;case yu.HTTP_ERROR:const g=c.getStatus();if(F(st,`RPC '${e}' ${o} failed with status:`,g,"response text:",c.getResponseText()),g>0){let I=c.getResponseJson();Array.isArray(I)&&(I=I[0]);const x=I==null?void 0:I.error;if(x&&x.status&&x.message){const k=function(w){const _=w.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(_)>=0?_:M.UNKNOWN}(x.status);u(new B(k,x.message))}else u(new B(M.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new B(M.UNAVAILABLE,"Connection failed."));break;default:Q(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{F(st,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);F(st,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",d,r,15)})}T_(e,n,r){const s=ep(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=zI(),a=UI(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=i.join("");F(st,`Creating RPC '${e}' stream ${s}: ${d}`,u);const m=o.createWebChannel(d,u);this.I_(m);let g=!1,I=!1;const x=new Hb({Yo:C=>{I?F(st,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(g||(F(st,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),F(st,`RPC '${e}' stream ${s} sending:`,C),m.send(C))},Zo:()=>m.close()}),k=(C,w,_)=>{C.listen(w,E=>{try{_(E)}catch(V){setTimeout(()=>{throw V},0)}})};return k(m,zo.EventType.OPEN,()=>{I||(F(st,`RPC '${e}' stream ${s} transport opened.`),x.o_())}),k(m,zo.EventType.CLOSE,()=>{I||(I=!0,F(st,`RPC '${e}' stream ${s} transport closed`),x.a_(),this.E_(m))}),k(m,zo.EventType.ERROR,C=>{I||(I=!0,Ns(st,`RPC '${e}' stream ${s} transport errored. Name:`,C.name,"Message:",C.message),x.a_(new B(M.UNAVAILABLE,"The operation could not be completed")))}),k(m,zo.EventType.MESSAGE,C=>{var w;if(!I){const _=C.data[0];Y(!!_,16349);const E=_,V=(E==null?void 0:E.error)||((w=E[0])==null?void 0:w.error);if(V){F(st,`RPC '${e}' stream ${s} received error:`,V);const L=V.status;let j=function(S){const R=be[S];if(R!==void 0)return jT(R)}(L),T=V.message;j===void 0&&(j=M.INTERNAL,T="Unknown error status: "+L+" with message "+V.message),I=!0,x.a_(new B(j,T)),m.close()}else F(st,`RPC '${e}' stream ${s} received:`,_),x.u_(_)}}),k(a,FI.STAT_EVENT,C=>{C.stat===bf.PROXY?F(st,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===bf.NOPROXY&&F(st,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(){return typeof window<"u"?window:null}function Ru(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fh(t){return new YN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&F("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv="PersistentStream";class _x{constructor(e,n,r,s,i,o,a,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new yx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===M.RESOURCE_EXHAUSTED?(dt(n.toString()),dt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new B(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return F(Yv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(F(Yv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Yb extends _x{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=ZN(this.serializer,e),r=function(i){if(!("targetChange"in i))return X.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?X.min():o.readTime?pt(o.readTime):X.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Gf(this.serializer),n.addTarget=function(i,o){let a;const u=o.target;if(a=fc(u)?{documents:WT(i,u)}:{query:HT(i,u).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zT(i,o.resumeToken);const c=Wf(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(X.min())>0){a.readTime=Yi(i,o.snapshotVersion.toTimestamp());const c=Wf(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=tb(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Gf(this.serializer),n.removeTarget=e,this.q_(n)}}class Xb extends _x{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Y(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Y(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=eb(e.writeResults,e.commitTime),r=pt(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Gf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gc(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{}class Zb extends Jb{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new B(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Hf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new B(M.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Hf(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new B(M.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class eD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(dt(n),this.aa=!1):F("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="RemoteStore";class tD{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ks(this)&&(F(Ls,"Restarting streams for network reachability change."),await async function(u){const c=te(u);c.Ea.add(4),await cl(c),c.Ra.set("Unknown"),c.Ea.delete(4),await ph(c)}(this))})}),this.Ra=new eD(r,s)}}async function ph(t){if(Ks(t))for(const e of t.da)await e(!0)}async function cl(t){for(const e of t.da)await e(!1)}function vx(t,e){const n=te(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),jm(n)?Lm(n):so(n).O_()&&Mm(n,e))}function Om(t,e){const n=te(t),r=so(n);n.Ia.delete(e),r.O_()&&wx(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ks(n)&&n.Ra.set("Unknown"))}function Mm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}so(t).Y_(e)}function wx(t,e){t.Va.Ue(e),so(t).Z_(e)}function Lm(t){t.Va=new WN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),so(t).start(),t.Ra.ua()}function jm(t){return Ks(t)&&!so(t).x_()&&t.Ia.size>0}function Ks(t){return te(t).Ea.size===0}function Ex(t){t.Va=void 0}async function nD(t){t.Ra.set("Online")}async function rD(t){t.Ia.forEach((e,n)=>{Mm(t,e)})}async function sD(t,e){Ex(t),jm(t)?(t.Ra.ha(e),Lm(t)):t.Ra.set("Unknown")}async function iD(t,e,n){if(t.Ra.set("Online"),e instanceof UT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){F(Ls,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ec(t,r)}else if(e instanceof Su?t.Va.Ze(e):e instanceof FT?t.Va.st(e):t.Va.tt(e),!n.isEqual(X.min()))try{const r=await mx(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(c);d&&i.Ia.set(c,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(Oe.EMPTY_BYTE_STRING,d.snapshotVersion)),wx(i,u);const m=new Vn(d.target,u,c,d.sequenceNumber);Mm(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){F(Ls,"Failed to raise snapshot:",r),await Ec(t,r)}}async function Ec(t,e,n){if(!qr(e))throw e;t.Ea.add(1),await cl(t),t.Ra.set("Offline"),n||(n=()=>mx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{F(Ls,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ph(t)})}function Ix(t,e){return e().catch(n=>Ec(t,n,e))}async function hl(t){const e=te(t),n=Lr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ms;for(;oD(e);)try{const s=await zb(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,aD(e,s)}catch(s){await Ec(e,s)}Tx(e)&&xx(e)}function oD(t){return Ks(t)&&t.Ta.length<10}function aD(t,e){t.Ta.push(e);const n=Lr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Tx(t){return Ks(t)&&!Lr(t).x_()&&t.Ta.length>0}function xx(t){Lr(t).start()}async function lD(t){Lr(t).ra()}async function uD(t){const e=Lr(t);for(const n of t.Ta)e.ea(n.mutations)}async function cD(t,e,n){const r=t.Ta.shift(),s=xm.from(r,e,n);await Ix(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await hl(t)}async function hD(t,e){e&&Lr(t).X_&&await async function(r,s){if(function(o){return $N(o)&&o!==M.ABORTED}(s.code)){const i=r.Ta.shift();Lr(r).B_(),await Ix(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await hl(r)}}(t,e),Tx(t)&&xx(t)}async function Xv(t,e){const n=te(t);n.asyncQueue.verifyOperationInProgress(),F(Ls,"RemoteStore received new credentials");const r=Ks(n);n.Ea.add(3),await cl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ph(n)}async function dD(t,e){const n=te(t);e?(n.Ea.delete(2),await ph(n)):e||(n.Ea.add(2),await cl(n),n.Ra.set("Unknown"))}function so(t){return t.ma||(t.ma=function(n,r,s){const i=te(n);return i.sa(),new Yb(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:nD.bind(null,t),t_:rD.bind(null,t),r_:sD.bind(null,t),H_:iD.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),jm(t)?Lm(t):t.Ra.set("Unknown")):(await t.ma.stop(),Ex(t))})),t.ma}function Lr(t){return t.fa||(t.fa=function(n,r,s){const i=te(n);return i.sa(),new Xb(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:lD.bind(null,t),r_:hD.bind(null,t),ta:uD.bind(null,t),na:cD.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await hl(t)):(await t.fa.stop(),t.Ta.length>0&&(F(Ls,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new En,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Fm(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new B(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Um(t,e){if(dt("AsyncQueue",`${e}: ${t}`),qr(t))return new B(M.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{static emptySet(e){return new Ci(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||q.comparator(n.key,r.key):(n,r)=>q.comparator(n.key,r.key),this.keyedMap=Bo(),this.sortedSet=new Ie(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ci)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ci;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(){this.ga=new Ie(q.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Q(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Xi{constructor(e,n,r,s,i,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Xi(e,n,Ci.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ih(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class pD{constructor(){this.queries=Zv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=te(n),i=s.queries;s.queries=Zv(),i.forEach((o,a)=>{for(const u of a.Sa)u.onError(r)})})(this,new B(M.ABORTED,"Firestore shutting down"))}}function Zv(){return new Hn(t=>ST(t),ih)}async function zm(t,e){const n=te(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new fD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Um(o,`Initialization of query '${si(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&$m(n)}async function Bm(t,e){const n=te(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function mD(t,e){const n=te(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&$m(n)}function gD(t,e,n){const r=te(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function $m(t){t.Ca.forEach(e=>{e.next()})}var tp,e0;(e0=tp||(tp={})).Ma="default",e0.Cache="cache";class qm{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Xi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Xi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.key=e}}class Ax{constructor(e){this.key=e}}class yD{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=re(),this.mutatedKeys=re(),this.eu=AT(e),this.tu=new Ci(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Jv,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const g=s.get(d),I=ll(this.query,m)?m:null,x=!!g&&this.mutatedKeys.has(g.key),k=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let C=!1;g&&I?g.data.isEqual(I.data)?x!==k&&(r.track({type:3,doc:I}),C=!0):this.su(g,I)||(r.track({type:2,doc:I}),C=!0,(u&&this.eu(I,u)>0||c&&this.eu(I,c)<0)&&(a=!0)):!g&&I?(r.track({type:0,doc:I}),C=!0):g&&!I&&(r.track({type:1,doc:g}),C=!0,(u||c)&&(a=!0)),C&&(I?(o=o.add(I),i=k?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,m)=>function(I,x){const k=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q(20277,{Rt:C})}};return k(I)-k(x)}(d.type,m.type)||this.eu(d.doc,m.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,c=u!==this.Za;return this.Za=u,o.length!==0||c?{snapshot:new Xi(this.query,e.tu,i,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Jv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=re(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Ax(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Sx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=re();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Xi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Km="SyncEngine";class _D{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class vD{constructor(e){this.key=e,this.hu=!1}}class wD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Hn(a=>ST(a),ih),this.Iu=new Map,this.Eu=new Set,this.du=new Ie(q.comparator),this.Au=new Map,this.Ru=new Cm,this.Vu={},this.mu=new Map,this.fu=Ms.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ED(t,e,n=!0){const r=bx(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Rx(r,e,n,!0),s}async function ID(t,e){const n=bx(t);await Rx(n,e,!0,!1)}async function Rx(t,e,n,r){const s=await Bb(t.localStore,qt(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await TD(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&vx(t.remoteStore,s),a}async function TD(t,e,n,r,s){t.pu=(m,g,I)=>async function(k,C,w,_){let E=C.view.ru(w);E.Cs&&(E=await Wv(k.localStore,C.query,!1).then(({documents:T})=>C.view.ru(T,E)));const V=_&&_.targetChanges.get(C.targetId),L=_&&_.targetMismatches.get(C.targetId)!=null,j=C.view.applyChanges(E,k.isPrimaryClient,V,L);return n0(k,C.targetId,j.au),j.snapshot}(t,m,g,I);const i=await Wv(t.localStore,e,!0),o=new yD(e,i.Qs),a=o.ru(i.documents),u=ul.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,u);n0(t,n,c.au);const d=new _D(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function xD(t,e,n){const r=te(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!ih(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Zf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Om(r.remoteStore,s.targetId),np(r,s.targetId)}).catch($s)):(np(r,s.targetId),await Zf(r.localStore,s.targetId,!0))}async function SD(t,e){const n=te(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Om(n.remoteStore,r.targetId))}async function AD(t,e,n){const r=Dx(t);try{const s=await function(o,a){const u=te(o),c=ce.now(),d=a.reduce((I,x)=>I.add(x.key),re());let m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let x=kt(),k=re();return u.Ns.getEntries(I,d).next(C=>{x=C,x.forEach((w,_)=>{_.isValidDocument()||(k=k.add(w))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,x)).next(C=>{m=C;const w=[];for(const _ of a){const E=zN(_,m.get(_.key).overlayedDocument);E!=null&&w.push(new Kr(_.key,E,gT(E.value.mapValue),wt.exists(!0)))}return u.mutationQueue.addMutationBatch(I,c,w,a)}).next(C=>{g=C;const w=C.applyToLocalDocumentSet(m,k);return u.documentOverlayCache.saveOverlays(I,C.batchId,w)})}).then(()=>({batchId:g.batchId,changes:PT(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let c=o.Vu[o.currentUser.toKey()];c||(c=new Ie(ee)),c=c.insert(a,u),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,n),await dl(r,s.changes),await hl(r.remoteStore)}catch(s){const i=Um(s,"Failed to persist write");n.reject(i)}}async function Px(t,e){const n=te(t);try{const r=await Fb(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Y(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Y(o.hu,14607):s.removedDocuments.size>0&&(Y(o.hu,42227),o.hu=!1))}),await dl(n,r,e)}catch(r){await $s(r)}}function t0(t,e,n){const r=te(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=te(o);u.onlineState=a;let c=!1;u.queries.forEach((d,m)=>{for(const g of m.Sa)g.va(a)&&(c=!0)}),c&&$m(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RD(t,e,n){const r=te(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Ie(q.comparator);o=o.insert(i,ke.newNoDocument(i,X.min()));const a=re().add(i),u=new uh(X.min(),new Map,new Ie(ee),o,a);await Px(r,u),r.du=r.du.remove(i),r.Au.delete(e),Wm(r)}else await Zf(r.localStore,e,!1).then(()=>np(r,e,n)).catch($s)}async function PD(t,e){const n=te(t),r=e.batch.batchId;try{const s=await jb(n.localStore,e);Cx(n,r,null),kx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await dl(n,s)}catch(s){await $s(s)}}async function kD(t,e,n){const r=te(t);try{const s=await function(o,a){const u=te(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,a).next(m=>(Y(m!==null,37113),d=m.keys(),u.mutationQueue.removeMutationBatch(c,m))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);Cx(r,e,n),kx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await dl(r,s)}catch(s){await $s(s)}}function kx(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Cx(t,e,n){const r=te(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function np(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||Nx(t,r)})}function Nx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Om(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Wm(t))}function n0(t,e,n){for(const r of n)r instanceof Sx?(t.Ru.addReference(r.key,e),CD(t,r)):r instanceof Ax?(F(Km,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Nx(t,r.key)):Q(19791,{wu:r})}function CD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(F(Km,"New document in limbo: "+n),t.Eu.add(r),Wm(t))}function Wm(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new q(ue.fromString(e)),r=t.fu.next();t.Au.set(r,new vD(n)),t.du=t.du.insert(n,r),vx(t.remoteStore,new Vn(qt(al(n.path)),r,"TargetPurposeLimboResolution",Ut.ce))}}async function dl(t,e,n){const r=te(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,u)=>{o.push(r.pu(u,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const m=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(c){s.push(c);const m=Dm.As(u.targetId,c);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,c){const d=te(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>N.forEach(c,g=>N.forEach(g.Es,I=>d.persistence.referenceDelegate.addReference(m,g.targetId,I)).next(()=>N.forEach(g.ds,I=>d.persistence.referenceDelegate.removeReference(m,g.targetId,I)))))}catch(m){if(!qr(m))throw m;F(Vm,"Failed to update sequence numbers: "+m)}for(const m of c){const g=m.targetId;if(!m.fromCache){const I=d.Ms.get(g),x=I.snapshotVersion,k=I.withLastLimboFreeSnapshotVersion(x);d.Ms=d.Ms.insert(g,k)}}}(r.localStore,i))}async function ND(t,e){const n=te(t);if(!n.currentUser.isEqual(e)){F(Km,"User change. New user:",e.toKey());const r=await px(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(u=>{u.reject(new B(M.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await dl(n,r.Ls)}}function bD(t,e){const n=te(t),r=n.Au.get(e);if(r&&r.hu)return re().add(r.key);{let s=re();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function bx(t){const e=te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Px.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RD.bind(null,e),e.Pu.H_=mD.bind(null,e.eventManager),e.Pu.yu=gD.bind(null,e.eventManager),e}function Dx(t){const e=te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=PD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kD.bind(null,e),e}class qa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return fx(this.persistence,new dx,e.initialUser,this.serializer)}Cu(e){return new Nm(dh.mi,this.serializer)}Du(e){return new gx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qa.provider={build:()=>new qa};class DD extends qa{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Y(this.persistence.referenceDelegate instanceof wc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ax(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?it.withCacheSize(this.cacheSizeBytes):it.DEFAULT;return new Nm(r=>wc.mi(r,n),this.serializer)}}class VD extends qa{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Dx(this.xu.syncEngine),await hl(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return fx(this.persistence,new dx,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ax(r,e.asyncQueue,n)}Mu(e,n){const r=new F2(n,this.persistence);return new j2(e.asyncQueue,r)}Cu(e){const n=Vb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?it.withCacheSize(this.cacheSizeBytes):it.DEFAULT;return new bm(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Qb(),Ru(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new gx}}class Ic{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>t0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ND.bind(null,this.syncEngine),await dD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new pD}()}createDatastore(e){const n=fh(e.databaseInfo.databaseId),r=function(i){return new Gb(i)}(e.databaseInfo);return function(i,o,a,u){return new Zb(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new tD(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>t0(this.syncEngine,n,0),function(){return Qv.v()?new Qv:new qb}())}createSyncEngine(e,n){return function(s,i,o,a,u,c,d){const m=new wD(s,i,o,a,u,c);return d&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=te(s);F(Ls,"RemoteStore shutting down."),i.Ea.add(5),await cl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Ic.provider={build:()=>new Ic};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):dt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr="FirestoreClient";class OD{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ye.UNAUTHENTICATED,this.clientId=hm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{F(jr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(F(jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new En;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Um(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rd(t,e){t.asyncQueue.verifyOperationInProgress(),F(jr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await px(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function r0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await MD(t);F(jr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Xv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Xv(e.remoteStore,s)),t._onlineComponents=e}async function MD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){F(jr,"Using user provided OfflineComponentProvider");try{await Rd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===M.FAILED_PRECONDITION||s.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ns("Error using user provided cache. Falling back to memory cache: "+n),await Rd(t,new qa)}}else F(jr,"Using default OfflineComponentProvider"),await Rd(t,new DD(void 0));return t._offlineComponents}async function Vx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(F(jr,"Using user provided OnlineComponentProvider"),await r0(t,t._uninitializedComponentsProvider._online)):(F(jr,"Using default OnlineComponentProvider"),await r0(t,new Ic))),t._onlineComponents}function LD(t){return Vx(t).then(e=>e.syncEngine)}async function Tc(t){const e=await Vx(t),n=e.eventManager;return n.onListen=ED.bind(null,e.syncEngine),n.onUnlisten=xD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ID.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=SD.bind(null,e.syncEngine),n}function jD(t,e,n={}){const r=new En;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new Hm({next:g=>{d.Nu(),o.enqueueAndForget(()=>Bm(i,m));const I=g.docs.has(a);!I&&g.fromCache?c.reject(new B(M.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&g.fromCache&&u&&u.source==="server"?c.reject(new B(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(g)},error:g=>c.reject(g)}),m=new qm(al(a.path),d,{includeMetadataChanges:!0,qa:!0});return zm(i,m)}(await Tc(t),t.asyncQueue,e,n,r)),r.promise}function FD(t,e,n={}){const r=new En;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,c){const d=new Hm({next:g=>{d.Nu(),o.enqueueAndForget(()=>Bm(i,m)),g.fromCache&&u.source==="server"?c.reject(new B(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),m=new qm(a,d,{includeMetadataChanges:!0,qa:!0});return zm(i,m)}(await Tc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="firestore.googleapis.com",i0=!0;class o0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new B(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Mx,this.ssl=i0}else this.host=e.host,this.ssl=e.ssl??i0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yb)throw new B(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}V2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ox(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new B(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new B(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new B(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new o0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new B(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new B(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new o0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new x2;switch(r.type){case"firstParty":return new P2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new B(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=s0.get(n);r&&(F("ComponentProvider","Removing Datastore"),s0.delete(n),r.terminate())}(this),Promise.resolve()}}function UD(t,e,n,r={}){var c;t=$t(t,mh);const s=Us(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(Xp(`https://${a}`),Jp("Firestore",!0)),i.host!==Mx&&i.host!==a&&Ns("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:a,ssl:s,emulatorOptions:r};if(!As(u,o)&&(t._setSettings(u),r.mockUserToken)){let d,m;if(typeof r.mockUserToken=="string")d=r.mockUserToken,m=Ye.MOCK_USER;else{d=WE(r.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new B(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Ye(g)}t._authCredentials=new S2(new $I(d,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ws(this.firestore,e,this._query)}}class Ne{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ne(this.firestore,e,this._key)}toJSON(){return{type:Ne._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(rl(n,Ne._jsonSchema))return new Ne(e,r||null,new q(ue.fromString(n.referencePath)))}}Ne._jsonSchemaVersion="firestore/documentReference/1.0",Ne._jsonSchema={type:Ve("string",Ne._jsonSchemaVersion),referencePath:Ve("string")};class Cr extends Ws{constructor(e,n,r){super(e,n,al(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new q(e))}withConverter(e){return new Cr(this.firestore,e,this._path)}}function fl(t,e,...n){if(t=We(t),KI("collection","path",e),t instanceof mh){const r=ue.fromString(e,...n);return Y_(r),new Cr(t,null,r)}{if(!(t instanceof Ne||t instanceof Cr))throw new B(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ue.fromString(e,...n));return Y_(r),new Cr(t.firestore,null,r)}}function an(t,e,...n){if(t=We(t),arguments.length===1&&(e=hm.newId()),KI("doc","path",e),t instanceof mh){const r=ue.fromString(e,...n);return Q_(r),new Ne(t,null,new q(r))}{if(!(t instanceof Ne||t instanceof Cr))throw new B(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ue.fromString(e,...n));return Q_(r),new Ne(t.firestore,t instanceof Cr?t.converter:null,new q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0="AsyncQueue";class l0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new yx(this,"async_queue_retry"),this._c=()=>{const r=Ru();r&&F(a0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Ru();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ru();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new En;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qr(e))throw e;F(a0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,dt("INTERNAL UNHANDLED ERROR: ",u0(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Fm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Q(47125,{Pc:u0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function u0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Fr extends mh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new l0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new l0(e),this._firestoreClient=void 0,await e}}}function zD(t,e){const n=typeof t=="object"?t:tm(),r=typeof t=="string"?t:hc,s=Hc(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=$E("firestore");i&&UD(s,...i)}return s}function gh(t){if(t._terminated)throw new B(M.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Lx(t),t._firestoreClient}function Lx(t){var r,s,i;const e=t._freezeSettings(),n=function(a,u,c,d){return new pN(a,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Ox(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new OD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(t._componentsProvider))}function BD(t,e){Ns("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return $D(t,Ic.provider,{build:r=>new VD(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function $D(t,e,n){if((t=$t(t,Fr))._firestoreClient||t._terminated)throw new B(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new B(M.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Lx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jt(Oe.fromBase64String(e))}catch(n){throw new B(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new jt(Oe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rl(e,jt._jsonSchema))return jt.fromBase64String(e.bytes)}}jt._jsonSchemaVersion="firestore/bytes/1.0",jt._jsonSchema={type:Ve("string",jt._jsonSchemaVersion),bytes:Ve("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new B(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new B(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new B(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:In._jsonSchemaVersion}}static fromJSON(e){if(rl(e,In._jsonSchema))return new In(e.latitude,e.longitude)}}In._jsonSchemaVersion="firestore/geoPoint/1.0",In._jsonSchema={type:Ve("string",In._jsonSchemaVersion),latitude:Ve("number"),longitude:Ve("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Tn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rl(e,Tn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Tn(e.vectorValues);throw new B(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tn._jsonSchemaVersion="firestore/vectorValue/1.0",Tn._jsonSchema={type:Ve("string",Tn._jsonSchemaVersion),vectorValues:Ve("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD=/^__.*__$/;class KD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Kr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ro(e,this.data,n,this.fieldTransforms)}}function Fx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q(40011,{Ac:t})}}class Qm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return xc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Fx(this.Ac)&&qD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class WD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||fh(e)}Cc(e,n,r,s=!1){return new Qm({Ac:e,methodName:n,Dc:r,path:xe.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ux(t){const e=t._freezeSettings(),n=fh(t._databaseId);return new WD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function HD(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);$x("Data must be an object, but it was:",o,r);const a=zx(r,o);let u,c;if(i.merge)u=new zt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=QD(e,m,n);if(!o.contains(g))throw new B(M.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);XD(d,g)||d.push(g)}u=new zt(d),c=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,c=o.fieldTransforms;return new KD(new _t(a),u,c)}function GD(t,e,n,r=!1){return Ym(n,t.Cc(r?4:3,e))}function Ym(t,e){if(Bx(t=We(t)))return $x("Unsupported field value:",e,t),zx(t,e);if(t instanceof jx)return function(r,s){if(!Fx(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let u=Ym(a,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=We(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VN(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ce.fromDate(r);return{timestampValue:Yi(s.serializer,i)}}if(r instanceof ce){const i=new ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Yi(s.serializer,i)}}if(r instanceof In)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof jt)return{bytesValue:zT(s.serializer,r._byteString)};if(r instanceof Ne){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Rm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Tn)return function(o,a){return{mapValue:{fields:{[vm]:{stringValue:wm},[qi]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return Im(a.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Xc(r)}`)}(t,e)}function zx(t,e){const n={};return aT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qs(t,(r,s)=>{const i=Ym(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Bx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ce||t instanceof In||t instanceof jt||t instanceof Ne||t instanceof jx||t instanceof Tn)}function $x(t,e,n){if(!Bx(n)||!WI(n)){const r=Xc(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function QD(t,e,n){if((e=We(e))instanceof Gm)return e._internalPath;if(typeof e=="string")return qx(t,e);throw xc("Field path arguments must be of type string or ",t,!1,void 0,n)}const YD=new RegExp("[~\\*/\\[\\]]");function qx(t,e,n){if(e.search(YD)>=0)throw xc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gm(...e.split("."))._internalPath}catch{throw xc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function xc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new B(M.INVALID_ARGUMENT,a+t+u)}function XD(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Xm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JD extends Kx{data(){return super.data()}}function Xm(t,e){return typeof e=="string"?qx(t,e):e instanceof Gm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new B(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jm{}class ZD extends Jm{}function Hx(t,e,...n){let r=[];e instanceof Jm&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Zm).length,a=i.filter(u=>u instanceof yh).length;if(o>1||o>0&&a>0)throw new B(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class yh extends ZD{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new yh(e,n,r)}_apply(e){const n=this._parse(e);return Gx(e._query,n),new Ws(e.firestore,e.converter,qf(e._query,n))}_parse(e){const n=Ux(e.firestore);return function(i,o,a,u,c,d,m){let g;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new B(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){d0(m,d);const x=[];for(const k of m)x.push(h0(u,i,k));g={arrayValue:{values:x}}}else g=h0(u,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||d0(m,d),g=GD(a,o,m,d==="in"||d==="not-in");return oe.create(c,d,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function eV(t,e,n){const r=e,s=Xm("where",t);return yh._create(s,r,n)}class Zm extends Jm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Zm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:he.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const u of a)Gx(o,u),o=qf(o,u)}(e._query,n),new Ws(e.firestore,e.converter,qf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function h0(t,e,n){if(typeof(n=We(n))=="string"){if(n==="")throw new B(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!xT(e)&&n.indexOf("/")!==-1)throw new B(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ue.fromString(n));if(!q.isDocumentKey(r))throw new B(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ua(t,new q(r))}if(n instanceof Ne)return Ua(t,n._key);throw new B(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xc(n)}.`)}function d0(t,e){if(!Array.isArray(t)||t.length===0)throw new B(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Gx(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new B(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new B(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class tV{convertValue(e,n="none"){switch(Or(e)){case 0:return null;case 1:return e.booleanValue;case 2:return we(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(qn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Q(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return qs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[qi].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>we(o.doubleValue));return new Tn(n)}convertGeoPoint(e){return new In(we(e.latitude),we(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=rh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ja(e));default:return null}}convertTimestamp(e){const n=$n(e);return new ce(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ue.fromString(e);Y(XT(r),9688,{name:e});const s=new bs(r.get(1),r.get(3)),i=new q(r.popFirst(5));return s.isEqual(n)||dt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nV(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Ko{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _s extends Kx{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Pu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Xm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new B(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=_s._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}_s._jsonSchemaVersion="firestore/documentSnapshot/1.0",_s._jsonSchema={type:Ve("string",_s._jsonSchemaVersion),bundleSource:Ve("string","DocumentSnapshot"),bundleName:Ve("string"),bundle:Ve("string")};class Pu extends _s{data(e={}){return super.data(e)}}class vs{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ko(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Pu(this._firestore,this._userDataWriter,r.key,r,new Ko(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new B(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const u=new Pu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ko(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const u=new Pu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ko(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:rV(a.type),doc:u,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new B(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=vs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rV(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _h(t){t=$t(t,Ne);const e=$t(t.firestore,Fr);return jD(gh(e),t._key).then(n=>Yx(e,t,n))}vs._jsonSchemaVersion="firestore/querySnapshot/1.0",vs._jsonSchema={type:Ve("string",vs._jsonSchemaVersion),bundleSource:Ve("string","QuerySnapshot"),bundleName:Ve("string"),bundle:Ve("string")};class eg extends tV{constructor(e){super(),this.firestore=e}convertBytes(e){return new jt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,n)}}function vh(t){t=$t(t,Ws);const e=$t(t.firestore,Fr),n=gh(e),r=new eg(e);return Wx(t._query),FD(n,t._query).then(s=>new vs(e,r,t,s))}function wh(t,e,n){t=$t(t,Ne);const r=$t(t.firestore,Fr),s=nV(t.converter,e);return Qx(r,[HD(Ux(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,wt.none())])}function Sc(t){return Qx($t(t.firestore,Fr),[new lh(t._key,wt.none())])}function sV(t,...e){var u,c,d;t=We(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||c0(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(c0(e[r])){const m=e[r];e[r]=(u=m.next)==null?void 0:u.bind(m),e[r+1]=(c=m.error)==null?void 0:c.bind(m),e[r+2]=(d=m.complete)==null?void 0:d.bind(m)}let i,o,a;if(t instanceof Ne)o=$t(t.firestore,Fr),a=al(t._key.path),i={next:m=>{e[r]&&e[r](Yx(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=$t(t,Ws);o=$t(m.firestore,Fr),a=m._query;const g=new eg(o);i={next:I=>{e[r]&&e[r](new vs(o,g,m,I))},error:e[r+1],complete:e[r+2]},Wx(t._query)}return function(g,I,x,k){const C=new Hm(k),w=new qm(I,C,x);return g.asyncQueue.enqueueAndForget(async()=>zm(await Tc(g),w)),()=>{C.Nu(),g.asyncQueue.enqueueAndForget(async()=>Bm(await Tc(g),w))}}(gh(o),a,s,i)}function Qx(t,e){return function(r,s){const i=new En;return r.asyncQueue.enqueueAndForget(async()=>AD(await LD(r),s,i)),i.promise}(gh(t),e)}function Yx(t,e,n){const r=n.docs.get(e._key),s=new eg(t);return new _s(t,s,e._key,r,new Ko(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){no=s})(zs),Rs(new Vr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Fr(new A2(r.getProvider("auth-internal")),new k2(o,r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new B(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bs(c.options.projectId,d)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),_n(K_,W_,e),_n(K_,W_,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx="firebasestorage.googleapis.com",iV="storageBucket",oV=2*60*1e3,aV=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn extends An{constructor(e,n,r=0){super(Pd(e),`Firebase Storage: ${n} (${Pd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sn||(Sn={}));function Pd(t){return"storage/"+t}function lV(){const t="An unknown error occurred, please check the error payload for server response.";return new Rn(Sn.UNKNOWN,t)}function uV(){return new Rn(Sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function cV(){return new Rn(Sn.CANCELED,"User canceled the upload/download.")}function hV(t){return new Rn(Sn.INVALID_URL,"Invalid URL '"+t+"'.")}function dV(t){return new Rn(Sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function f0(t){return new Rn(Sn.INVALID_ARGUMENT,t)}function Jx(){return new Rn(Sn.APP_DELETED,"The Firebase app was deleted.")}function fV(t){return new Rn(Sn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=tn.makeFromUrl(e,n)}catch{return new tn(e,"")}if(r.path==="")return r;throw dV(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function c(V){V.path_=decodeURIComponent(V.path)}const d="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",I=new RegExp(`^https?://${m}/${d}/b/${s}/o${g}`,"i"),x={bucket:1,path:3},k=n===Xx?"(?:storage.googleapis.com|storage.cloud.google.com)":n,C="([^?#]*)",w=new RegExp(`^https?://${k}/${s}/${C}`,"i"),E=[{regex:a,indices:u,postModify:i},{regex:I,indices:x,postModify:c},{regex:w,indices:{bucket:1,path:2},postModify:c}];for(let V=0;V<E.length;V++){const L=E[V],j=L.regex.exec(e);if(j){const T=j[L.indices.bucket];let v=j[L.indices.path];v||(v=""),r=new tn(T,v),L.postModify(r);break}}if(r==null)throw hV(e);return r}}class pV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function u(){return a===2}let c=!1;function d(...C){c||(c=!0,e.apply(null,C))}function m(C){s=setTimeout(()=>{s=null,t(I,u())},C)}function g(){i&&clearTimeout(i)}function I(C,...w){if(c){g();return}if(C){g(),d.call(null,C,...w);return}if(u()||o){g(),d.call(null,C,...w);return}r<64&&(r*=2);let E;a===1?(a=2,E=0):E=(r+Math.random())*1e3,m(E)}let x=!1;function k(C){x||(x=!0,g(),!c&&(s!==null?(C||(a=2),clearTimeout(s),m(0)):C||(a=1)))}return m(0),i=setTimeout(()=>{o=!0,k(!0)},n),k}function gV(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(t){return t!==void 0}function p0(t,e,n,r){if(r<e)throw f0(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw f0(`Invalid value for '${t}'. Expected ${n} or less.`)}function _V(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ac;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ac||(Ac={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vV(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e,n,r,s,i,o,a,u,c,d,m,g=!0,I=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=m,this.retry=g,this.isUsingEmulator=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,k)=>{this.resolve_=x,this.reject_=k,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Zl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Ac.NO_ERROR,u=i.getStatus();if(!a||vV(u,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Ac.ABORT;r(!1,new Zl(!1,null,d));return}const c=this.successCodes_.indexOf(u)!==-1;r(!0,new Zl(c,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());yV(u)?i(u):i()}catch(u){o(u)}else if(a!==null){const u=lV();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(s.canceled){const u=this.appDelete_?Jx():cV();o(u)}else{const u=uV();o(u)}};this.canceled_?n(!1,new Zl(!1,null,!0)):this.backoffId_=mV(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&gV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Zl{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function EV(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function IV(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function TV(t,e){e&&(t["X-Firebase-GMPID"]=e)}function xV(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function SV(t,e,n,r,s,i,o=!0,a=!1){const u=_V(t.urlParams),c=t.url+u,d=Object.assign({},t.headers);return TV(d,e),EV(d,n),IV(d,i),xV(d,r),new wV(c,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AV(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function RV(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e,n){this._service=e,n instanceof tn?this._location=n:this._location=tn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Rc(e,n)}get root(){const e=new tn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RV(this._location.path)}get storage(){return this._service}get parent(){const e=AV(this._location.path);if(e===null)return null;const n=new tn(this._location.bucket,e);return new Rc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw fV(e)}}function m0(t,e){const n=e==null?void 0:e[iV];return n==null?null:tn.makeFromBucketSpec(n,t)}function PV(t,e,n,r={}){t.host=`${e}:${n}`;const s=Us(e);s&&(Xp(`https://${t.host}/b`),Jp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:WE(i,t.app.options.projectId))}class kV{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=Xx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=oV,this._maxUploadRetryTime=aV,this._requests=new Set,s!=null?this._bucket=tn.makeFromBucketSpec(s,this._host):this._bucket=m0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=tn.makeFromBucketSpec(this._url,e):this._bucket=m0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){p0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){p0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Rt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Rc(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new pV(Jx());{const o=SV(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const g0="@firebase/storage",y0="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="storage";function CV(t=tm(),e){t=We(t);const r=Hc(t,Zx).getImmediate({identifier:e}),s=$E("storage");return s&&NV(r,...s),r}function NV(t,e,n,r={}){PV(t,e,n,r)}function bV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new kV(n,r,s,e,zs)}function DV(){Rs(new Vr(Zx,bV,"PUBLIC").setMultipleInstances(!0)),_n(g0,y0,""),_n(g0,y0,"esm2020")}DV();const VV={apiKey:"AIzaSyAPQcb4IX_KhjsteedOIbS4Szh1_nGP3t8",authDomain:"app-timbrature-zerosei.firebaseapp.com",projectId:"app-timbrature-zerosei",storageBucket:"app-timbrature-zerosei.firebasestorage.app",messagingSenderId:"190325273812",appId:"1:190325273812:web:177a253b25d8c64f963741"},tg=ZE(VV),pl=I2(tg),et=zD(tg);CV(tg);BD(et).catch(t=>{t.code==="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):t.code==="unimplemented"&&console.warn("The current browser does not support persistence.")});const e1=async()=>(await vh(fl(et,"users"))).docs.map(e=>e.data()),Wo=async t=>(await vh(fl(et,"users",t,"shifts"))).docs.map(n=>n.data()),_0=async(t,e)=>{const n=an(et,"users",t,"shifts",e.id);await wh(n,e)},OV=async(t,e)=>{const n=an(et,"users",t,"shifts",e);await Sc(n);const r=fl(et,"users",t,"shifts"),s=Hx(r,eV("id","==",e)),o=(await vh(s)).docs.map(a=>Sc(a.ref));await Promise.all(o)},MV=async(t,e)=>{const n=an(et,"activeShifts",t);await wh(n,e)},LV=async t=>{console.log("getActiveShift called for userId:",t);const e=an(et,"activeShifts",t),n=await _h(e);return console.log("getActiveShift - snap.exists():",n.exists()),n.exists()&&console.log("getActiveShift - data:",n.data()),n.exists()?n.data():null},jV=async t=>{const e=an(et,"activeShifts",t);await Sc(e)},FV=t=>{const e=fl(et,"activeShifts");return sV(e,async n=>{const r=[];for(const s of n.docs){const i=s.data(),o=await _h(an(et,"users",s.id));o.exists()&&r.push({user:o.data(),shift:i})}t(r)})},UV=async(t,e,n,r)=>{const s={id:`doc_${Date.now()}`,userId:t,fileName:e,fileUrl:n,uploadDate:new Date().toISOString(),uploadedBy:r};return await wh(an(et,"users",t,"documents",s.id),s),s},zV=async t=>{const e=Hx(fl(et,"users",t,"documents"));return(await vh(e)).docs.map(r=>r.data()).sort((r,s)=>new Date(s.uploadDate).getTime()-new Date(r.uploadDate).getTime())},BV=async(t,e)=>{await Sc(an(et,"users",t,"documents",e))},v0=()=>{const[t,e]=K.useState([]),[n,r]=K.useState(new Date);K.useEffect(()=>{const o=FV(a=>{a.sort((u,c)=>new Date(c.shift.startTime).getTime()-new Date(u.shift.startTime).getTime()),e(a)});return()=>{o()}},[]),K.useEffect(()=>{const o=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(o)},[]);const s=o=>{const a=new Date(o),u=n.getTime()-a.getTime(),c=Math.floor(u/(1e3*60*60)),d=Math.floor(u%(1e3*60*60)/(1e3*60)),m=Math.floor(u%(1e3*60)/1e3);return`${c}h ${d.toString().padStart(2,"0")}m ${m.toString().padStart(2,"0")}s`},i=o=>o.type&&{standard:"Standard",cassa:"Cassa",macchina_propria:"Macchina Propria",macchina_pizzeria:"Macchina Pizzeria"}[o.type]||null;return t.length===0?f.jsxs("div",{className:"text-center py-16",children:[f.jsx("div",{className:"w-20 h-20 bg-slate-800/50 rounded-full flex items-center justify-center mx-auto mb-6",children:f.jsx(Ss,{className:"w-10 h-10 text-slate-600"})}),f.jsx("h3",{className:"text-xl font-bold text-slate-400 mb-2",children:"Nessuno in Servizio"}),f.jsx("p",{className:"text-slate-500",children:"Al momento non ci sono dipendenti al lavoro."})]}):f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-white",children:[f.jsx(Ss,{className:"text-emerald-400"}),"Dipendenti in Servizio"]}),f.jsxs("div",{className:"flex items-center gap-2 bg-emerald-500/10 border border-emerald-500/20 px-3 py-1.5 rounded-full",children:[f.jsx("span",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),f.jsxs("span",{className:"text-emerald-400 text-sm font-medium",children:[t.length," ",t.length===1?"persona":"persone"]})]})]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:t.map(({user:o,shift:a})=>{const u=i(a),c=new Date(a.startTime);return f.jsxs("div",{className:"bg-slate-800/40 border border-slate-700/50 rounded-2xl p-5 hover:bg-slate-800/60 hover:border-emerald-500/30 transition-all",children:[f.jsx("div",{className:"flex items-start justify-between mb-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white font-bold text-lg shadow-lg shadow-emerald-500/20",children:[o.name.charAt(0),o.surname.charAt(0)]}),f.jsxs("div",{children:[f.jsxs("h3",{className:"font-bold text-white text-lg",children:[o.name," ",o.surname]}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("span",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),f.jsx("span",{className:"text-emerald-400 text-xs font-semibold uppercase tracking-wide",children:"In Servizio"})]})]})]})}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[f.jsx("svg",{className:"w-4 h-4 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsxs("span",{className:"text-sm",children:["Iniziato alle ",f.jsx("span",{className:"font-semibold text-white",children:Dr(c)})]})]}),f.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[f.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),f.jsxs("span",{className:"text-sm",children:["Durata: ",f.jsx("span",{className:"font-mono font-semibold text-emerald-400",children:s(a.startTime)})]})]}),u&&f.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[f.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),f.jsx("span",{className:"bg-yellow-500/10 border border-yellow-500/20 text-yellow-400 text-xs px-2 py-0.5 rounded-full font-medium",children:u})]})]})]},o.id)})})]})},$V=async(t,e,n,r=!1)=>{const s=`${t}.${e}@example.com`.toLowerCase(),o=(await sC(pl,s,n)).user,a={id:o.uid,name:t,surname:e,email:s,password:n,isAdmin:r};return await wh(an(et,"users",o.uid),a),a},qV=async(t,e)=>{const n=pl.currentUser;if(!n)throw new Error("No authenticated user");n.email,await oC(n,e)},KV=async(t,e,n)=>{const r=`${t}.${e}@example.com`.toLowerCase(),s=await iC(pl,r,n),i=await _h(an(et,"users",s.user.uid));if(!i.exists())throw new Error("User profile not found");return i.data()},WV=async()=>{await hC(pl)},HV=t=>cC(pl,async e=>{if(e){const n=await _h(an(et,"users",e.uid));t(n.exists()?n.data():null)}else t(null)}),GV=({user:t})=>{const[e,n]=K.useState(""),[r,s]=K.useState(null),i=async()=>{if(t)try{await qV(t.email,e),s("Password aggiornata con successo")}catch{s("Errore aggiornamento password")}};return f.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-gray-800 rounded-xl shadow-lg",children:[f.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Profilo"}),t&&f.jsxs("div",{className:"mb-4 text-gray-200",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Nome:"})," ",t.name," ",t.surname]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Email:"})," ",t.email]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("input",{type:"password",placeholder:"Nuova password",className:"w-full p-2 bg-gray-700 text-white rounded",value:e,onChange:o=>n(o.target.value)}),f.jsx("button",{className:"mt-2 w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded",onClick:i,children:"Cambia password"})]}),r&&f.jsx("p",{className:"text-green-400",children:r})]})},QV=["Lun","Mar","Mer","Gio","Ven","Sab","Dom"],YV=({shifts:t,assignedShifts:e,users:n})=>{const[r,s]=K.useState(()=>{const a=new Date,u=a.getDay(),c=a.getDate()-u+(u===0?-6:1),d=new Date(a.setDate(c));return d.setHours(0,0,0,0),d}),i=a=>{s(u=>{const c=new Date(u);return c.setDate(c.getDate()+a*7),c})},o=K.useMemo(()=>Array.from({length:7},(a,u)=>{const c=new Date(r);return c.setDate(c.getDate()+u),c}),[r]);return f.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("button",{onClick:()=>i(-1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(Ya,{})}),f.jsxs("h2",{className:"text-xl font-bold text-center capitalize",children:[r.toLocaleDateString("it-IT",{month:"long",year:"numeric"}),f.jsxs("span",{className:"text-sm text-slate-400 ml-2 font-normal",children:["(",o[0].getDate()," - ",o[6].getDate(),")"]})]}),f.jsx("button",{onClick:()=>i(1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(qc,{})})]}),f.jsx("div",{className:"space-y-4",children:o.map((a,u)=>{const c=new Date().toDateString()===a.toDateString(),d=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`,m=n.map(g=>{const I=t.find(k=>{if(k.userId!==g.id)return!1;const C=new Date(k.startTime);return C.getDate()===a.getDate()&&C.getMonth()===a.getMonth()&&C.getFullYear()===a.getFullYear()}),x=e.find(k=>k.userId===g.id&&k.date===d);return!I&&!x?null:{user:g,actualShift:I,assignedShift:x}}).filter(g=>g!==null);return f.jsxs("div",{className:`p-4 rounded-xl border ${c?"bg-slate-700/50 border-blue-500/50":"bg-slate-800/50 border-slate-700"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[f.jsx("span",{className:`text-lg font-bold capitalize ${c?"text-blue-400":"text-slate-200"}`,children:QV[u]}),f.jsx("span",{className:"text-slate-400 text-sm",children:a.toLocaleDateString("it-IT",{day:"numeric",month:"long"})})]}),m.length>0?f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:m.map(({user:g,actualShift:I,assignedShift:x})=>{let k=null,C="";return I?(k=f.jsxs(f.Fragment,{children:[Dr(new Date(I.startTime))," - ",I.endTime?Dr(new Date(I.endTime)):"..."]}),C="bg-indigo-500/20 border-indigo-500/30 text-indigo-200"):x&&(k=f.jsx(f.Fragment,{children:x.startTime}),C="bg-slate-600/20 border-slate-600/30 text-slate-300 border-dashed"),f.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border ${C}`,children:[f.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[f.jsxs("div",{className:"w-6 h-6 rounded-full bg-slate-700 flex-shrink-0 flex items-center justify-center text-[10px] font-bold text-white border border-slate-600",children:[g.name.charAt(0),g.surname.charAt(0)]}),f.jsxs("span",{className:"font-medium truncate text-sm",children:[g.name," ",g.surname]})]}),f.jsx("div",{className:"text-xs font-bold ml-2 whitespace-nowrap",children:k})]},g.id)})}):f.jsx("div",{className:"text-slate-500 text-sm italic py-2",children:"Nessun turno programmato"})]},u)})})]})},XV=({assignedShifts:t})=>{const[e,n]=K.useState([]),[r,s]=K.useState([]);return K.useEffect(()=>{(async()=>{const o=await e1();n(o);const a=o.map(async d=>(await Wo(d.id)).map(g=>({...g,userId:d.id}))),c=(await Promise.all(a)).flat();s(c)})()},[]),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("header",{children:[f.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Panoramica Turni"}),f.jsx("p",{className:"text-slate-400",children:"Visualizza i turni settimanali di tutti i dipendenti."})]}),f.jsx("div",{className:"glass-panel p-6 rounded-3xl shadow-lg",children:f.jsx(YV,{shifts:r,assignedShifts:t,users:e})})]})},JV=t=>{const e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");return`${e}-${n}-${r}`},ZV=({allUsers:t,assignedShifts:e,onSaveShifts:n})=>{const[r,s]=K.useState(new Date),[i,o]=K.useState([]),[a,u]=K.useState(!1);K.useEffect(()=>{o(e)},[e]);const c=C=>{s(w=>{const _=new Date(w);return _.setDate(1),_.setMonth(_.getMonth()+C),_})},d=K.useMemo(()=>{const C=r.getFullYear(),w=r.getMonth(),_=new Date(C,w+1,0).getDate();return Array.from({length:_},(E,V)=>new Date(C,w,V+1))},[r]),m=K.useMemo(()=>{const C=new Map;return d.forEach(w=>{const _=JV(w);C.set(_,[])}),i.forEach(w=>{const _=new Date(w.date);if(_.getFullYear()===r.getFullYear()&&_.getMonth()===r.getMonth()){const E=w.date;if(C.has(E)){const V=C.get(E);C.set(E,[...V,w])}}}),C},[i,r,d]),g=C=>{const w={id:`shift_${Date.now()}_${Math.random()}`,date:C,userId:"",startTime:"09:00"};o(_=>[..._,w])},I=(C,w,_)=>{o(E=>E.map(V=>V.id===C?{...V,[w]:_}:V))},x=C=>{o(w=>w.filter(_=>_.id!==C))},k=()=>{u(!0);const C=e.filter(_=>{const E=new Date(_.date);return E.getFullYear()!==r.getFullYear()||E.getMonth()!==r.getMonth()}),w=i.filter(_=>{const E=new Date(_.date);return E.getFullYear()===r.getFullYear()&&E.getMonth()===r.getMonth()});n([...C,...w]),setTimeout(()=>u(!1),1e3)};return f.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-lg",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{onClick:()=>c(-1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(Ya,{})}),f.jsx("h2",{className:"text-xl font-bold text-center capitalize w-48",children:r.toLocaleString("it-IT",{month:"long",year:"numeric"})}),f.jsx("button",{onClick:()=>c(1),className:"p-2 rounded-full hover:bg-gray-700 transition",children:f.jsx(qc,{})})]}),f.jsxs("button",{onClick:k,disabled:a,className:"w-full sm:w-auto mt-4 sm:mt-0 flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300 disabled:bg-gray-500",children:[f.jsx(VE,{}),a?"Salvato!":"Salva Modifiche"]})]}),f.jsx("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto pr-2",children:Array.from(m.entries()).sort(([C],[w])=>new Date(C).getTime()-new Date(w).getTime()).map(([C,w])=>f.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[f.jsx("h4",{className:"font-bold text-lg mb-3 text-blue-300",children:new Date(C.replace(/-/g,"/")).toLocaleDateString("it-IT",{weekday:"long",day:"numeric"})}),f.jsx("div",{className:"space-y-2",children:w.map(_=>f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr,auto,auto] gap-2 items-center",children:[f.jsxs("select",{value:_.userId,onChange:E=>I(_.id,"userId",E.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:"Seleziona Utente"}),t.map(E=>f.jsxs("option",{value:E.id,children:[E.name," ",E.surname]},E.id))]}),f.jsx("input",{type:"time",value:_.startTime,onChange:E=>I(_.id,"startTime",E.target.value),className:"w-full sm:w-auto px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{onClick:()=>x(_.id),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",children:f.jsx(Kc,{})})]},_.id))}),f.jsx("button",{onClick:()=>g(C),className:"text-blue-400 hover:text-blue-300 font-semibold mt-3 text-sm",children:"+ Aggiungi Turno"})]},C))})]})},e4=({allUsers:t,assignedShifts:e,onSaveShifts:n})=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("header",{children:[f.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Pianificazione Turni"}),f.jsx("p",{className:"text-slate-400",children:"Gestisci e assegna i turni ai dipendenti."})]}),f.jsx("div",{className:"glass-panel p-6 rounded-3xl shadow-lg",children:f.jsx(ZV,{allUsers:t,assignedShifts:e,onSaveShifts:n})})]}),t4=({user:t,allUsers:e})=>{const[n,r]=K.useState(t.isAdmin?null:t),[s,i]=K.useState([]),[o,a]=K.useState(!1),[u,c]=K.useState(null),[d,m]=K.useState(""),[g,I]=K.useState("");K.useEffect(()=>{t.isAdmin||r(t)},[t]),K.useEffect(()=>{n?x(n.id):i([])},[n]);const x=async w=>{try{const _=await zV(w);i(_)}catch(_){console.error("Error loading documents:",_)}},k=async()=>{if(!n||!d.trim()||!g.trim()){c("Inserisci sia il nome che il link del documento.");return}c(null);try{await UV(n.id,d.trim(),g.trim(),t.id),await x(n.id),m(""),I(""),a(!1)}catch(w){console.error("Add failed:",w),c("Errore durante l'aggiunta del documento.")}},C=async w=>{if(!(!n||!confirm("Sei sicuro di voler eliminare questo documento?")))try{await BV(n.id,w),i(_=>_.filter(E=>E.id!==w))}catch(_){console.error("Delete failed:",_),alert("Errore durante l'eliminazione.")}};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("header",{children:[f.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Documenti"}),f.jsx("p",{className:"text-slate-400",children:t.isAdmin?"Aggiungi link ai documenti dei dipendenti (es. buste paga su Google Drive).":"Visualizza e scarica i tuoi documenti."})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.isAdmin&&e&&f.jsxs("div",{className:"lg:col-span-1 glass-panel p-6 rounded-3xl shadow-lg h-fit",children:[f.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2 text-white",children:[f.jsx(ka,{className:"text-indigo-400"})," Dipendenti"]}),f.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto pr-2",children:e.map(w=>f.jsxs("div",{onClick:()=>r(w),className:`p-3 rounded-xl cursor-pointer transition-all flex items-center gap-3 border ${(n==null?void 0:n.id)===w.id?"bg-indigo-500/20 border-indigo-500/50 text-white":"bg-slate-800/40 border-slate-700/50 text-slate-300 hover:bg-slate-800/80"}`,children:[f.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center text-xs font-bold",children:[w.name.charAt(0),w.surname.charAt(0)]}),f.jsxs("span",{className:"truncate font-medium",children:[w.name," ",w.surname]})]},w.id))})]}),f.jsx("div",{className:`${t.isAdmin?"lg:col-span-2":"lg:col-span-3"} glass-panel p-6 rounded-3xl shadow-lg`,children:n?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-4",children:[f.jsx("div",{children:f.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[f.jsx(du,{className:"text-indigo-400"}),"Documenti di ",n.name]})}),t.isAdmin&&!o&&f.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2 rounded-xl font-bold text-white bg-indigo-600 hover:bg-indigo-500 shadow-lg shadow-indigo-500/20 transition-all",children:[f.jsx(gR,{className:"w-5 h-5"})," Aggiungi Documento"]})]}),o&&t.isAdmin&&f.jsxs("div",{className:"mb-6 p-4 bg-slate-800/40 border border-slate-700/50 rounded-xl space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Nome Documento"}),f.jsx("input",{type:"text",value:d,onChange:w=>m(w.target.value),placeholder:"es. Busta Paga Novembre 2024",className:"w-full px-4 py-2 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-indigo-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Link Documento"}),f.jsx("input",{type:"url",value:g,onChange:w=>I(w.target.value),placeholder:"https://drive.google.com/file/d/...",className:"w-full px-4 py-2 bg-slate-900/50 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-indigo-500"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:k,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-lg transition-colors",children:"Salva"}),f.jsx("button",{onClick:()=>{a(!1),m(""),I(""),c(null)},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-lg transition-colors",children:"Annulla"})]})]}),u&&f.jsx("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-red-400 text-sm",children:u}),f.jsx("div",{className:"space-y-3",children:s.length>0?s.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-800/40 border border-slate-700/50 rounded-xl hover:bg-slate-800/60 transition-colors group",children:[f.jsxs("div",{className:"flex items-center gap-4 overflow-hidden",children:[f.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-700/50 flex items-center justify-center text-indigo-400",children:f.jsx(du,{className:"w-6 h-6"})}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("p",{className:"font-medium text-slate-200 truncate",children:w.fileName}),f.jsxs("p",{className:"text-xs text-slate-500",children:["Aggiunto il ",new Date(w.uploadDate).toLocaleDateString("it-IT")]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("a",{href:w.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-colors",title:"Apri",children:f.jsx(mR,{className:"w-5 h-5"})}),t.isAdmin&&f.jsx("button",{onClick:()=>C(w.id),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Elimina",children:f.jsx(Kc,{className:"w-5 h-5"})})]})]},w.id)):f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx(du,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),f.jsx("p",{children:"Nessun documento presente."})]})})]}):f.jsxs("div",{className:"text-center py-20 text-slate-500",children:[f.jsx(ka,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),f.jsx("p",{className:"text-lg",children:"Seleziona un dipendente per gestire i documenti."})]})})]})]})},n4=({user:t,currentSection:e,onNavigate:n,onLogout:r})=>{const[s,i]=K.useState(!1),o=t==null?void 0:t.isAdmin,a=[...o?[{id:"live",label:"Live",icon:f.jsx(Ss,{className:"w-5 h-5"})},{id:"users",label:"Utenti",icon:f.jsx(ka,{className:"w-5 h-5"})},{id:"planner",label:"Pianificazione",icon:f.jsx(DE,{className:"w-5 h-5"})}]:[{id:"dashboard",label:"Timbratrice",icon:f.jsx(Ss,{className:"w-5 h-5"})}],{id:"globalShifts",label:"Panoramica Turni",icon:f.jsx(sR,{className:"w-5 h-5"})},{id:"documents",label:"Documenti",icon:f.jsx(du,{className:"w-5 h-5"})},{id:"profile",label:"Profilo",icon:f.jsx(cR,{className:"w-5 h-5"})}],u=()=>i(!s);return f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:u,className:"lg:hidden fixed top-4 left-4 z-50 p-2 rounded-lg bg-slate-800/50 text-white backdrop-blur-sm border border-slate-700/50",children:s?f.jsx(dR,{className:"w-6 h-6"}):f.jsx(hR,{className:"w-6 h-6"})}),s&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden",onClick:()=>i(!1)}),f.jsx("aside",{className:`
                fixed inset-y-0 left-0 z-50 w-72 
                bg-slate-900/95 backdrop-blur-xl border-r border-slate-800/50
                transform transition-transform duration-300 ease-in-out
                ${s?"translate-x-0":"-translate-x-full"} 
                lg:translate-x-0 lg:block
            `,children:f.jsxs("div",{className:"flex flex-col h-full p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 px-2 mb-10",children:[f.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-violet-600 flex items-center justify-center shadow-lg shadow-indigo-500/20",children:f.jsx("span",{className:"text-white font-bold text-xl",children:"Z"})}),f.jsx("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400",children:"ZeroSei"})]}),f.jsx("nav",{className:"flex-1 space-y-2",children:a.map(c=>f.jsxs("button",{onClick:()=>{n(c.id),i(!1)},className:`
                                    w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200
                                    ${e===c.id?"bg-indigo-500/20 text-indigo-300 border border-indigo-500/20 shadow-[0_0_15px_rgba(99,102,241,0.1)]":"text-slate-400 hover:bg-slate-800/50 hover:text-slate-200 hover:translate-x-1"}
                                `,children:[c.icon,f.jsx("span",{className:"font-medium",children:c.label})]},c.id))}),t&&f.jsxs("div",{className:"pt-6 border-t border-slate-800/50 mt-auto",children:[f.jsxs("div",{className:"flex items-center gap-3 px-2 mb-4",children:[f.jsxs("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center text-white font-bold border border-slate-600",children:[t.name.charAt(0),t.surname.charAt(0)]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("p",{className:"text-sm font-medium text-white truncate",children:[t.name," ",t.surname]}),f.jsx("p",{className:"text-xs text-slate-500 truncate",children:o?"Amministratore":"Dipendente"})]})]}),f.jsxs("button",{onClick:r,className:"w-full flex items-center gap-2 text-red-400 hover:bg-red-500/10 px-4 py-2 rounded-lg transition-colors text-sm font-medium group",children:[f.jsx(oR,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),"Logout"]})]})]})})]})},r4=({children:t,user:e,currentSection:n,onNavigate:r,onLogout:s})=>f.jsxs("div",{className:"flex min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-[#0f172a] to-black text-slate-200 font-sans",children:[e&&f.jsx(n4,{user:e,currentSection:n,onNavigate:r,onLogout:s}),f.jsx("main",{className:`flex-1 overflow-auto transition-all duration-300 ${e?"lg:ml-72":""} p-4 lg:p-8`,children:f.jsx("div",{className:"max-w-7xl mx-auto",children:t})})]}),s4=()=>{const[t,e]=K.useState(null),[n,r]=K.useState([]),[s,i]=K.useState("login"),[o,a]=K.useState([]),[u,c]=K.useState(null),[d,m]=K.useState([]),[g,I]=K.useState("dashboard"),[x,k]=K.useState(null),[C,w]=K.useState(null),[_,E]=K.useState(null),[V,L]=K.useState(null),[j,T]=K.useState(!1),v=K.useCallback(async()=>{const $=await e1();r($)},[]);K.useEffect(()=>{const $=HV(H=>{e(H),H&&(H.isAdmin?I("live"):I(J=>J==="dashboard"?"dashboard":J))});return v(),()=>{$()}},[v]),K.useEffect(()=>{try{const $=localStorage.getItem("rememberedCredentials");$&&L(JSON.parse($))}catch($){console.error("Failed to load remembered credentials",$)}T(!0)},[]);const S=K.useCallback(async($,H,J,pe)=>{try{const He=await KV($,H,J);if(e(He),w(null),He.isAdmin)I("live");else{I("dashboard");const Ge=await Wo(He.id);a(Ge);try{console.log("Attempting to load activeShift for user:",He.id);const Ot=await LV(He.id);console.log("Loaded activeShift from DB:",Ot),c(Ot)}catch(Ot){console.error("Error loading activeShift:",Ot),c(null)}}if(pe){const Ge={name:He.name,surname:He.surname,password:He.password};localStorage.setItem("rememberedCredentials",JSON.stringify(Ge)),L(Ge)}else localStorage.removeItem("rememberedCredentials"),L(null)}catch{w("Nome, cognome o password non corretti.")}},[]),R=K.useCallback(async($,H,J)=>{try{await $V($,H,J,!1),await WV(),await v(),E("Registrazione completata! Effettua il login."),w(null),i("login")}catch(pe){w(pe.message||"Errore durante la registrazione.")}},[v]),P=K.useCallback(()=>{e(null),a([]),c(null),k(null),w(null),I("dashboard")},[]),b=K.useCallback(async $=>{if(!t)return;console.log("handleClock called with shiftType:",$),console.log("Current activeShift:",u);const H=new Date;if(u){const J={...u,endTime:H.toISOString()};console.log("Clocking OUT - completedShift:",J),await _0(t.id,J),await jV(t.id),a(pe=>[...pe,J]),c(null)}else{const J={id:`shift_${H.getTime()}`,startTime:H.toISOString(),endTime:null,type:$};console.log("Clocking IN - newShift:",J),await MV(t.id,J),c(J)}},[u,t]),A=async $=>{const H=await Wo($.id);a(H),k($),I("userDetail")},Me=()=>{k(null),a([]),I("users")},Ht=K.useCallback($=>{r(H=>H.filter(J=>J.id!==$)),m(H=>H.filter(J=>J.userId!==$))},[]),Wr=K.useCallback(async($,H)=>{if(await _0($,H),(x==null?void 0:x.id)===$){const J=await Wo($);a(J)}},[x]),Hr=K.useCallback(async($,H)=>{try{if(await OV($,H),(x==null?void 0:x.id)===$){const J=await Wo($);a(J)}}catch(J){console.error("Failed to delete shift:",J),alert("Errore durante l'eliminazione del turno.")}},[x]);if(!j)return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-900 text-white",children:f.jsx("p",{className:"text-lg font-medium animate-pulse",children:"Caricamento..."})});const W=()=>{if(!t)return s==="login"?f.jsx(yR,{onLogin:S,onSwitchToRegister:()=>{i("register"),w(null),E(null)},error:C,successMessage:_,rememberedCredentials:V}):f.jsx(TR,{onRegister:R,onSwitchToLogin:()=>{i("login"),w(null),E(null)},error:C});switch(g){case"dashboard":const $=d.filter(H=>H.userId===t.id);return f.jsx(f_,{user:t,shifts:o,activeShift:u,assignedShifts:$,onLogout:P,onClock:b});case"live":return f.jsx(v0,{});case"users":return f.jsx(SR,{allUsers:n,onSelectUser:A,onDeleteUser:Ht});case"planner":return f.jsx(e4,{allUsers:n,assignedShifts:d,onSaveShifts:m});case"userDetail":return f.jsx(AR,{selectedUser:x,userShifts:o,onBack:Me,onUpdateShift:H=>Wr(x.id,H),onDeleteShift:H=>Hr(x.id,H)});case"globalShifts":return f.jsx(XV,{assignedShifts:d});case"documents":return f.jsx(t4,{user:t,allUsers:n});case"profile":return f.jsx(GV,{user:t});default:return t.isAdmin?f.jsx(v0,{}):f.jsx(f_,{user:t,shifts:o,activeShift:u,assignedShifts:d.filter(H=>H.userId===t.id),onLogout:P,onClock:b})}};return f.jsx(r4,{user:t,currentSection:g,onNavigate:I,onLogout:P,children:W()})},t1=document.getElementById("root");if(!t1)throw new Error("Could not find root element to mount to");const i4=kd.createRoot(t1);i4.render(f.jsx(C0.StrictMode,{children:f.jsx(s4,{})}));
